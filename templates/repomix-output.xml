This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
analytics/analytics.html.twig
application_form/application_form.html.twig
auth/auth.html.twig
auth/category_selection.html.twig
auth/login.html.twig
auth/register.html.twig
base.html.twig
chatbot/chatbot.html.twig
create_job/createjob.html.twig
dashboard/indexx.html.twig
edit_event/index.html.twig
edit_job/index.html.twig
events/add_event.html.twig
events/events.html.twig
explore/explore.html.twig
group/create.html.twig
group/edit.html.twig
group/group.html.twig
group/index.html.twig
group/view.html.twig
home/home.html.twig
jobapplications/jobapplications.html.twig
jobfeed/jobfeed.html.twig
messagerie/message/index.html.twig
organizer/organizer.html.twig
points/convert_links.html.twig
points/convert_simple.html.twig
points/convert_updated.html.twig
points/convert.html.twig
points/fortune_wheel.html.twig
points/index.html.twig
points/roulette_error.html.twig
points/roulette_test.html.twig
profile/edit.html.twig
profile/index.html.twig
profile/profile.html.twig
security/forgot_password.html.twig
social/add_post.html.twig
social/edit_post.html.twig
social/follow_requests.html.twig
social/group_profile.html.twig
social/notifications.html.twig
social/search_results.html.twig
social/social.html.twig
social/user_profile.html.twig
social/view_post.html.twig
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="analytics/analytics.html.twig">
{# {% extends 'base.html.twig' %} #} {# Uncomment this if you create and use a base.html.twig file #}


{% block stylesheets %}
    {# Stylesheets from your original analytics page #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    {# Added for header/footer icons and font #}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* CSS Variables for header/footer (ensure these are defined if coming from a global scope) */
        :root {
            --theme-primary-pink: #E83E8C;
            --theme-text-dark: #343A40;
            --theme-border-color: #DEE2E6;
            --body-font: 'Poppins', sans-serif;
        }

        body {
            font-family: var(--body-font);
            display: flex; /* For sticky footer */
            flex-direction: column; /* For sticky footer */
            min-height: 100vh; /* For sticky footer */
            margin: 0; /* Basic reset */
        }

        .page-content-wrapper { /* Wrapper for content between header and footer */
            flex: 1; /* Allows footer to stick to bottom */
        }

        /* --- Header Styles (from your provided CSS) --- */
        .header {
           background: #fff;
           box-shadow: 0 1px 3px rgba(0,0,0,0.1);
           padding: .8rem 1rem;
           border-bottom: 1px solid var(--theme-border-color);
        }
        .header .nav-container {
           display: flex;
           justify-content: space-between;
           align-items: center;
           max-width: 1140px;
           margin: 0 auto;
           padding: 0 15px;
        }
        .header .logo-img {
           height: 50px; /* Adjusted for proportion */
        }
         .header .logo a span {
            vertical-align: middle;
        }
        .header .nav-links {
           display: flex;
           align-items: center;
           gap: 1.5rem;
        }
        .header .nav-link {
           font-weight: 500;
           transition: color .2s;
           color: var(--theme-text-dark);
           text-decoration: none;
           padding: 0.5rem 0;
        }
        .header .nav-link:hover {
           color: var(--theme-primary-pink);
           text-decoration: none;
        }
        .header .contact-btn {
           background: var(--theme-primary-pink);
           color: white !important;
           padding: .5rem 1.2rem;
           border-radius: 20px;
           font-weight: 500;
           text-decoration: none;
           transition: background .2s;
        }
        .header .contact-btn:hover {
           background: #d0367c;
           color: white !important;
        }

        /* --- Footer Styles (from your provided CSS) --- */
        .site-footer {
           background: #343a40;
           color: rgba(255,255,255,.75);
           padding: 3rem 1rem 1.5rem;
           margin-top: auto; /* For sticky footer with flexbox */
        }
        .site-footer .footer-content {
           display: flex;
           flex-wrap: wrap;
           justify-content: space-between;
           gap: 2rem;
           max-width: 1140px;
           margin: 0 auto;
           padding: 0 15px;
        }
        .site-footer .footer-column {
           flex: 1 1 200px; /* Allow columns to grow/shrink, base width 200px */
        }
        .site-footer .footer-column h4 {
           color: #fff;
           margin-bottom: 1rem;
           font-weight: 600;
           border-bottom: 2px solid var(--theme-primary-pink);
           display: inline-block;
           padding-bottom: .5rem;
        }
        .site-footer .footer-column ul { list-style: none; padding: 0; }
        .site-footer .footer-column ul li { margin-bottom: .6rem; }
        .site-footer .footer-column ul li a { color: rgba(255,255,255,.75); transition: color .2s; text-decoration: none; }
        .site-footer .footer-column ul li a:hover { color: var(--theme-primary-pink); text-decoration: none; }
        .site-footer .footer-contact i { margin-right: .5rem; color: var(--theme-primary-pink); }
        .site-footer .footer-social-icons a { color: rgba(255,255,255,.75); margin-right: 1rem; font-size: 1.5rem; transition: color .2s; text-decoration: none; }
        .site-footer .footer-social-icons a:hover { color: var(--theme-primary-pink); text-decoration: none; }
        .site-footer .footer-bottom { text-align: center; margin-top: 2rem; font-size: .85rem; color: rgba(255,255,255,.55); border-top: 1px solid #495057; padding-top: 1rem; max-width: 1140px; margin-left: auto; margin-right: auto;}


        /* Styles from your original analytics page */
        .chart-container {
            width: 100%;
            max-width: 900px;
            margin: 30px auto;
            /* min-height is important if canvas might not render immediately or if it's empty */
            min-height: 405px; /* Give it some space */
        }

        #averageAgeChart,
        #genderChart {
            width: 100% !important; /* Chart.js needs !important for canvas dimensions sometimes */
            height: 400px !important;
            background-color: #f8f9fa; /* Light bg to see if canvas is there */
        }

        /* Responsive adjustments from your general CSS */
        @media (max-width: 768px) {
           .header .nav-container {
               flex-direction: column;
               align-items: flex-start;
           }
           .header .nav-links {
               margin-top: 1rem;
               flex-direction: column;
               align-items: flex-start;
               width: 100%;
           }
           .header .nav-link, .header .contact-btn {
               padding: 0.5rem;
               width: 100%;
               text-align: left;
           }
           .header .contact-btn { margin-top: 0.5rem; }

           .site-footer .footer-content {
               flex-direction: column;
               align-items: center;
               text-align: center;
           }
           .site-footer .footer-column { min-width: 100%; margin-bottom: 1rem; }
           .site-footer .footer-column h4 { display: block; }
        }
    </style>
{% endblock %}

{% block body %}
    {# --- HEADER --- #}
    <header class="header">
        <nav class="nav-container">
          <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
              <img src="{{ asset('images/logo.png') }}" alt="Logo ConnectSphere" class="logo-img">
              <span style="font-weight:bold;font-size:1.5rem;color:black;margin-left:10px;">ConnectSphere</span>
            </a>
          </div>
         <div class="nav-links">
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_analytics') }}" class="nav-link">Analytics</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
        </nav>
    </header>

    {# --- Main Content Area --- #}
    <div class="page-content-wrapper">
        {# This is your original analytics page content #}
        <div class="container mt-5">
            <h2 class="text-center mb-4">📈 Moyenne d’âge par événement</h2>

            {% if eventAverages is empty %}
                <div class="alert alert-info">Aucun événement ou participant trouvé.</div>
            {% else %}
                <!-- 🎯 Line Chart -->
                <div class="chart-container">
                    <canvas id="averageAgeChart"></canvas>
                </div>

                <!-- 🧾 Average Age Table -->
                <table class="table table-striped mt-5">
                    <thead>
                        <tr>
                            <th>Événement</th>
                            <th>Âge moyen</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in eventAverages %}
                            <tr>
                                <td>{{ item.event.name }}</td>
                                <td>{{ item.average_age|round(1) }}</td> {# Added rounding from previous suggestion #}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}

            <!-- 🕽 Dropdown for Gender Chart -->
            {% if events is defined and events is not empty %}
                <form method="get" class="my-5 text-center">
                    <label for="event_id" class="form-label fw-bold">Choisir un événement :</label>
                    <select name="event_id" id="event_id" class="form-select w-auto d-inline-block" onchange="this.form.submit()">
                        <option value="">-- Sélectionner --</option> {# Added a default empty option #}
                        {% for event in events %}
                            <option value="{{ event.id }}" {% if selectedEventId is defined and event.id == selectedEventId %}selected{% endif %}>
                                {{ event.name }}
                            </option>
                        {% endfor %}
                    </select>
                </form>
            {% endif %}


            <!-- 👥 Gender Bar Chart -->
            {# Only render canvas if an event is selected AND there is gender data for it #}
            {% if selectedEventId is defined and selectedEventId is not null and genderData is defined and genderData is not empty %}
                 <div class="chart-container">
                    <canvas id="genderChart"></canvas>
                </div>
            {% elseif selectedEventId is defined and selectedEventId is not null %}
                <div class="alert alert-info text-center">Aucune donnée de genre à afficher pour l'événement "{{ selectedEventName|default('sélectionné') }}".</div>
            {% elseif events is defined and events is not empty %}
                {# Prompt to select an event if dropdown is visible but nothing selected #}
                <div class="alert alert-info text-center">Sélectionnez un événement ci-dessus pour voir la répartition par genre.</div>
            {% endif %}
        </div>
    </div> {# End of page-content-wrapper #}


    {# --- FOOTER --- #}
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column">
                <h4>ConnectSphere</h4>
                <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
            </div>
            <div class="footer-column">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="{{ path('app_home') }}">Home</a></li>
                    <li><a href="{{ path('app_events') }}">Events</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-column footer-contact">
                <h4>Contact Us</h4>
                <p><i class="fas fa-phone"></i> <a href="tel:+21692160411">+216 92 160 411</a></p>
                <p><i class="fas fa-envelope"></i> <a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
            </div>
            <div class="footer-column">
                <h4>Follow Us</h4>
                <div class="footer-social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
{% endblock %}

{% block javascripts %}
    {# Chart.js library from your original analytics page #}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    {# Script content from your original analytics page, with checks for element existence #}
    {% if eventAverages is defined and eventAverages is not empty %}
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const ageCtx = document.getElementById('averageAgeChart');
        if (ageCtx) { // Check if the canvas element exists
            new Chart(ageCtx, {
                type: 'line',
                data: {
                    labels: {{ eventAverages|map(e => e.event.name)|json_encode|raw }},
                    datasets: [{
                        label: 'Âge moyen des participants',
                        data: {{ eventAverages|map(e => e.average_age)|json_encode|raw }},
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: 'rgba(255, 99, 132, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false, // Important for custom height
                    scales: {
                        y: {
                            beginAtZero: false, // Age average doesn't need to start at 0
                            ticks: {
                                precision: 1, // Allow for one decimal place
                                callback: function(value) { return value.toFixed(1); }
                            },
                            title: { display: true, text: 'Âge moyen' }
                        },
                        x: { title: { display: true, text: 'Événements' } }
                    },
                    plugins: {
                        title: { display: true, text: 'Moyenne d’âge par événement' }
                    }
                }
            });
        }

        const genderCtx = document.getElementById('genderChart');
        {# Only initialize gender chart if its canvas exists (i.e., an event is selected and has data) #}
        {% if selectedEventId is defined and selectedEventId is not null and genderData is defined and genderData is not empty %}
            if (genderCtx) { // Check if the canvas element exists
                new Chart(genderCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Hommes', 'Femmes'],
                        datasets: [{
                            label: 'Participants',
                            data: [{{ genderData.male ?? 0 }}, {{ genderData.female ?? 0 }}], // Use null coalescing
                            backgroundColor: ['rgba(54, 162, 235, 0.6)', 'rgba(255, 99, 132, 0.6)'],
                            borderColor: ['rgba(54, 162, 235, 1)', 'rgba(255, 99, 132, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false, // Important for custom height
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1,
                                    precision: 0,
                                    callback: function(value) { return Number.isInteger(value) ? value : null; }
                                },
                                title: { display: true, text: 'Nombre de Participants' }
                            },
                            x: { title: { display: true, text: 'Genre' } }
                        },
                        plugins: {
                            legend: { display: false },
                            title: {
                                display: true,
                                text: 'Répartition par genre pour : {{ selectedEventName|default("Événement sélectionné")|escape('js') }}'
                            }
                        }
                    }
                });
            }
        {% endif %}
    });
    </script>
    {% endif %}
{% endblock %}
</file>

<file path="application_form/application_form.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello ApplicationFormController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/prointegsy/src/Controller/ApplicationFormController.php'|file_link(0) }}">src/Controller/ApplicationFormController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/prointegsy/templates/application_form/index.html.twig'|file_link(0) }}">templates/application_form/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="auth/auth.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello AuthController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/PiSymfony/src/Controller/AuthController.php'|file_link(0) }}">src/Controller/AuthController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/PiSymfony/templates/auth/index.html.twig'|file_link(0) }}">templates/auth/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="auth/category_selection.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Select Interests - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/categrory.css') }}">
    <style>
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 2rem;
        }
        
        .category-item {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .category-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .category-item input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .category-label {
            display: block;
            padding: 1.5rem 1rem;
            text-align: center;
            background-color: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        .category-item input[type="checkbox"]:checked + .category-label {
            background-color: #4e54c8;
            color: white;
            border-color: #4348a8;
        }
        
        .category-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .category-name {
            font-weight: 500;
        }
        
        .progress-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        
        .progress-step:not(:last-child):after {
            content: '';
            position: absolute;
            top: 15px;
            left: 50%;
            width: 100%;
            height: 2px;
            background-color: #ddd;
            z-index: 1;
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #ddd;
            color: white;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 2;
        }
        
        .step-number.active {
            background-color: #4e54c8;
        }
        
        .step-number.completed {
            background-color: #2ecc71;
        }
        
        .step-label {
            font-size: 0.85rem;
            color: #666;
        }
        
        .step-label.active {
            color: #4e54c8;
            font-weight: 500;
        }
        
        .step-label.completed {
            color: #2ecc71;
            font-weight: 500;
        }
    </style>
{% endblock %}

{% block body %}
<div class="auth-container">
    <div class="auth-form">
        <div class="progress-bar">
            <div class="progress-step">
                <div class="step-number completed">1</div>
                <div class="step-label completed">Register</div>
            </div>
            <div class="progress-step">
                <div class="step-number active">2</div>
                <div class="step-label active">Interests</div>
            </div>
            <div class="progress-step">
                <div class="step-number">3</div>
                <div class="step-label">Complete</div>
            </div>
        </div>

        <h2>Select Your Interests</h2>
        <p class="auth-subtitle">Choose categories that interest you to personalize your experience</p>
        
        {# Success messages #}
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        {# Error messages #}
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">{{ message|raw }}</div>
        {% endfor %}

        <form method="post">
            <div class="category-grid">
                {% for category in categories %}
                    <div class="category-item">
                        <input type="checkbox" id="category-{{ category.id }}" name="categories[]" value="{{ category.id }}">
                        <label class="category-label" for="category-{{ category.id }}">
                                           <span class="category-icon">
                                {% if category.name == 'Sport' %}
                                    🏀
                                {% elseif category.name == 'Music' %}
                                    🎵
                                {% elseif category.name == 'Art' %}
                                    🎨
                                {% elseif category.name == 'Technology' %}
                                    💻
                                {% elseif category.name == 'Science' %}
                                    🔬
                                {% elseif category.name == 'Food' %}
                                    🍔
                                {% elseif category.name == 'Travel' %}
                                    ✈️
                                {% elseif category.name == 'Fashion' %}
                                    👗
                                {% elseif category.name == 'Books' %}
                                    📚
                                {% elseif category.name == 'Gaming' %}
                                    🎮
                                    {% elseif category.name == 'Social' %}
        👥
    {% elseif category.name == 'Culture' %}
        🎭
    {% elseif category.name == 'Education' %}
        🎓
                                {% else %}
                                    📌
                                {% endif %}
                            </span>
                            <span class="category-name">{{ category.name }}</span>
                        </label>
                    </div>
                {% endfor %}
            </div>

            <button type="submit" class="auth-btn">Continue</button>
            
            <p class="auth-redirect">
                <a href="{{ path('app_category_selection_skip') }}">Skip for now</a>
            </p>
        </form>
    </div>
</div>
{% endblock %}
</file>

<file path="auth/login.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Login - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/auth.css') }}">
{% endblock %}

{% block body %}
<div class="auth-container">
    <div class="auth-form">
        <h2>Welcome Back</h2>
        <p class="auth-subtitle">Please enter your credentials to login</p>
        
        {# Success message (for redirects after registration) #}
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        {# Error messages #}
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">{{ message }}</div>
        {% endfor %}

        <form method="post">
            <div class="form-group">
                <label for="inputEmail">Email</label>
                <input type="email" value="{{ last_username }}" name="email" id="inputEmail" class="form-control" autocomplete="email" required autofocus>
            </div>

            <div class="form-group">
                <label for="inputPassword">Password</label>
                <input type="password" name="password" id="inputPassword" class="form-control" autocomplete="current-password" required>
            </div>

            <div class="form-options">
           
                <a href="{{ path('app_forgot_password') }}" class="forgot-password">Forgot password?</a>
            </div>

            <button type="submit" class="auth-btn">Sign In</button>
            
            <p class="auth-redirect">
                Don't have an account? <a href="{{ path('app_register') }}">Sign up</a>
            </p>
        </form>
    </div>
    
    <div class="auth-illustration">
        <img src="{{ asset('images/login.jpg') }}" alt="Login Illustration">
    </div>
</div>
{% endblock %}
</file>

<file path="auth/register.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Register - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/auth.css') }}">
{% endblock %}

{% block body %}
<div class="auth-container">
    <div class="auth-form">
        <h2>Create Account</h2>
        <p class="auth-subtitle">Please fill in your information to register</p>
        
        {# Success messages #}
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        {# Error messages #}
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">{{ message|raw }}</div>
        {% endfor %}

        {{ form_start(registrationForm) }}
            <div class="form-group">
                {{ form_label(registrationForm.username) }}
                {{ form_widget(registrationForm.username, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(registrationForm.username) }}
            </div>
            
            <div class="form-group">
                {{ form_label(registrationForm.email) }}
                {{ form_widget(registrationForm.email, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(registrationForm.email) }}
            </div>
            
            <div class="form-group">
                {{ form_label(registrationForm.age) }}
                {{ form_widget(registrationForm.age, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(registrationForm.age) }}
            </div>
            
            <div class="form-group">
                {{ form_label(registrationForm.gender) }}
                {{ form_widget(registrationForm.gender, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(registrationForm.gender) }}
            </div>
            
            <div class="form-group">
                {{ form_label(registrationForm.plainPassword) }}
                {{ form_widget(registrationForm.plainPassword, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(registrationForm.plainPassword) }}
            </div>
            
            <div class="form-options">
                <div class="remember-me">
                    {{ form_widget(registrationForm.agreeTerms) }}
                    {{ form_label(registrationForm.agreeTerms) }}
                </div>
            </div>
            {{ form_errors(registrationForm.agreeTerms) }}

            <button type="submit" class="auth-btn">Sign Up</button>
        {{ form_end(registrationForm) }}
        
        <p class="auth-redirect">
            Already have an account? <a href="{{ path('app_login') }}">Sign in</a>
        </p>
    </div>
    
    <div class="auth-illustration">
        <img src="{{ asset('images/register.jpg') }}" alt="Registration Illustration">
    </div>
</div>
{% endblock %}
</file>

<file path="base.html.twig">
{# templates/base.html.twig #}
{% block stylesheets %}
    <!-- Google Fonts & Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ asset('css/root.css') }}">
{% endblock %}

{% block body %}
<header class="header">
    <nav class="navbar">
        <div class="logo">
            <img src="{{ asset('images/logo1.PNG') }}" alt="Connect Sphere" class="logo-img">
        </div>
        <div class="search-location">
            <div class="search-container">
                <input type="text" placeholder="Search events" class="search-input">
                <button class="search-btn"><i class="fas fa-search"></i></button>
            </div>
            <div class="location-selector">
                <i class="fas fa-map-marker-alt"></i>
                <span>Tunis</span>
            </div>
        </div>
        <div class="nav-links">
          
            <a href="{{ path('app_login') }}" class="nav-link">Login</a>
            <a href="{{ path('app_register') }}" class="nav-link">Register</a>
        </div>
    </nav>
</header>

<main>
    {# HERO SECTION #}
    <section class="hero">
    <div class="carousel">
        <div class="slide active">
            <img src="{{ asset('images/banner4.png') }}" alt="Event 1">
            <div class="carousel-content">
                <div class="banner-label">GET INTO IT</div>
                <h1 class="banner-title">READY. <br> SET. FEST.</h1>
                <a href="#" class="cta-btn">Find A World Of Festivals</a>
            </div>
        </div>
        <div class="slide">
            <img src="{{ asset('images/banner5.png') }}" alt="Event 2">
            <div class="carousel-content">
                <div class="banner-label">GET INTO IT</div>
                <h1 class="banner-title">READY. <br> SET. FEST.</h1>
                <a href="#" class="cta-btn">Find A World Of Festivals</a>
            </div>
        </div>
        <div class="slide">
            <img src="{{ asset('images/banner3.png') }}" alt="Event 3">
            <div class="carousel-content">
                <div class="banner-label">GET INTO IT</div>
                <h1 class="banner-title">READY. <br> SET. FEST.</h1>
                <a href="#" class="cta-btn">Find A World Of Festivals</a>
            </div>
        </div>
        <div class="slide">
            <img src="{{ asset('images/banner6.png') }}" alt="Event 2">
            <div class="carousel-content">
                <div class="banner-label">GET INTO IT</div>
                <h1 class="banner-title">READY. <br> SET. FEST.</h1>
                <a href="#" class="cta-btn">Find A World Of Festivals</a>
            </div>
        </div>
    </div>

    <div class="carousel-controls">
        <button class="prev-slide"><i class="fas fa-chevron-left"></i></button>
        <button class="next-slide"><i class="fas fa-chevron-right"></i></button>
    </div>
</section>



    {# CATEGORY ICONS #}
    <section class="categories">
        {# <h3>hhhhhh</h3> #}
        <div class="category-grid">
            {% set categories = [
                {'icon': 'microphone', 'name': 'Music'},
                {'icon': 'globe', 'name': 'Nightlife'},
                {'icon': 'theater-masks', 'name': 'Performing & Visual Arts'},
                {'icon': 'calendar-days', 'name': 'Holidays'},
                {'icon': 'heart', 'name': 'Dating'},
                {'icon': 'gamepad', 'name': 'Hobbies'},
                {'icon': 'briefcase', 'name': 'Business'},
                {'icon': 'utensils', 'name': 'Food & Drink'}
            ] %}
            {% for category in categories %}
                <div class="category-item">
                    <div class="icon-circle">
                        <i class="fas fa-{{ category.icon }}"></i>
                    </div>
                    <span>{{ category.name }}</span>
                </div>
            {% endfor %}
        </div>
    </section>

    {# EVENT LISTINGS #}
   
<section class="events">
    <h2 class="section-title">Events in Tunis</h2>
    <div class="event-list">
        <div class="event-card">
            <img src="{{ asset('images/banner2.png') }}" alt="Event 1">
            <div class="event-details">
                <h3>Finding Your Inner Joy MasterClass</h3>
                <p>Fri, May 16 • 2:30 AM GMT+2</p>
                <span class="event-price">Free</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner1.png') }}" alt="Event 2">
            <div class="event-details">
                <h3>Music Beats Festival</h3>
                <p>Sat, May 17 • 6:00 PM GMT+2</p>
                <span class="event-price">$20</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner3.png') }}" alt="Event 3">
            <div class="event-details">
                <h3>Startup Innovation Conference</h3>
                <p>Sun, May 18 • 10:00 AM GMT+2</p>
                <span class="event-price">Free</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner1.png') }}" alt="Event 4">
            <div class="event-details">
                <h3>Art & Culture Exhibition</h3>
                <p>Mon, May 19 • 3:00 PM GMT+2</p>
                <span class="event-price">$15</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner2.png') }}" alt="Event 5">
            <div class="event-details">
                <h3>Food Truck Fiesta</h3>
                <p>Tue, May 20 • 12:00 PM GMT+2</p>
                <span class="event-price">Free</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner3.png') }}" alt="Event 6">
            <div class="event-details">
                <h3>Outdoor Cinema Night</h3>
                <p>Wed, May 21 • 8:00 PM GMT+2</p>
                <span class="event-price">$10</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner1.png') }}" alt="Event 7">
            <div class="event-details">
                <h3>Photography Workshop</h3>
                <p>Thu, May 22 • 1:00 PM GMT+2</p>
                <span class="event-price">Free</span>
            </div>
        </div>

        <div class="event-card">
            <img src="{{ asset('images/banner2.png') }}" alt="Event 8">
            <div class="event-details">
                <h3>DJ Party Night</h3>
                <p>Fri, May 23 • 11:00 PM GMT+2</p>
                <span class="event-price">$25</span>
            </div>
        </div>

       
    </div>
</section>

</section>
<section class="interests-section">
    <div class="interests-container">
        <div class="interests-header">
            <h2>Let's make it personal</h2>
            <p>Select your interests to get event suggestions based on what you love</p>
        </div>
        <div class="interests-list">
            {% set interests = [
                'Comedy', 'Food', 'Education', 'Pop', 'Design', 'R&B', 'Hip Hop / Rap',
                'Film', 'Personal health', 'Blues & Jazz', 'Travel', 'Rock', 'Yoga',
                'Country', 'Startups & Small Business', 'Classical', 'Mental health',
                'TV', 'Alternative', 'Musical'
            ] %}
            {% for interest in interests %}
               <button class="interest-tag">{{ interest }}</button>
            {% endfor %}
        </div>
        <a href="#" class="view-all">View all interests</a>
    </div>
</section>
<section class="sponsors">
    <div class="container">
        <h2 class="section-title">Our Sponsors</h2>
        <div class="sponsor-logos">
            <img src="{{ asset('images/sponsor1.png') }}" alt="Sponsor 1">
            <img src="{{ asset('images/sponsor2.png') }}" alt="Sponsor 2">
            <img src="{{ asset('images/sponsor3.png') }}" alt="Sponsor 3">
            <img src="{{ asset('images/sponsor4.png') }}" alt="Sponsor 4">
            <img src="{{ asset('images/sponsor5.png') }}" alt="Sponsor 5">
        </div>
    </div>
</section>


</main>

<footer class="footer">
    <div class="footer-container">
        <div class="footer-section">
            <h4>About</h4>
            <ul>
                <li><a href="#">Our Story</a></li>
                <li><a href="#">Careers</a></li>
                <li><a href="#">Press & Media</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Support</h4>
            <ul>
                <li><a href="#">Help Center</a></li>
                <li><a href="#">Contact Us</a></li>
                <li><a href="#">Accessibility</a></li>
            </ul>
        </div>
        <div class="footer-section">
            <h4>Explore</h4>
            <ul>
                <li><a href="#">Festivals</a></li>
                <li><a href="#">Workshops</a></li>
                <li><a href="#">Concerts</a></li>
            </ul>
        </div>
        <div class="footer-section social">
            <h4>Follow Us</h4>
            <div class="social-icons">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2025 FestiHub. All rights reserved.</p>
    </div>
</footer>

{% endblock %}
{% block javascript %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const slides = document.querySelectorAll('.slide');
    const nextBtn = document.querySelector('.next-slide');
    const prevBtn = document.querySelector('.prev-slide');
    let currentSlide = 0;
    let slideInterval = setInterval(nextSlide, 4000); // Auto-slide every 4 seconds

    function showSlide(index) {
        slides.forEach((slide, i) => {
            slide.classList.toggle('active', i === index);
        });
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
        showSlide(currentSlide);
    }

    nextBtn.addEventListener('click', () => {
        nextSlide();
        resetInterval();
    });

    prevBtn.addEventListener('click', () => {
        prevSlide();
        resetInterval();
    });

    function resetInterval() {
        clearInterval(slideInterval);
        slideInterval = setInterval(nextSlide, 4000);
    }
});


// Add event listeners to interest tags
document.addEventListener('DOMContentLoaded', () => {
        const tags = document.querySelectorAll('.interest-tag');

        tags.forEach(tag => {
            tag.addEventListener('click', () => {
                tag.classList.toggle('selected');
            });
        });
    });
</script>

{% endblock %}
</file>

<file path="chatbot/chatbot.html.twig">
{% block stylesheets %}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ asset('css/chatbot.css') }}">
{% endblock %}

{% block body %}
<div class="chatbot-page-container">
    <!-- Header from home page - UNCHANGED -->
    <header class="header">
        <nav class="nav-container container">
            <div class="logo">
                <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
                    <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
                    <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
                </a>
            </div>
            <div class="nav-links">
                <a href="{{ path('app_home') }}" class="nav-link">Home</a>
                <a href="{{ path('app_events') }}" class="nav-link">Events</a>
                <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
                <a href="#" class="nav-link">Speakers</a>
                <a href="#" class="nav-link">Tickets</a>
                <a href="#" class="nav-link">Blogs</a>
                <a href="#" class="contact-btn nav-link">Contact</a>
            </div>
        </nav>
    </header>

    <!-- Enhanced Chatbot Content -->
    <main class="chatbot-main-content">
        <div class="chatbot-container">
            <!-- New Chatbot Header -->
            <div class="chatbot-header">
                <div class="chatbot-header-left">
                    <div class="chatbot-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h1 class="chatbot-title">ConnectSphere Assistant</h1>
                </div>
                <div class="chatbot-header-right">
                    <button class="chatbot-header-button" title="Clear chat">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                    <button class="chatbot-header-button" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
            
            <!-- Improved Chat Response Area -->
            <div id="chatbot-response-area">
                <!-- Welcome message -->
                <div class="message bot">
                    <div class="chatbot-info-panel">
                        <div class="info-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="info-content">
                            <h4>Welcome to ConnectSphere Assistant!</h4>
                            <p>I can help you find events, get ticket information, learn about speakers, and more.</p>
                        </div>
                    </div>
                    <p>Bonjour! Comment puis-je vous aider avec ConnectSphere aujourd'hui?</p>
                    <div class="message-time">Just now</div>
                    
                    <!-- Suggested questions -->
                    <div class="suggestions-container">
                        <div class="suggestion-chip"><i class="fas fa-calendar-alt"></i> Upcoming events</div>
                        <div class="suggestion-chip"><i class="fas fa-ticket-alt"></i> Ticket prices</div>
                        <div class="suggestion-chip"><i class="fas fa-user-tie"></i> Featured speakers</div>
                        <div class="suggestion-chip"><i class="fas fa-map-marker-alt"></i> Event venues</div>
                    </div>
                </div>
            </div>
            
            <!-- Loading indicator with icon -->
            <div id="loading-indicator" class="loading-indicator" style="display: none;">
                <i class="fas fa-circle-notch"></i>
                <span>Thinking...</span>
            </div>
            
            <!-- Error message area -->
            <div id="error-message-area" class="error-message"></div>
            
            <!-- Enhanced Input Area -->
            <div class="chatbot-input-container">
                <form id="chatbot-form" class="chatbot-input-area">
                    <div class="input-icon">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <input type="text" id="chatbot-input" placeholder="Ask me anything about ConnectSphere..." required autocomplete="off">
                    <div class="input-icon">
                        <i class="far fa-smile"></i>
                    </div>
                    <button type="submit" id="chatbot-send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer from home page - UNCHANGED -->
    <footer class="site-footer">
        <div class="footer-content container">
            <div class="footer-column">
                <h4>ConnectSphere</h4>
                <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
            </div>
            <div class="footer-column">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="{{ path('app_home') }}">Home</a></li>
                    <li><a href="{{ path('app_events') }}">Events</a></li>
                    <li><a href="{{ path('app_chatbot') }}">Chatbot</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-column footer-contact">
                <h4>Contact Us</h4>
                <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
                <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
            </div>
            <div class="footer-column">
                <h4>Follow Us</h4>
                <div class="footer-social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
</div>
{% endblock %}

{% block javascripts %}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM Loaded. Finding elements...");

            // Core elements
            const form = document.getElementById('chatbot-form');
            const inputField = document.getElementById('chatbot-input');
            const sendButton = document.getElementById('chatbot-send-btn');
            const responseArea = document.getElementById('chatbot-response-area');
            const loadingIndicator = document.getElementById('loading-indicator');
            const errorArea = document.getElementById('error-message-area');
            
            // New elements
            const clearChatButton = document.querySelector('.chatbot-header-button[title="Clear chat"]');
            const suggestionChips = document.querySelectorAll('.suggestion-chip');
            const emojiButton = document.querySelector('.input-icon .fa-smile');
            const micButton = document.querySelector('.input-icon .fa-microphone');

            // Element validation with improved logging
            const elements = {
                'chatbot-form': form,
                'chatbot-input': inputField,
                'chatbot-send-btn': sendButton,
                'chatbot-response-area': responseArea,
                'loading-indicator': loadingIndicator,
                'error-message-area': errorArea
            };

            let allElementsFound = true;
            for (const [id, element] of Object.entries(elements)) {
                if (!element) {
                    console.error(`ERROR: Could not find element with ID '${id}'`);
                    allElementsFound = false;
                } else {
                    console.log(`Element '${id}' found:`, element);
                }
            }

            if (allElementsFound) {
                console.log("All required elements found. Setting up event listeners...");
                
                // Format current time for message timestamps
                function getCurrentTime() {
                    const now = new Date();
                    return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                }
                
                // Add user message to chat
                function addUserMessage(message) {
                    const messageDiv = document.createElement('div');
                    messageDiv.classList.add('message', 'user');
                    messageDiv.innerHTML = `
                        <p>${message}</p>
                        <div class="message-time">${getCurrentTime()}</div>
                    `;
                    responseArea.appendChild(messageDiv);
                    scrollToBottom();
                }
                
                // Create typing indicator
                function showTypingIndicator() {
                    const typingDiv = document.createElement('div');
                    typingDiv.classList.add('bot-typing');
                    typingDiv.id = 'typing-indicator';
                    
                    for (let i = 0; i < 3; i++) {
                        const dot = document.createElement('div');
                        dot.classList.add('typing-dot');
                        typingDiv.appendChild(dot);
                    }
                    
                    responseArea.appendChild(typingDiv);
                    scrollToBottom();
                }
                
                // Remove typing indicator
                function removeTypingIndicator() {
                    const typingIndicator = document.getElementById('typing-indicator');
                    if (typingIndicator) {
                        typingIndicator.remove();
                    }
                }
                
                // Scroll chat to bottom
                function scrollToBottom() {
                    responseArea.scrollTop = responseArea.scrollHeight;
                }
                
                // Show error with animation
                function showError(message) {
                    errorArea.textContent = `⚠️ ${message}`;
                    errorArea.style.display = 'block';
                    // Reset animation to trigger it again
                    errorArea.style.animation = 'none';
                    errorArea.offsetHeight; // Trigger reflow
                    errorArea.style.animation = 'shake 0.5s';
                    scrollToBottom();
                    console.log("Displayed error message:", message);
                }
                
                // Submit handler with enhanced UI feedback
                form.addEventListener('submit', async (event) => {
                    console.log("Submit event listener triggered!");
                    event.preventDefault();
                    
                    const userPrompt = inputField.value.trim();
                    console.log("User prompt captured:", userPrompt);
                    if (!userPrompt) {
                        console.log("Prompt is empty, exiting listener.");
                        return;
                    }
                    
                    // Clear input and disable elements
                    inputField.value = '';
                    sendButton.disabled = true;
                    inputField.disabled = true;
                    errorArea.style.display = 'none';
                    
                    // Add user message to chat
                    addUserMessage(userPrompt);
                    
                    // Show typing indicator instead of loading indicator
                    showTypingIndicator();
                    
                    try {
                        console.log("Sending fetch request to /api/chatbot/ask...");
                        const response = await fetch("{{ path('api_chatbot_ask') }}", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/x-ndjson'
                            },
                            body: JSON.stringify({ prompt: userPrompt })
                        });
                        
                        console.log("Fetch response received. Status:", response.status, "Ok:", response.ok);
                        
                        if (!response.ok) {
                            let errorMsg = `Server Error: ${response.status} ${response.statusText}`;
                            try {
                                const errorData = await response.json();
                                errorMsg = errorData.error || errorMsg;
                                console.log("Parsed error response from server:", errorData);
                            } catch(e) {
                                console.log("Could not parse error response as JSON.");
                            }
                            throw new Error(errorMsg);
                        }
                        
                        if (!response.body) {
                            throw new Error('Response body is missing, cannot read stream.');
                        }
                        
                        console.log("Starting to process response stream...");
                        const reader = response.body.getReader();
                        const decoder = new TextDecoder();
                        let buffer = '';
                        
                        // Remove typing indicator before showing actual response
                        removeTypingIndicator();
                        
                        let currentBotMessageDiv = document.createElement('div');
                        currentBotMessageDiv.classList.add('message', 'bot');
                        responseArea.appendChild(currentBotMessageDiv);
                        
                        while (true) {
                            const { value, done } = await reader.read();
                            if (done) {
                                console.log('Response stream finished.');
                                // Add timestamp to the bot message
                                const timeDiv = document.createElement('div');
                                timeDiv.classList.add('message-time');
                                timeDiv.textContent = getCurrentTime();
                                currentBotMessageDiv.appendChild(timeDiv);
                                break;
                            }
                            
                            buffer += decoder.decode(value, { stream: true });
                            let lines = buffer.split('\n');
                            buffer = lines.pop();
                            
                            lines.forEach(line => {
                                if (line.trim() === '') return;
                                console.log("Processing received line:", line);
                                try {
                                    const data = JSON.parse(line);
                                    if (data.html) {
                                        currentBotMessageDiv.innerHTML += data.html;
                                        scrollToBottom();
                                    } else if (data.error) {
                                        console.error('Received error from backend stream:', data.error);
                                        showError(data.error);
                                    } else if (data.done) {
                                        console.log('Received done signal from backend stream.');
                                    }
                                } catch (e) {
                                    console.error('Error parsing JSON line:', e, 'Received line:', line);
                                }
                            });
                        }
                        
                    } catch (error) {
                        console.error('Error during fetch or streaming:', error);
                        removeTypingIndicator();
                        showError(error.message || 'An unexpected error occurred.');
                    } finally {
                        console.log("Fetch process finished (finally block).");
                        loadingIndicator.style.display = 'none';
                        sendButton.disabled = false;
                        inputField.disabled = false;
                        inputField.focus();
                        console.log("UI Reset: Button/input enabled, loading hidden.");
                    }
                });
                
                // Event listener for suggestion chips
                suggestionChips.forEach(chip => {
                    chip.addEventListener('click', () => {
                        const chipText = chip.textContent.trim();
                        inputField.value = chipText;
                        // Trigger the submit event
                        const submitEvent = new Event('submit');
                        form.dispatchEvent(submitEvent);
                    });
                });
                
                // Event listener for clear chat button
                if (clearChatButton) {
                    clearChatButton.addEventListener('click', () => {
                        // Keep only the welcome message (first child)
                        while (responseArea.childNodes.length > 1) {
                            responseArea.removeChild(responseArea.lastChild);
                        }
                    });
                }
                
                // Emoji button (just for show in this demo)
                if (emojiButton) {
                    emojiButton.addEventListener('click', () => {
                        alert('Emoji picker would open here!');
                    });
                }
                
                // Microphone button (just for show in this demo)
                if (micButton) {
                    micButton.addEventListener('click', () => {
                        alert('Voice input would activate here!');
                    });
                }
                
                // Focus the input field on page load
                inputField.focus();
                
            } else {
                console.error("ERROR: One or more required elements were not found. Cannot initialize chatbot functionality.");
            }
        });
    </script>
{% endblock %}
</file>

<file path="create_job/createjob.html.twig">
{# templates/create_job/createjob.html.twig #}
{# REMOVE: {% extends 'base.html.twig' %} as we are building a full page now #}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Create a Job | ConnectSphere{% endblock %}</title>
    
    {# Stylesheets #}
    {% block stylesheets %}
        {# Font Awesome & Google Fonts (consistent with events page) #}
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        
        {# Link to the CSS file for events page styles (header/footer/variables) #}
        {# This assumes you have general styles for header/footer in events_page.css #}
        {# OR, if you have a truly global root.css, use that. For now, using events_page.css as a base for theme. #}
        <link rel="stylesheet" href="{{ asset('css/events_page.css') }}"> 
        
        {# Specific styles for this page - can be a separate file or inline #}
        {# For this example, I'll keep them inline but adjust them #}
        {# You might want to move these to public/css/create_job_form_V2.css #}
        <link rel="stylesheet" href="{{ asset('css/create_job_form.css') }}"> {# Link to your existing one to be modified #}
    {% endblock %}
</head>
<body>

    {% block page_header %}
    <!-- Header from events page -->
    <header class="header">
        <nav class="nav-container container">
            <div class="logo">
                <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
                    <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
                    <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
                </a>
            </div>
            <div class="nav-links">
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_organizer') }}" class="nav-link">Dashboard</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
            </div>
        </nav>
    </header>
    {% endblock %}

    {% block body %}
    <main class="create-job-page-container"> {# Changed class for page specific styling #}
        <div class="create-job-wrapper">
            <div class="form-header">
                <div class="form-icon">
                    <i class="fas fa-briefcase"></i>
                </div>
                <h1>Create New Opportunity</h1>
                <p class="form-subtitle">Fill in the details to post your job listing and find the perfect candidate</p>
            </div>
            
            {{ form_start(form) }}
                <div class="form-grid">
                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.jobTitle.vars.id }}">
                                <i class="fas fa-heading"></i> Job Title
                            </label>
                            {{ form_widget(form.jobTitle) }}
                            {# <i class="fas fa-pen input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.eventTitle.vars.id }}">
                                <i class="fas fa-calendar-alt"></i> Event Title (Optional)
                            </label>
                            {{ form_widget(form.eventTitle) }}
                            {# <i class="fas fa-tag input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.jobLocation.vars.id }}">
                                <i class="fas fa-map-marker-alt"></i> Job Location
                            </label>
                            {{ form_widget(form.jobLocation) }}
                            {# <i class="fas fa-location-dot input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.employmentType.vars.id }}">
                                <i class="fas fa-user-tie"></i> Employment Type
                            </label>
                            {{ form_widget(form.employmentType, {'attr': {'class': 'form-select-styled'}}) }} {# Added class for select styling #}
                            {# <i class="fas fa-briefcase input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.applicationDeadLine.vars.id }}">
                                <i class="fas fa-clock"></i> Application Deadline
                            </label>
                            {{ form_widget(form.applicationDeadLine) }}
                            {# <i class="fas fa-calendar-day input-icon"></i> #}
                        </div>
                    </div>
                    
                    {# Salary Range in one card for better grouping if desired, or keep separate #}
                    <div class="form-card salary-range-card"> 
                        <div class="salary-range">
                            <div class="form-group">
                                <label for="{{ form.minSalary.vars.id }}">
                                    <i class="fas fa-money-bill-wave"></i> Minimum Salary
                                </label>
                                {{ form_widget(form.minSalary) }}
                                {# <i class="fas fa-coins input-icon"></i> #}
                            </div>
                            <div class="form-group">
                                <label for="{{ form.maxSalary.vars.id }}">
                                    <i class="fas fa-money-bill-wave"></i> Maximum Salary
                                </label>
                                {{ form_widget(form.maxSalary) }}
                                {# <i class="fas fa-coins input-icon"></i> #}
                            </div>
                        </div>
                    </div>


                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.currency.vars.id }}">
                                <i class="fas fa-dollar-sign"></i> Currency
                            </label>
                            {{ form_widget(form.currency) }}
                            {# <i class="fas fa-wallet input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card tall"> {# Spans full width if form-grid has 1 column on mobile #}
                        <div class="form-group">
                            <label for="{{ form.jobDescreption.vars.id }}">
                                <i class="fas fa-file-alt"></i> Job Description
                            </label>
                            {{ form_widget(form.jobDescreption) }}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.recruiterName.vars.id }}">
                                <i class="fas fa-user"></i> Recruiter Name
                            </label>
                            {{ form_widget(form.recruiterName) }}
                            {# <i class="fas fa-signature input-icon"></i> #}
                        </div>
                    </div>

                    <div class="form-card">
                        <div class="form-group">
                            <label for="{{ form.recruiterEmail.vars.id }}">
                                <i class="fas fa-envelope"></i> Recruiter Email
                            </label>
                            {{ form_widget(form.recruiterEmail) }}
                            {# <i class="fas fa-at input-icon"></i> #}
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="submit-btn">
                        <span>Post Opportunity</span>
                        <i class="fas fa-paper-plane btn-icon"></i>
                    </button>
                </div>
            {{ form_end(form) }}
        </div>
    </main>
    {% endblock %}

    {% block page_footer %}
    <!-- Footer from events page -->
    <footer class="site-footer">
        <div class="footer-content container">
            <div class="footer-column">
                <h4>ConnectSphere</h4>
                <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
            </div>
            <div class="footer-column">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="{{ path('app_home') }}">Home</a></li>
                    <li><a href="{{ path('app_events') }}">Events</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-column footer-contact">
                <h4>Contact Us</h4>
                <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
                <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
            </div>
            <div class="footer-column">
                <h4>Follow Us</h4>
                <div class="footer-social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
    {% endblock %}

    {% block javascripts %}
        {# Add any page-specific JS here if needed #}
    {% endblock %}
</body>
</html>
</file>

<file path="dashboard/indexx.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/dashboard.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block body %}
<div class="dashboard-container">
    <div class="dashboard-menu">
        <div class="user-profile">
            <div class="avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <h2>Welcome, <span class="username">{{ app.session.get('user').username }}</span>!</h2>
        </div>
        <ul class="menu-items">
            <li class="menu-item active" data-content="groups">
                <a href="{{ path('app_groups') }}">
                    <i class="fas fa-users"></i>
                    <span>Groups</span>
                </a>
            </li>
            <li class="menu-item" data-content="profile">
                <a href="{{ path('app_profile') }}">
                    <i class="fas fa-user-cog"></i>
                    <span>Profile</span>
                </a>
            </li>
            <li class="menu-item logout">
                <a href="{{ path('app_logout') }}">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </a>
            </li>
        </ul>
    </div>
    <div class="dashboard-content">
        <div class="welcome-message">
            <h1>Your Dashboard</h1>
            <p>Select an option from the menu to get started.</p>
            <div class="animated-icons">
                <div class="icon-circle"><i class="fas fa-users"></i></div>
                <div class="icon-circle"><i class="fas fa-chart-line"></i></div>
                <div class="icon-circle"><i class="fas fa-cog"></i></div>
            </div>
        </div>
    </div>
</div>

<script>
    document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', function() {
            document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
        });
    });
</script>
{% endblock %}
</file>

<file path="edit_event/index.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello EditEventController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/prointegsy1/prointegsy/src/Controller/EditEventController.php'|file_link(0) }}">src/Controller/EditEventController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/prointegsy1/prointegsy/templates/edit_event/index.html.twig'|file_link(0) }}">templates/edit_event/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="edit_job/index.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello EditJobController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/prointegsy1/prointegsy/src/Controller/EditJobController.php'|file_link(0) }}">src/Controller/EditJobController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/prointegsy1/prointegsy/templates/edit_job/index.html.twig'|file_link(0) }}">templates/edit_job/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="events/add_event.html.twig">
{# templates/events/add_event.html.twig #}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Create New Event | ConnectSphere</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  {# Base theme CSS (your root styles) #}
  <link rel="stylesheet" href="{{ asset('css/root.css') }}"/>

  {# Page‑specific CSS #}
  <link rel="stylesheet" href="{{ asset('css/add_event_form.css') }}"/>

  {# Bootstrap for alerts, grid, form controls, etc. #}
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-+++"
    crossorigin="anonymous"
  />

  {# Font Awesome for icons #}
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
  />
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <nav class="nav-container container">
      <div class="logo">
        <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
          <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
          <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
        </a>
      </div>
    <div class="nav-links">
      <a href="{{ path('app_home') }}" class="nav-link">Home</a>
        <a href="{{ path('app_events') }}" class="nav-link active">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_organizer') }}" class="nav-link">Dashboard</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
        
    </nav>
    </nav>
  </header>

  <main class="container py-5">
    <div class="add-event-page-container">
      <h1>Create New Event</h1>

      {# Flash messages #}
      {% for label, messages in app.flashes %}
        <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
          {% for message in messages %}{{ message }}{% endfor %}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}

      {{ form_start(create_event_form, {
          action: path('app_event_new'),
          method: 'POST',
          attr: { novalidate: 'novalidate', class: 'add-event-form' }
      }) }}

        {% if not create_event_form.vars.valid %}
          <div class="alert alert-danger mb-4">
            {{ form_errors(create_event_form) }}
          </div>
        {% endif %}

        <div class="form-field-row">
          <label for="{{ create_event_form.name.vars.id }}" class="form-label">Event Name</label>
          <div class="form-widget-container">
            {{ form_widget(create_event_form.name, {
                attr: {
                  placeholder: 'Please enter the name of your event',
                  class: form_errors(create_event_form.name) ? 'is-invalid' : ''
                }
            }) }}
            {{ form_errors(create_event_form.name) }}
            <div class="form-help">Choose a clear, descriptive name for your event</div>
          </div>
        </div>

        <div class="form-field-row">
          <label for="{{ create_event_form.description.vars.id }}" class="form-label">Description</label>
          <div class="form-widget-container">
            {{ form_widget(create_event_form.description, {
                attr: {
                  placeholder: 'Describe your event',
                  rows: 5,
                  class: form_errors(create_event_form.description) ? 'is-invalid' : ''
                }
            }) }}
            {{ form_errors(create_event_form.description) }}
            <div class="form-help">Provide details about what participants can expect</div>
          </div>
        </div>

        <div class="form-field-row">
          <label class="form-label">Event Dates</label>
          <div class="form-widget-container">
            <div class="date-time-container d-flex gap-3">
              <div class="date-input-group flex-fill">
                <label>Start day</label>
                {{ form_widget(create_event_form.startTime, {
                    attr: {
                      class: form_errors(create_event_form.startTime) ? 'is-invalid' : ''
                    }
                }) }}
                {{ form_errors(create_event_form.startTime) }}
              </div>
              <div class="date-input-group flex-fill">
                <label>End day</label>
                {{ form_widget(create_event_form.endTime, {
                    attr: {
                      class: form_errors(create_event_form.endTime) ? 'is-invalid' : ''
                    }
                }) }}
                {{ form_errors(create_event_form.endTime) }}
              </div>
            </div>
            <div class="form-help">Select the start and end dates/times of your event</div>
          </div>
        </div>

        <div class="form-field-row">
          <label for="{{ create_event_form.location.vars.id }}" class="form-label">Location</label>
          <div class="form-widget-container">
            {{ form_widget(create_event_form.location, {
                attr: {
                  placeholder: 'Location',
                  class: form_errors(create_event_form.location) ? 'is-invalid' : ''
                }
            }) }}
            {{ form_errors(create_event_form.location) }}
            <div class="form-help">Enter the physical or virtual location of the event</div>
          </div>
        </div>

        <div class="form-field-row">
          <label for="{{ create_event_form.points.vars.id }}" class="form-label">Points</label>
          <div class="form-widget-container">
            {{ form_widget(create_event_form.points, {
                attr: {
                  placeholder: 'Points awarded',
                  class: form_errors(create_event_form.points) ? 'is-invalid' : ''
                }
            }) }}
            {{ form_errors(create_event_form.points) }}
            <div class="form-help">Number of points participants will earn</div>
          </div>
        </div>

        <div class="form-field-row">
          <label for="{{ create_event_form.categoryId.vars.id }}" class="form-label">Category</label>
          <div class="form-widget-container">
            {{ form_widget(create_event_form.categoryId, {
                attr: {
                  class: form_errors(create_event_form.categoryId) ? 'is-invalid' : ''
                }
            }) }}
            {{ form_errors(create_event_form.categoryId) }}
            <div class="form-help">Select the most appropriate category for your event</div>
          </div>
        </div>

        <div class="form-field-row">
          <label class="form-label">Event Image</label>
          <div class="form-widget-container">
            <label
              for="{{ create_event_form.image.vars.id }}"
              class="file-upload-label {{ form_errors(create_event_form.image) ? 'is-invalid' : '' }}"
            >Upload Image</label>
            {{ form_widget(create_event_form.image) }}
            <span id="file-chosen-display">No file chosen</span>
            {{ form_errors(create_event_form.image) }}
            <div class="form-help">Upload an image to represent your event (1200×630px recommended)</div>
          </div>
        </div>

        <div class="form-buttons d-flex gap-3 mt-4">
          <a href="{{ path('app_events') }}" class="btn btn-secondary btn-cancel-event">Cancel</a>
          <button type="submit" id="save-event-btn" class="btn btn-primary btn-save-event">Save Event</button>
        </div>

      {{ form_end(create_event_form) }}
    </div>
  </main>

  <!-- ORIGINAL FOOTER -->
  <footer class="site-footer mt-5">
    <div class="footer-content container">
      <div class="footer-column">
        <h4>ConnectSphere</h4>
        <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
      </div>
      <div class="footer-column">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="{{ path('app_home') }}">Home</a></li>
          <li><a href="{{ path('app_events') }}">Events</a></li>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Blog</a></li>
          <li><a href="#">Contact</a></li>
          <li><a href="#">Terms of Service</a></li>
        </ul>
      </div>
      <div class="footer-column footer-contact">
        <h4>Contact Us</h4>
        <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
        <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
      </div>
      <div class="footer-column">
        <h4>Follow Us</h4>
        <div class="footer-social-icons">
          <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
          <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
          <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
          <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom text-center py-3">
      © {{ "now"|date("Y") }} ConnectSphere. All rights reserved.
    </div>
  </footer>

  {# Bootstrap JS bundle #}
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-+++"
    crossorigin="anonymous"
  ></script>

  {# Page-specific JavaScript #}
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // File name display
    const fileInput = document.getElementById('{{ create_event_form.image.vars.id }}');
    const fileChosen = document.getElementById('file-chosen-display');
    if (fileInput && fileChosen) {
      fileInput.addEventListener('change', function(){
        if (this.files.length > 0) {
          let name = this.files[0].name;
          if (name.length > 30) {
            name = name.slice(0,15) + '…' + name.slice(-10);
          }
          fileChosen.textContent = name;
        } else {
          fileChosen.textContent = 'No file chosen';
        }
      });
    }

    // Button loading effect
    const form = document.querySelector('.add-event-form');
    const btnSave = document.getElementById('save-event-btn');
    if (form && btnSave) {
      form.addEventListener('submit', function() {
        btnSave.classList.add('loading');
        btnSave.textContent = 'Saving...';
      });
    }
  });
  </script>

</body>
</html>
</file>

<file path="events/events.html.twig">
{# templates/events/events.html.twig #}
{% block stylesheets %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link rel="stylesheet" href="{{ asset('css/events_page.css') }}">
{# Bootstrap CSS for alerts and modal close buttons #}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block body %}
<!-- Header from home page -->
<header class="header">
    <nav class="nav-container container">
      <div class="logo">
        <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
          <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
          <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
        </a>
      </div>
      <div class="nav-links">
      <a href="{{ path('app_home') }}" class="nav-link">Home</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_organizer') }}" class="nav-link">Dashboard</a>
        <a href="{{ path('app_analytics') }}" class="nav-link">Analaytics</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
    </nav>
  </header>
</header>
<!-- Main Events Content -->
<div class="event-list-page">
    {# --- Top Controls --- #}
    <div class="events-controls-header">
        <h1 class="page-title">Events</h1>
        <form action="{{ path('app_events') }}" method="GET" class="search-filter-form">
            <input type="text" id="eventSearchField" name="search" class="form-control" placeholder="Search events..." value="{{ app.request.query.get('search') }}">
            {% if app.request.query.get('category') %}
                 <input type="hidden" name="category" value="{{ app.request.query.get('category') }}">
            {% endif %}
            <button type="submit" class="btn btn-search">Search</button>
        </form>
        <div class="new-event-action">
            <a href="{{ path('app_event_add_page') }}" class="btn btn-add-event-page">New Event</a>
        </div>
    </div>
    <div class="category-filters-section">
        <div class="category-filters-container">
            <ul class="category-filters-list">
                <li class="category-pill{% if not app.request.query.get('category') %} active{% endif %}">
                    <a href="{{ path('app_events', {'search': app.request.query.get('search')}) }}">
                        <i class="fas fa-layer-group"></i> All Categories
                    </a>
                </li>
                {% if categories is defined and categories is not empty %}
                    {% for category in categories %}
                        <li class="category-pill{% if app.request.query.get('category') == category.id %} active{% endif %}">
                            <a href="{{ path('app_events', {'search': app.request.query.get('search'), 'category': category.id}) }}">
                                {% if category.name == 'Technology' %}
                                    <i class="fas fa-laptop-code"></i>
                                {% elseif category.name == 'Business' %}
                                    <i class="fas fa-briefcase"></i>
                                {% elseif category.name == 'Art' %}
                                    <i class="fas fa-palette"></i>
                                {% elseif category.name == 'Music' %}
                                    <i class="fas fa-music"></i>
                                {% elseif category.name == 'Food' %}
                                    <i class="fas fa-utensils"></i>
                                {% elseif category.name == 'Sports' %}
                                    <i class="fas fa-running"></i>
                                {% elseif category.name == 'Education' %}
                                    <i class="fas fa-graduation-cap"></i>
                                {% else %}
                                    <i class="fas fa-calendar-alt"></i>
                                {% endif %}
                                {{ category.name }}
                            </a>
                        </li>
                    {% endfor %}
                {% endif %}
            </ul>
        </div>
    </div>

    {# --- Flash Messages (for server-side messages) --- #}
    <div id="server-flash-message-container" style="margin-top: 15px;">
        {% for label, messages in app.flashes %}
            <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                {% for message in messages %}{{ message|raw }}{% endfor %}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>

    {# --- Container for AJAX messages --- #}
    <div id="ajax-message-container" style="margin-top: 15px;"></div>


    {# --- Event Grid --- #}
    <div class="row event-grid-row">
        {# MODIFIED: Loop over eventsWithStatus instead of events #}
        {% if eventsWithStatus is defined and eventsWithStatus is not empty %}
            {% for eventData in eventsWithStatus %}
                {% set event = eventData.entity %} {# Get the actual event entity from the wrapper #}
                {% set hasJoined = eventData.hasJoined %} {# Get the participation status #}
                <div class="event-column">
                    <div class="card h-100 event-display-card" id="event-card-{{ event.id }}">
                        {# --- Image Card --- #}
                        {% set imageSrc = asset('images/default_event.png') %}
                        {% if event.image is not null and event.image is not empty %}
                            {% if event.image starts with 'data:' %} {% set imageSrc = event.image %}
                            {% else %}
                                {% set base64Data = event.image %} {% set mimeType = 'image/jpeg' %}
                                {% if base64Data starts with 'iVBO' %} {% set mimeType = 'image/png' %}
                                {% elseif base64Data starts with '/9j/' %} {% set mimeType = 'image/jpeg' %}
                                {% elseif base64Data starts with 'R0lG' %} {% set mimeType = 'image/gif' %}
                                {% elseif base64Data starts with 'PHN2Zy' %} {% set mimeType = 'image/svg+xml' %}
                                {% endif %}
                                {% set imageSrc = 'data:' ~ mimeType ~ ';base64,' ~ base64Data %}
                            {% endif %}
                        {% endif %}
                        <div class="card-img-wrapper"><img src="{{ imageSrc }}" class="card-img-top" alt="{{ event.name|default('Event Image') }}"></div>
                        {# --- Card Body --- #}
                        <div class="card-body">
                             <h5 class="card-title">{{ event.name }}</h5>
                            <div class="event-text-details">
                                {{ event.description|slice(0, 80)|striptags ~ (event.description|length > 80 ? '...' : '') }}<br>
                                <small>
                                    {% if event.startTime %}{{ event.startTime|date('d/m/Y') }}{% endif %}
                                    {% if event.endTime and event.startTime|date('Y-m-d') != event.endTime|date('Y-m-d') %} - {{ event.endTime|date('d/m/Y') }}{% endif %}<br>
                                    {{ event.location ?? 'N/A' }} | Cat: {{ event.categoryId.name ?? 'N/A' }}
                                </small>
                            </div>
                            <div class="event-card-actions">
                                <button type="button" class="btn btn-view-details view-details-btn" data-modal-target="#event-modal-{{ event.id }}">Details</button>
                                
                                {# MODIFIED: Conditional class, text, and disabled state for Join button #}
                                <button type="button" 
                                        class="btn btn-participate join-event-btn {% if hasJoined %}joined{% endif %}" 
                                        data-event-id="{{ event.id }}"
                                        {% if hasJoined %}disabled{% endif %}>
                                    {% if hasJoined %}
                                        <i class="fas fa-check"></i> Joined
                                    {% else %}
                                        Join
                                    {% endif %}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                {# --- Event Modal --- #}
                <div class="event-modal-overlay" id="event-modal-{{ event.id }}">
                    <div class="event-modal-content">
                         <button type="button" class="event-modal-close-x close-modal-btn">×</button>
                        <div class="event-modal-body">
                             <div class="event-modal-image-wrapper"><img src="{{ imageSrc }}" class="event-modal-image" alt="{{ event.name }}"></div>
                             <h3 class="event-modal-title">{{ event.name }}</h3>
                             <p class="event-modal-description">{{ event.description|striptags }}</p>
                             <div class="event-modal-details">
                                 <strong>Date:</strong> {% if event.startTime %}{{ event.startTime|date('d/m/Y H:i') }}{% else %}N/A{% endif %} - {% if event.endTime %}{{ event.endTime|date('d/m/Y H:i') }}{% else %}N/A{% endif %}<br>
                                 <strong>Location:</strong> {{ event.location ?? 'N/A' }}<br>
                                 <strong>Category:</strong> {{ event.categoryId.name ?? 'N/A' }}<br>
                                 <strong>Points:</strong> {{ event.points ?? '0' }}
                             </div>
                        </div>
                         <div class="event-modal-footer">
                             <div class="share-icons">
                                 {% set event_url = url('app_events', {'search': event.name|url_encode}) %}
                                 {% set share_text = "Check out this event: " ~ event.name ~ " on ConnectSphere! " ~ event_url %}
                                 <a href="https://www.facebook.com/sharer/sharer.php?u={{ event_url|url_encode }}" target="_blank" rel="noopener noreferrer" title="Share on Facebook" class="facebook-share"><i class="fab fa-facebook-square"></i></a>
                                 <a href="https://api.whatsapp.com/send?text={{ share_text|url_encode }}" target="_blank" rel="noopener noreferrer" title="Share on WhatsApp" class="whatsapp-share"><i class="fab fa-whatsapp-square"></i></a>
                                 <a href="#" class="copy-link" data-link="{{ event_url }}" title="Copy Link"><i class="fas fa-copy"></i></a>
                             </div>
                             <button type="button" class="btn btn-modal-close close-modal-btn">Close</button>
                        </div>
                        <div class="copy-link-feedback">Link Copied!</div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
             <div class="col-12">
                <div class="no-events-message">
                   No events match your current filter. <a href="{{ path('app_events') }}">Clear filters?</a> or <a href="{{ path('app_event_add_page') }}" class="{% if app.request.attributes.get('_route') != 'app_event_add_page' %}open-add-event-trigger{% endif %}">Create a new event?</a>
                </div>
            </div>
        {% endif %}
    </div>
</div>

<!-- Footer from home page -->
<footer class="site-footer">
    {# ... (your full footer HTML) ... #}
    <div class="footer-content container">
        <div class="footer-column">
            <h4>ConnectSphere</h4>
            <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
        </div>
        <div class="footer-column">
            <h4>Quick Links</h4>
            <ul>
                <li><a href="{{ path('app_home') }}">Home</a></li>
                <li><a href="{{ path('app_events') }}">Events</a></li>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="#">Terms of Service</a></li>
            </ul>
        </div>
        <div class="footer-column footer-contact">
            <h4>Contact Us</h4>
            <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
            <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
        </div>
        <div class="footer-column">
            <h4>Follow Us</h4>
            <div class="footer-social-icons">
                <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
            </div>
        </div>
    </div>
    <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
</footer>
{% endblock %}

{% block javascripts %}
{# Bootstrap JS Bundle for alerts and other components if needed #}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // console.log("JS Events List: Initializing modal and participation listeners.");

    // --- Modal handling ---
    const viewDetailButtons = document.querySelectorAll('.view-details-btn');
    viewDetailButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetModalId = this.getAttribute('data-modal-target');
            if (targetModalId) {
                const targetModal = document.querySelector(targetModalId);
                if (targetModal) targetModal.classList.add('active');
            }
        });
    });

    const closeDetailButtons = document.querySelectorAll('.event-modal-overlay .close-modal-btn, .event-modal-overlay .event-modal-close-x');
    closeDetailButtons.forEach(button => {
        button.addEventListener('click', function() {
            this.closest('.event-modal-overlay')?.classList.remove('active');
        });
    });

    const detailModalOverlays = document.querySelectorAll('.event-modal-overlay');
    detailModalOverlays.forEach(overlay => {
        overlay.addEventListener('click', function(event) {
            if (event.target === overlay) {
                overlay.classList.remove('active');
            }
        });
    });

    // --- Link copying ---
    document.querySelectorAll('.copy-link').forEach(button => {
         button.addEventListener('click', function(event) {
             event.preventDefault();
             const linkToCopy = this.getAttribute('data-link');
             const feedbackElement = this.closest('.event-modal-content')?.querySelector('.copy-link-feedback');
             if (linkToCopy && navigator.clipboard) {
                 navigator.clipboard.writeText(linkToCopy).then(() => {
                     if(feedbackElement) {
                         feedbackElement.style.display = 'block';
                         setTimeout(() => { feedbackElement.style.display = 'none'; }, 1500);
                     }
                 }).catch(err => showCopyFallback(linkToCopy, feedbackElement));
             } else if (linkToCopy) {
                  showCopyFallback(linkToCopy, feedbackElement);
             }
         });
    });
    function showCopyFallback(textToCopy, feedbackElement) {
        const textArea = document.createElement("textarea");
        textArea.value = textToCopy;
        textArea.style.position = "fixed"; textArea.style.left = "-9999px";
        document.body.appendChild(textArea);
        textArea.focus(); textArea.select();
        try {
            const successful = document.execCommand('copy');
            if (successful) {
                if(feedbackElement) {
                     feedbackElement.style.display = 'block';
                     setTimeout(() => { feedbackElement.style.display = 'none'; }, 1500);
                 }
            } else {
                alert('Could not copy link. Please copy it manually.');
            }
        } catch (err) {
            alert('Could not copy link. Please copy it manually.');
        }
        document.body.removeChild(textArea);
    }

    // --- Flash messages ---
    const serverFlashMessages = document.querySelectorAll('#server-flash-message-container .alert');
    serverFlashMessages.forEach(function(flashMessage) {
        setTimeout(function() {
            const alertInstance = typeof bootstrap !== 'undefined' ? bootstrap.Alert.getInstance(flashMessage) : null;
            if (alertInstance) {
                alertInstance.close();
            } else { 
                flashMessage.style.transition = 'opacity 0.5s ease-out';
                flashMessage.style.opacity = '0';
                setTimeout(() => flashMessage.remove(), 500);
            }
        }, 7000);
    });

    // --- Event Participation Logic ---
    const ajaxMessageContainer = document.getElementById('ajax-message-container');

    function displayAjaxMessage(message, type = 'success') {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
        alertDiv.setAttribute('role', 'alert');
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `;
        ajaxMessageContainer.innerHTML = ''; 
        ajaxMessageContainer.appendChild(alertDiv);

        setTimeout(() => {
            const bsAlert = typeof bootstrap !== 'undefined' ? bootstrap.Alert.getInstance(alertDiv) : null;
            if (bsAlert) {
                bsAlert.close();
            } else {
                alertDiv.remove();
            }
        }, 5000);
    }

    document.querySelectorAll('.join-event-btn').forEach(button => {
        // If button is already disabled (because user has joined from server-side render),
        // don't add click listener again for AJAX for this specific button.
        if (button.disabled) {
            return;
        }

        button.addEventListener('click', function() {
            const eventId = this.dataset.eventId;
            const participateUrl = `/events/participate/${eventId}`; 

            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Joining...';

            fetch(participateUrl, {
                method: 'POST',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                }
            })
            .then(response => {
                if (!response.ok) { 
                    return response.json().catch(() => {
                        throw new Error(`Server error: ${response.status} ${response.statusText}`);
                    }).then(errorData => {
                        let msg = (errorData && errorData.message) ? errorData.message : `Server error: ${response.status}`;
                        throw new Error(msg);
                    });
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    displayAjaxMessage(data.message, 'success');
                    this.innerHTML = '<i class="fas fa-check"></i> Joined';
                    this.classList.add('joined'); 
                    // Button remains disabled after successful AJAX join
                } else {
                    displayAjaxMessage(data.message || 'An unknown error occurred.', 'danger');
                    this.disabled = false; // Re-enable if join failed via AJAX
                    this.innerHTML = 'Join';
                }
            })
            .catch(error => {
                displayAjaxMessage(error.message || 'Could not connect to the server. Please try again.', 'danger');
                this.disabled = false; // Re-enable on fetch error
                this.innerHTML = 'Join';
            });
        });
    });
});
</script>
{% endblock %}
{# --- End of File --- #}
</file>

<file path="explore/explore.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello ExploreController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/PiSymfony/src/Controller/ExploreController.php'|file_link(0) }}">src/Controller/ExploreController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/PiSymfony/templates/explore/index.html.twig'|file_link(0) }}">templates/explore/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="group/create.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Create Group - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {# <link rel="stylesheet" href="{{ asset('css/creategroups.css') }}"> -- CSS will be embedded #}

    {# Added for header/footer icons and font if not in base.html.twig #}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* --- ROOT CSS Variables (Ensure all needed variables are defined here or globally) --- */
        :root {
            /* Variables for Header/Footer theme */
            --theme-primary-pink: #E83E8C;
            --theme-primary-pink-hover: #d0367c;
            --theme-text-dark: #343A40;
            --theme-border-color: #DEE2E6;
            --pill-radius: 50px; /* For header/footer buttons */

            /* Variables from your creategroups.css (form theme) */
            --form-primary-accent: #667eea;
            --form-secondary-accent: #764ba2;
            --form-focus-shadow-color: rgba(102, 126, 234, 0.2);
            --form-label-color: #4a5568;
            --form-input-border-color: #e2e8f0;
            --form-input-bg: #f8fafc;
            --form-input-bg-focus: white;
            --form-gradient: linear-gradient(90deg, var(--form-primary-accent) 0%, var(--form-secondary-accent) 100%);

            /* General Variables */
            --body-font: 'Poppins', sans-serif;
            --light-bg-page: #f5f7fa; /* For the overall page background */
            --card-bg: white; /* For form container */
            --border-radius-form: 15px; /* From creategroups.css */
            --border-radius-input: 8px; /* From creategroups.css */
            --transition-fast: 0.2s ease-in-out;
            --transition-medium: 0.3s ease;
        }

        body {
            font-family: var(--body-font);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-color: var(--light-bg-page); /* Gradient from creategroups.css now on .groups-container */
        }
        .page-content-wrapper {
            flex: 1;
            display: flex; /* To center .groups-container if it doesn't take full height */
            flex-direction: column; /* Ensure children stack */
        }

        /* --- Header Styles --- */
        .header { background: var(--card-bg); box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: .8rem 1rem; border-bottom: 1px solid var(--theme-border-color); }
        .header .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .header .logo-img { height: 50px; vertical-align: middle; }
        .header .logo a span { vertical-align: middle; font-weight:bold; font-size:1.5rem; color:var(--theme-text-dark); margin-left:10px; }
        .header .nav-links { display: flex; align-items: center; gap: 1.5rem; }
        .header .nav-link { font-weight: 500; transition: color var(--transition-fast); color: var(--theme-text-dark); text-decoration: none; padding: 0.5rem 0; }
        .header .nav-link:hover, .header .nav-link.active { color: var(--theme-primary-pink); text-decoration: none; }
        .header .contact-btn { background: var(--theme-primary-pink); color: white !important; padding: .5rem 1.2rem; border-radius: var(--pill-radius); font-weight: 500; text-decoration: none; transition: background-color var(--transition-fast); }
        .header .contact-btn:hover { background: var(--theme-primary-pink-hover); }

        /* --- Footer Styles --- */
        .site-footer { background: #343a40; color: rgba(255,255,255,.75); padding: 3rem 1rem 1.5rem; margin-top: auto; /* Pushes to bottom if content is short */ }
        .site-footer .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 2rem; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .site-footer .footer-column { flex: 1 1 200px; }
        .site-footer .footer-column h4 { color: #fff; margin-bottom: 1rem; font-weight: 600; border-bottom: 2px solid var(--theme-primary-pink); display: inline-block; padding-bottom: .5rem; }
        .site-footer .footer-column ul { list-style: none; padding: 0; }
        .site-footer .footer-column ul li { margin-bottom: .6rem; }
        .site-footer .footer-column ul li a { color: rgba(255,255,255,.75); transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-column ul li a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-contact i { margin-right: .5rem; color: var(--theme-primary-pink); }
        .site-footer .footer-social-icons a { color: rgba(255,255,255,.75); margin-right: 1rem; font-size: 1.5rem; transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-social-icons a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-bottom { text-align: center; margin-top: 2rem; font-size: .85rem; color: rgba(255,255,255,.55); border-top: 1px solid #495057; padding-top: 1rem; max-width: 1140px; margin-left: auto; margin-right: auto;}

        /* --- creategroups.css Content Starts Here --- */
        .groups-container { /* Renamed from your CSS to avoid conflict, now used as a wrapper */
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            /* min-height: 100vh; -- Handled by body + page-content-wrapper */
            padding: 2rem;
            display: flex; /* To center its child .group-form-outer-wrapper */
            justify-content: center;
            align-items: center;
            flex-grow: 1; /* Takes up available space in .page-content-wrapper */
        }

        /* Renamed from .group-view-container in your CSS to be specific for form */
        .group-form-outer-wrapper {
            background: var(--card-bg);
            border-radius: var(--border-radius-form);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2.5rem;
            width: 100%;
            max-width: 700px;
            animation: fadeInUp 0.6s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden; /* For ::before pseudo-element */
        }

        .group-form-outer-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 8px;
            background: var(--form-gradient);
        }

        /* Renamed from .groups-title in your CSS to be specific for form page */
        .create-group-page-title {
            color: var(--form-label-color);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2.2rem;
            position: relative;
            padding-bottom: 0.5rem;
        }

        .create-group-page-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--form-gradient);
            border-radius: 2px;
        }

        .group-form { /* This is the <form> element */
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            position: relative; /* For potential absolute positioned elements inside */
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--form-label-color);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .form-control, .form-control-file { /* Combined for consistency */
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid var(--form-input-border-color);
            border-radius: var(--border-radius-input);
            font-size: 1rem;
            transition: all var(--transition-medium) ease;
            background-color: var(--form-input-bg);
            box-sizing: border-box; /* Include padding and border in the element's total width and height */
        }
        .form-control-file { /* Specific for file input if needed */
             padding: 0.6rem 1rem; /* Adjust padding for file input */
        }


        .form-control:focus, .form-control-file:focus {
            outline: none;
            border-color: var(--form-primary-accent);
            box-shadow: 0 0 0 3px var(--form-focus-shadow-color);
            background-color: var(--form-input-bg-focus);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1rem; /* Reduced margin from original */
        }

        /* Re-styling form buttons to have a similar feel to header/footer theme where appropriate */
        .form-actions .group-btn { /* General style for form action buttons */
            padding: 0.8rem 1.5rem;
            border-radius: var(--border-radius-input); /* Match input radius */
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-medium) ease;
            text-decoration: none;
            text-align: center;
            font-size: 0.95rem;
            border: none; /* Removing border by default, add back if needed */
        }

        .form-actions .group-btn-primary { /* "Create Group" button */
            background: var(--theme-primary-pink); /* Using header/footer theme pink */
            color: white;
        }

        .form-actions .group-btn-primary:hover {
            background: var(--theme-primary-pink-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(232, 62, 140, 0.3); /* Shadow with pink hue */
        }

        .form-actions .group-btn-outline { /* "Cancel" button */
            border: 2px solid var(--theme-border-color); /* Using header/footer border color */
            color: var(--theme-text-dark); /* Using header/footer text color */
            background: transparent;
        }

        .form-actions .group-btn-outline:hover {
            background: var(--light-bg-page); /* Light hover for cancel */
            border-color: var(--theme-text-muted);
            transform: translateY(-2px);
        }

        /* Animation from creategroups.css */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Floating decoration elements from creategroups.css */
        .group-form-outer-wrapper::after {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(118, 75, 162, 0.1) 0%, rgba(118, 75, 162, 0) 70%);
            top: -50px;
            right: -50px;
            z-index: -1; /* Behind the form */
        }

        /* Image preview style from original creategroups.html.twig */
        #preview {
            margin-top: 1rem;
            max-height: 200px;
            max-width: 100%; /* Ensure it doesn't overflow */
            border-radius: var(--border-radius-input); /* Match input radius */
            display: none; /* Initially hidden */
            border: 1px solid var(--form-input-border-color); /* Consistent border */
            object-fit: cover;
        }

        /* Responsive adjustments for header/footer and form */
        @media (max-width: 768px) {
            /* Form specific responsive from creategroups.css */
            .group-form-outer-wrapper {
                padding: 1.5rem;
                margin: 1rem; /* Add some margin on mobile so it doesn't touch edges */
            }
            .create-group-page-title {
                font-size: 1.8rem;
            }
            .form-actions {
                flex-direction: column-reverse; /* Stack buttons, primary on bottom for better UX */
            }
            .form-actions .group-btn {
                width: 100%; /* Full width buttons on mobile */
            }


            /* Header responsive */
           .header .nav-container { flex-direction: column; align-items: flex-start; }
           .header .nav-links { margin-top: 1rem; flex-direction: column; align-items: flex-start; width: 100%; }
           .header .nav-link, .header .contact-btn { padding: 0.5rem; width: 100%; text-align: left; }
           .header .contact-btn { margin-top: 0.5rem; }
           /* Footer responsive */
           .site-footer .footer-content { flex-direction: column; align-items: center; text-align: center; }
           .site-footer .footer-column { min-width: 100%; margin-bottom: 1rem; }
           .site-footer .footer-column h4 { display: block; }
        }
        /* --- creategroups.css Content Ends Here --- */

    </style>
{% endblock %}

{% block body %}
    {# --- HEADER --- #}
    <header class="header">
        <nav class="nav-container">
          <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
              <img src="{{ asset('images/logo.png') }}" alt="Logo ConnectSphere" class="logo-img">
              <span>ConnectSphere</span>
            </a>
          </div>
          <div class="nav-links">
        <a href="{{ path('app_home') }}" class="nav-link">Home</a>
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_analytics') }}" class="nav-link">Analytics</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
        </nav>
    </header>

    {# --- Main Content Area --- #}
    <div class="page-content-wrapper">
        {# This .groups-container now provides the gradient background and centering #}
        <div class="groups-container">
            {# This .group-form-outer-wrapper is for the white form card #}
            <div class="group-form-outer-wrapper">
                <h1 class="create-group-page-title">Create New Group</h1>

                {% for message in app.flashes('success') %}
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
                {% for message in app.flashes('error') %}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}

                <form method="post" enctype="multipart/form-data" class="group-form">
                    <div class="form-group">
                        <label for="name">Group Name</label>
                        <input type="text" id="name" name="name" class="form-control" required>
                    </div>

                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" class="form-control" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="rules">Group Rules (one rule per line)</label>
                        <textarea id="rules" name="rules" class="form-control" rows="5" placeholder="Enter each rule on a new line." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="profile_picture">Profile Picture</label>
                        <input type="file" id="profile_picture" name="profile_picture" class="form-control-file" accept="image/*">
                        <img id="preview" alt="Image Preview" /> {# Changed alt text #}
                    </div>

                    <div class="form-actions">
                        <a href="{{ path('app_groups') }}" class="group-btn group-btn-outline">Cancel</a>
                        <button type="submit" class="group-btn group-btn-primary">Create Group</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    {# --- FOOTER --- #}
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column"><h4>ConnectSphere</h4><p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p></div>
            <div class="footer-column"><h4>Quick Links</h4><ul><li><a href="{{ path('app_home') }}">Home</a></li><li><a href="{{ path('app_events') }}">Events</a></li><li><a href="#">About Us</a></li><li><a href="#">Blog</a></li><li><a href="#">Contact</a></li><li><a href="#">Terms of Service</a></li></ul></div>
            <div class="footer-column footer-contact"><h4>Contact Us</h4><p><i class="fas fa-phone"></i> <a href="tel:+21692160411">+216 92 160 411</a></p><p><i class="fas fa-envelope"></i> <a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p></div>
            <div class="footer-column"><h4>Follow Us</h4><div class="footer-social-icons"><a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a><a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a><a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a><a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a></div></div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        const input = document.getElementById('profile_picture');
        const preview = document.getElementById('preview');

        if (input && preview) { // Check if elements exist
            input.addEventListener('change', function () {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(this.files[0]);
                } else {
                    preview.src = ''; // Clear preview if no file selected
                    preview.style.display = 'none';
                }
            });
        }
    </script>
    {# If using Bootstrap dismissible alerts, ensure Bootstrap JS is loaded #}
{% endblock %}
</file>

<file path="group/edit.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Edit {{ group.name }} - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/creategroups.css') }}">
{% endblock %}

{% block body %}
<div class="groups-container">
    <div class="group-view-container">
        <h1 class="groups-title">Edit Group</h1>
        
        <form method="post" class="group-form">
            <div class="form-group">
                <label for="name">Group Name</label>
                <input type="text" id="name" name="name" class="form-control" value="{{ group.name }}" required>
            </div>
            
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" class="form-control" rows="3" required>{{ group.description }}</textarea>
            </div>
            
            <div class="form-group">
                <label for="rules">Group Rules</label>
                <textarea id="rules" name="rules" class="form-control" rows="5" required>{{ group.rules }}</textarea>
            </div>
            
{#             <div class="form-group">
                <label for="profile_picture">Profile Picture URL</label>
                <input type="text" id="profile_picture" name="profile_picture" class="form-control" value="{{ group.profile_picture }}">
            </div> #}
            
            <div class="form-actions">
                <a href="{{ path('app_groups')}}" class="group-btn group-btn-outline">Cancel</a>
                <button type="submit" class="group-btn group-btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
</file>

<file path="group/group.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Create Group - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/creategroups.css') }}">
    <style>
        #preview {
            margin-top: 1rem;
            max-height: 200px;
            max-width: 100%;
            border-radius: 8px;
            display: none;
        }
    </style>
{% endblock %}

{% block body %}
<div class="groups-container">
    <div class="group-view-container">
        <h1 class="groups-title">Create New Group</h1>

        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">{{ message }}</div>
        {% endfor %}

        <form method="post" enctype="multipart/form-data" class="group-form">
            <div class="form-group">
                <label for="name">Group Name</label>
                <input type="text" id="name" name="name" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" class="form-control" rows="3" required></textarea>
            </div>

            <div class="form-group">
                <label for="rules">Group Rules</label>
                <textarea id="rules" name="rules" class="form-control" rows="5" required></textarea>
            </div>

            <div class="form-group">
                <label for="profile_picture">Profile Picture</label>
                <input type="file" id="profile_picture" name="profile_picture" class="form-control-file" accept="image/*">
                <img id="preview" alt="Preview" />
            </div>

            <div class="form-actions">
                <a href="{{ path('app_groups') }}" class="group-btn group-btn-outline">Cancel</a>
                <button type="submit" class="group-btn group-btn-primary">Create Group</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        const input = document.getElementById('profile_picture');
        const preview = document.getElementById('preview');

        input.addEventListener('change', function () {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(this.files[0]);
            }
        });
    </script>
{% endblock %}
</file>

<file path="group/index.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Groups - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {# We will embed all CSS directly, so no need to link groups.css separately if all its content is below #}
    {# <link rel="stylesheet" href="{{ asset('css/groups.css') }}"> #}

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* --- ROOT CSS Variables (Ensure all needed variables are defined here or globally) --- */
        :root {
            --primary-color: #1c2b5d; /* Example, define based on your theme */
            --primary-hover: #3d5472; /* Example */
            --secondary-color: #6c757d; /* Example */
            --secondary-hover: #5a6268; /* Example */

            --theme-primary-pink: #E83E8C;
            --theme-primary-pink-hover: #d0367c; /* Added for hover state */
            --theme-secondary-teal: #20C997; /* Example */

            --light-bg: #f8f9fa; /* Example */
            --card-header-bg: #ffffff; /* Example */

            --theme-text-dark: #343A40;
            --theme-text-muted: #6c757d; /* Adjusted for consistency */
            --theme-border-color: #DEE2E6;

            --card-shadow: 0 4px 8px rgba(0,0,0,0.05); /* Example */
            --card-shadow-hover: 0 6px 12px rgba(0,0,0,0.1); /* Example */

            --border-radius: 8px; /* Example */
            --input-border-radius: 6px; /* Example */
            --pill-radius: 50px; /* Example */

            --transition-fast: 0.2s ease-in-out; /* Example */
            --transition-medium: 0.3s ease-in-out; /* Example */

            --body-font: 'Poppins', sans-serif;
        }

        body {
            font-family: var(--body-font);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-color: var(--light-bg); /* Apply light background to whole page */
        }
        .page-content-wrapper {
            flex: 1;
        }

        /* --- Header Styles --- */
        .header { background: var(--card-header-bg, #fff); box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: .8rem 1rem; border-bottom: 1px solid var(--theme-border-color); }
        .header .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .header .logo-img { height: 50px; vertical-align: middle; }
        .header .logo a span { vertical-align: middle; font-weight:bold; font-size:1.5rem; color:var(--theme-text-dark); margin-left:10px; }
        .header .nav-links { display: flex; align-items: center; gap: 1.5rem; }
        .header .nav-link { font-weight: 500; transition: color var(--transition-fast); color: var(--theme-text-dark); text-decoration: none; padding: 0.5rem 0; }
        .header .nav-link:hover, .header .nav-link.active { color: var(--theme-primary-pink); text-decoration: none; }
        .header .contact-btn { background: var(--theme-primary-pink); color: white !important; padding: .5rem 1.2rem; border-radius: var(--pill-radius); font-weight: 500; text-decoration: none; transition: background-color var(--transition-fast); }
        .header .contact-btn:hover { background: var(--theme-primary-pink-hover); }

        /* --- Footer Styles --- */
        .site-footer { background: #343a40; color: rgba(255,255,255,.75); padding: 3rem 1rem 1.5rem; margin-top: auto; }
        .site-footer .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 2rem; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .site-footer .footer-column { flex: 1 1 200px; }
        .site-footer .footer-column h4 { color: #fff; margin-bottom: 1rem; font-weight: 600; border-bottom: 2px solid var(--theme-primary-pink); display: inline-block; padding-bottom: .5rem; }
        .site-footer .footer-column ul { list-style: none; padding: 0; }
        .site-footer .footer-column ul li { margin-bottom: .6rem; }
        .site-footer .footer-column ul li a { color: rgba(255,255,255,.75); transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-column ul li a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-contact i { margin-right: .5rem; color: var(--theme-primary-pink); }
        .site-footer .footer-social-icons a { color: rgba(255,255,255,.75); margin-right: 1rem; font-size: 1.5rem; transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-social-icons a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-bottom { text-align: center; margin-top: 2rem; font-size: .85rem; color: rgba(255,255,255,.55); border-top: 1px solid #495057; padding-top: 1rem; max-width: 1140px; margin-left: auto; margin-right: auto;}


        /* --- groups.css Content Starts Here --- */
        /* Groups Main Container */
        .groups-container {
            /* display: flex; -- Already on body */
            /* min-height: 100vh; -- Already on body */
            /* background-color: var(--light-bg); -- Already on body */
            padding: 2rem; /* This padding is for the content within the main page area */
            /* font-family: var(--body-font); -- Already on body */
        }

        .groups-content {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto; /* Centering the content block */
            padding: 2rem;
            background-color: var(--card-header-bg, #fff);
            border-radius: var(--border-radius, 16px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        /* Header */
        .groups-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--theme-border-color);
        }

        .groups-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
            position: relative;
        }

        .create-group-btn {
            background-color: var(--theme-primary-pink);
            color: white;
            border: none;
            border-radius: var(--pill-radius);
            padding: 0.75rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: background-color var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .create-group-btn:hover {
            background-color: var(--theme-primary-pink-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(232, 62, 140, 0.2);
        }
        .create-group-btn svg {
            width: 1em;
            height: 1em;
        }

        /* Groups Grid */
        .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 2rem;
        }

        .group-card {
            background-color: var(--card-header-bg, #fff);
            border-radius: var(--border-radius);
            /* overflow: hidden; -- Changed to visible for ::before */
            overflow: visible;
            box-shadow: var(--card-shadow);
            transition: transform var(--transition-medium), box-shadow var(--transition-medium);
            border: 1px solid var(--theme-border-color);
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: var(--theme-text-dark);
            position: relative;
        }

        .group-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--card-shadow-hover);
        }
        .group-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            opacity: 0;
            transition: opacity var(--transition-fast);
            z-index: 1;
            border-top-left-radius: var(--border-radius); /* Match parent radius */
            border-top-right-radius: var(--border-radius);/* Match parent radius */
        }
        .group-card:hover::before {
            opacity: 1;
        }

        .group-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
            transition: transform var(--transition-medium);
            border-top-left-radius: calc(var(--border-radius) - 1px); /* Adjust for border */
            border-top-right-radius: calc(var(--border-radius) - 1px);/* Adjust for border */
        }
        .group-card:hover .group-image {
            transform: scale(1.03);
        }

        .group-body {
            padding: 1.25rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 2;
        }

        .group-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--theme-text-dark);
            margin: 0 0 0.5rem 0;
            transition: color var(--transition-fast);
        }
        .group-card:hover .group-name {
            color: var(--primary-color);
        }

        .group-description {
            color: var(--theme-text-muted, #666);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
        }

        .group-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--theme-text-muted, #888);
            margin-bottom: 1rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--theme-border-color);
        }

        .group-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: auto; /* Pushes actions to bottom */
            padding-top: 0.5rem; /* Space above buttons */
        }

        .group-btn { /* This is a generic button style for cards, adjust if needed */
            flex: 1;
            padding: 0.6rem 1rem;
            border-radius: var(--pill-radius);
            font-size: 0.85rem;
            font-weight: 500;
            text-align: center;
            text-decoration: none;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 1px solid transparent;
            box-shadow: 0 1px 3px rgba(0,0,0,0.07);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .group-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.12);
        }
        .group-btn.group-btn-primary {
            background-color: var(--theme-primary-pink);
            color: white;
            border-color: var(--theme-primary-pink);
        }
        .group-btn.group-btn-primary:hover {
            background-color: var(--theme-primary-pink-hover);
            border-color: var(--theme-primary-pink-hover);
        }
        .group-btn.group-btn-outline-themed { /* Use this class for "Join Group" */
            background-color: transparent;
            color: var(--theme-primary-pink);
            border: 1px solid var(--theme-primary-pink);
        }
        .group-btn.group-btn-outline-themed:hover {
            background-color: rgba(232, 62, 140, 0.1);
            color: var(--theme-primary-pink-hover);
            border-color: var(--theme-primary-pink-hover);
        }
        .group-btn.group-btn-outline { /* Used for Edit, for example */
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        .group-btn.group-btn-outline:hover {
            background-color: rgba(28, 43, 93, 0.05); /* Light primary color bg */
            color: var(--primary-hover);
            border-color: var(--primary-hover);
        }
        .group-btn.group-btn-danger { /* Used for Delete/Leave Group */
            /* Your groups.css used secondary-color for danger, this can be confusing.
               Typically danger is red. I'll keep your logic but you might want to revisit. */
            background-color: var(--secondary-color); /* Or a red variable like --danger-color */
            color: white;
            border-color: var(--secondary-color);
        }
        .group-btn.group-btn-danger:hover {
            background-color: var(--secondary-hover);
            border-color: var(--secondary-hover);
        }


        /* Group View Page (Single Group View) */
        .group-view-container {
            max-width: 1000px;
            margin: 0 auto; /* Centered within its parent, which is .groups-content */
            /* padding: 2rem; -- Padding is already on .groups-content */
            /* background-color: var(--card-header-bg, #fff); -- Already on .groups-content */
            /* border-radius: var(--border-radius); -- Already on .groups-content */
            /* box-shadow: var(--card-shadow); -- Already on .groups-content */
        }

        .group-view-container .group-header-info {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            align-items: flex-start;
        }

        .group-avatar { /* For single group view page */
            width: 120px;
            height: 120px;
            border-radius: var(--border-radius);
            object-fit: cover;
            flex-shrink: 0;
            border: 3px solid var(--card-header-bg, #fff); /* Assuming this is for image on a colored bg */
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .group-info { /* For single group view page */
            flex: 1;
        }

        .group-view-container .group-title { /* Specific title for single group view */
            font-size: 2rem; /* Larger than .groups-title */
            margin: 0 0 0.5rem 0;
            color: var(--primary-color);
        }

        .group-creator { /* For single group view page */
            color: var(--theme-text-muted, #666);
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }
        .group-creator a {
            color: var(--primary-color);
            font-weight: 500;
            text-decoration: none;
        }
        .group-creator a:hover {
            color: var(--theme-primary-pink);
            text-decoration: underline;
        }

        .group-rules { /* For single group view page */
            background-color: var(--light-bg); /* A slightly different background */
            padding: 1.5rem;
            border-radius: var(--input-border-radius);
            margin-bottom: 2rem;
            border: 1px solid var(--theme-border-color);
        }

        .group-rules-title { /* For single group view page */
            font-size: 1.2rem;
            margin: 0 0 0.75rem 0;
            color: var(--primary-color);
            font-weight: 600;
        }
        .group-rules ul { /* For single group view page */
            list-style: disc;
            padding-left: 20px;
            color: var(--theme-text-muted);
        }
        .group-rules ul li {
            margin-bottom: 0.5rem;
        }

        /* Members Section */
        .members-section { /* For single group view page */
            margin-top: 2rem;
        }

        .section-title { /* General section title, used on single group view and groups list */
            font-size: 1.5rem;
            color: var(--primary-color);
            margin: 0 0 1.5rem 0;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--theme-border-color);
            font-weight: 600;
        }

        .members-grid { /* For single group view page */
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .member-card { /* For single group view page */
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: var(--card-header-bg, #fff);
            border-radius: var(--input-border-radius);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--theme-border-color);
        }

        .member-avatar { /* For single group view page */
            width: 45px;
            height: 45px;
            border-radius: 50%;
            object-fit: cover;
        }

        .member-info { /* For single group view page */
            flex: 1;
        }

        .member-name { /* For single group view page */
            font-size: 1rem;
            margin: 0;
            color: var(--theme-text-dark);
            font-weight: 500;
        }

        .member-role { /* For single group view page */
            font-size: 0.8rem;
            color: var(--theme-text-muted, #666);
            margin: 0.25rem 0 0 0;
        }


        /* Forms (e.g., Create/Edit Group Form) */
        .group-form { /* For create/edit group page */
            max-width: 700px;
            margin: 2rem auto; /* Should be within .groups-content or similar */
            padding: 2rem;
            background-color: var(--card-header-bg, #fff);
            border-radius: var(--border-radius);
            box-shadow: var(--card-shadow);
        }
        .group-form .form-label { /* Assuming Bootstrap or custom form styling */
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: block;
        }
        .group-form .form-control { /* Assuming Bootstrap or custom form styling */
            /* Styles for input, textarea, select */
            display: block;
            width: 100%;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: var(--theme-text-dark);
            background-color: var(--card-header-bg, #fff);
            background-clip: padding-box;
            border: 1px solid var(--theme-border-color);
            appearance: none;
            border-radius: var(--input-border-radius);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            margin-bottom: 1rem; /* Spacing between form controls */
        }
        .group-form .form-control:focus {
            border-color: var(--primary-color);
            outline: 0;
            box-shadow: 0 0 0 0.25rem rgba(var(--primary-color), 0.25); /* Example focus, replace rgba with actual color if needed */
        }
        .form-actions { /* For create/edit group page */
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--theme-border-color);
        }
        .form-btn-secondary { /* General secondary button, e.g., "Cancel" */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: .75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.5;
            color: #fff;
            background-color: var(--secondary-color);
            border: 1px solid var(--secondary-color);
            border-radius: var(--pill-radius);
            text-decoration: none;
            transition: all var(--transition-fast);
        }
        .form-btn-secondary:hover {
            background-color: var(--secondary-hover);
            border-color: var(--secondary-hover);
            color: #fff;
        }
        /* .create-group-btn can be reused for "Save" if styles match, or create .form-btn-primary */


        /* Group Search Styling */
        .group-search-container {
            margin-bottom: 2.5rem;
            position: relative; /* For potential future absolute positioned elements */
        }

        .group-search-form {
            display: flex;
            max-width: 600px;
            margin: 0 auto 1.5rem auto; /* Center search bar */
            border-radius: var(--pill-radius);
            overflow: hidden; /* To make inner border-radius work with ::before */
            box-shadow: 0 4px 15px rgba(28, 43, 93, 0.1);
            transition: all var(--transition-medium);
            position: relative; /* For ::before pseudo-element */
            background: var(--card-header-bg, #fff); /* Background for input area */
            border: 1px solid var(--theme-border-color);
        }

        .group-search-form:focus-within {
            box-shadow: 0 6px 20px rgba(28, 43, 93, 0.2);
            border-color: var(--primary-color); /* Highlight border on focus */
        }

        .group-search-input {
            flex: 1;
            padding: 0.9rem 1.5rem;
            border: none;
            font-size: 1rem;
            color: var(--theme-text-dark);
            background: transparent; /* Input takes background from parent */
            z-index: 2; /* Above ::before */
        }
        .group-search-input::placeholder {
            color: var(--theme-text-muted, #aaa);
            font-weight: 400;
        }
        .group-search-input:focus {
            outline: none; /* Remove default browser outline */
        }

        .group-search-button {
            padding: 0 1.5rem;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color var(--transition-fast);
            z-index: 2; /* Above ::before */
        }
        .group-search-button:hover {
            background: var(--primary-hover);
        }
        .group-search-button svg {
            transition: transform var(--transition-fast);
        }
        .group-search-button:hover svg {
            transform: scale(1.1);
        }

        .group-search-form::before { /* Animated gradient border effect */
            content: '';
            position: absolute;
            top: -2px; left: -2px; right: -2px; bottom: -2px; /* Cover the border area */
            z-index: 1;
            background: linear-gradient(45deg,
                var(--primary-color), var(--primary-hover), var(--secondary-color), var(--secondary-hover));
            background-size: 400% 400%;
            border-radius: var(--pill-radius); /* Match parent */
            opacity: 0;
            transition: opacity var(--transition-medium);
        }
        .group-search-form:focus-within::before {
            opacity: 0.15; /* Adjust for desired intensity */
            animation: gradientBG 8s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .no-results-message {
            text-align: center;
            padding: 1.5rem;
            background: var(--light-bg);
            border-radius: var(--border-radius);
            max-width: 600px; /* Match search bar width */
            margin: 1rem auto;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--theme-border-color);
            color: var(--theme-text-muted);
        }
        .no-results-message span { /* For emphasizing search term if you add it */
            font-weight: 600;
            color: var(--primary-color);
        }

        .clear-search-btn {
            display: inline-block;
            margin-top: 1rem;
            padding: 0.6rem 1.25rem;
            background: var(--theme-primary-pink);
            color: white;
            border: none;
            border-radius: var(--pill-radius);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all var(--transition-fast);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .clear-search-btn:hover {
            background: var(--theme-primary-pink-hover);
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(232, 62, 140, 0.2);
        }

        /* .search-results -- This class was in groups.css but not used in the HTML.
           If you add a wrapper for search results, style it here. */
        /* .search-results { ... } */


        .section-header { /* Used in groups list for "My Groups" / "Other Groups" headers */
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }
        .section-header .section-title { /* Overrides general .section-title for this context */
            margin-bottom: 0; /* Remove bottom margin */
            border-bottom: none; /* Remove border */
            padding-bottom: 0; /* Remove padding */
        }

        .section-count { /* Badge for group count */
            margin-left: 0.5rem;
            font-size: 0.9rem;
            color: var(--theme-text-muted, #888);
            background-color: var(--light-bg); /* Subtle background */
            padding: 0.25rem 0.6rem;
            border-radius: var(--pill-radius);
        }

        /* Badge styles for member roles if needed */
        .badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: var(--pill-radius);
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1;
        }
        .badge-admin {
            background-color: var(--primary-color);
            color: white;
        }
        .badge-member {
            background-color: var(--theme-border-color, #e0e0e0);
            color: var(--theme-text-dark);
        }

        .no-groups { /* Message when no groups are found in a section */
            padding: 1rem;
            text-align: center;
            color: var(--theme-text-muted);
            font-style: italic;
            grid-column: 1 / -1; /* Make it span all columns if inside a grid */
        }


        /* Responsive adjustments from groups.css and general */
        @media (max-width: 768px) {
            .groups-container {
                padding: 1rem;
            }
            .groups-content {
                padding: 1.5rem;
            }
            .groups-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            .create-group-btn {
                align-self: flex-start; /* Keep button to the left on mobile */
            }
            .group-view-container .group-header-info { /* Single group view */
                flex-direction: column;
                align-items: center; /* Center avatar and info on mobile */
                gap: 1rem;
            }
            .group-avatar { /* Single group view */
                width: 100px;
                height: 100px;
            }
            .group-view-container .group-title { /* Single group view */
                text-align: center;
            }
            .groups-grid { /* Groups list */
                grid-template-columns: 1fr; /* Stack cards */
            }
            .members-grid { /* Single group view */
                grid-template-columns: 1fr; /* Stack member cards */
            }
            .group-actions { /* Card actions */
                flex-direction: column; /* Stack buttons in card */
            }
            .group-btn { /* Card buttons */
                width: 100%; /* Make buttons full width in card on mobile */
            }

            /* Header responsive from general styles */
           .header .nav-container { flex-direction: column; align-items: flex-start; }
           .header .nav-links { margin-top: 1rem; flex-direction: column; align-items: flex-start; width: 100%; }
           .header .nav-link, .header .contact-btn { padding: 0.5rem; width: 100%; text-align: left; }
           .header .contact-btn { margin-top: 0.5rem; }
           /* Footer responsive from general styles */
           .site-footer .footer-content { flex-direction: column; align-items: center; text-align: center; }
           .site-footer .footer-column { min-width: 100%; margin-bottom: 1rem; }
           .site-footer .footer-column h4 { display: block; }
        }
        /* --- groups.css Content Ends Here --- */

    </style>
{% endblock %}

{% block body %}
    {# --- HEADER --- #}
    <header class="header">
        <nav class="nav-container">
          <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
              <img src="{{ asset('images/logo.png') }}" alt="Logo ConnectSphere" class="logo-img">
              <span>ConnectSphere</span>
            </a>
          </div>
          <div class="nav-links">
            <a href="{{ path('app_home') }}" class="nav-link">Home</a>
            <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
            <a href="{{ path('app_dashboard') }}" class="nav-link">Dashboard</a>
            <a href="{{ path('app_groups') }}" class="nav-link active">Groups</a>
            <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
            <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
            <a href="#" class="contact-btn nav-link">Contact</a>
          </div>
        </nav>
    </header>

    {# --- Main Content Area --- #}
    <div class="page-content-wrapper">
        <div class="groups-container"> {# This is the main container styled by groups.css #}
            <div class="groups-content"> {# Inner content wrapper styled by groups.css #}
                <div class="groups-header">
                    <h1 class="groups-title">Groups</h1>
                    <a href="{{ path('app_group_create') }}" class="create-group-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                        </svg>
                        Create Group
                    </a>
                </div>

                {% for message in app.flashes('success') %}
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
                {% for message in app.flashes('error') %} {# Added error flashes #}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}


                <div class="group-search-container">
                    <form method="get" action="{{ path('app_groups') }}" class="group-search-form">
                        <input type="text" name="search" class="group-search-input"
                               placeholder="Search for groups by name..."
                               value="{{ app.request.query.get('search') }}"
                               autocomplete="off">
                        <button type="submit" class="group-search-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </button>
                    </form>
                    {% if app.request.query.get('search') %}
                        {% set hasSearchResultsInLoop = false %} {# Use a different variable name #}
                        {% for group in groups %}
                            {% if group.name|lower matches ('%' ~ app.request.query.get('search')|lower ~ '%') %}
                                {% set hasSearchResultsInLoop = true %}
                            {% endif %}
                        {% endfor %}

                        {% if not hasSearchResultsInLoop %}
                            <div class="no-results-message">
                                No groups found matching "<span>{{ app.request.query.get('search')|escape }}</span>"
                                <a href="{{ path('app_groups') }}" class="clear-search-btn">Clear Search</a>
                            </div>
                        {% endif %}
                    {% endif %}
                </div>

                <!-- My Groups Section -->
                <div class="groups-section">
                    <div class="section-header">
                        <h2 class="section-title">My Groups</h2>
                        {% set myGroupsCount = 0 %}
                        {% for group in groups %}
                            {% if group.creatorId.id == currentUser.id %}
                                {% if not app.request.query.get('search') or group.name|lower matches ('%' ~ app.request.query.get('search')|lower ~ '%') %}
                                    {% set myGroupsCount = myGroupsCount + 1 %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        <span class="section-count">({{ myGroupsCount }})</span>
                    </div>
                    <div class="groups-grid">
                        {% set myGroupsDisplayed = false %}
                        {% for group in groups %}
                            {% if group.creatorId.id == currentUser.id %}
                                {% if not app.request.query.get('search') or group.name|lower matches ('%' ~ app.request.query.get('search')|lower ~ '%') %}
                                    {% set myGroupsDisplayed = true %}
                                    <div class="group-card">
                                        {% if group.profilePicture %}
                                            <img src="data:image/jpeg;base64,{{ group.profilePicture }}" alt="{{ group.name|escape }}'s Profile Picture" class="group-image" />
                                        {% else %}
                                            <img src="{{ asset('images/default-group.jpg') }}" alt="Default Group Image" class="group-image" />
                                        {% endif %}
                                        <div class="group-body">
                                            <h3 class="group-name">{{ group.name|escape }}</h3>
                                            <p class="group-description">{{ group.description|escape|nl2br }}</p>
                                            <div class="group-meta">
                                                <span class="group-meta-item">Created by you</span>
                                                {# You can add more meta items here if needed, like member count #}
                                            </div>
                                            <div class="group-actions">
                                                <a href="{{ path('app_group_view', {'id': group.id}) }}" class="group-btn group-btn-primary">View</a>
                                                <a href="{{ path('app_group_edit', {'id': group.id}) }}" class="group-btn group-btn-outline">Edit</a>
                                                <a href="{{ path('app_group_delete', {'id': group.id}) }}" class="group-btn group-btn-danger" onclick="return confirm('Are you sure you want to delete the group \'{{ group.name|escape('js') }}\'?')">Delete</a>
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        {% if not myGroupsDisplayed %}
                            <p class="no-groups">
                                {% if app.request.query.get('search') %}
                                    No groups you created match "<span>{{ app.request.query.get('search')|escape }}</span>".
                                {% else %}
                                    You haven't created any groups yet. <a href="{{ path('app_group_create') }}">Create one now!</a>
                                {% endif %}
                            </p>
                        {% endif %}
                    </div>
                </div>

                <!-- Other Groups Section -->
                <div class="groups-section">
                    <div class="section-header">
                        <h2 class="section-title">Other Groups</h2>
                        {% set otherGroupsCount = 0 %}
                        {% for group in groups %}
                            {% if group.creatorId.id != currentUser.id %}
                                {% if not app.request.query.get('search') or group.name|lower matches ('%' ~ app.request.query.get('search')|lower ~ '%') %}
                                    {% set otherGroupsCount = otherGroupsCount + 1 %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                         <span class="section-count">({{ otherGroupsCount }})</span>
                    </div>
                    <div class="groups-grid">
                        {% set otherGroupsDisplayed = false %}
                        {% for group in groups %}
                            {% if group.creatorId.id != currentUser.id %}
                                {% if not app.request.query.get('search') or group.name|lower matches ('%' ~ app.request.query.get('search')|lower ~ '%') %}
                                    {% set otherGroupsDisplayed = true %}
                                    <div class="group-card">
                                        {% if group.profilePicture and group.profilePicture starts with 'uploads/' %}
                                            <img src="{{ asset(group.profilePicture) }}" alt="{{ group.name|escape }}" class="group-image">
                                        {% elseif group.profilePicture %}
                                             <img src="data:image/jpeg;base64,{{ group.profilePicture }}" alt="{{ group.name|escape }}'s Profile Picture" class="group-image" />
                                        {% else %}
                                            <img src="{{ asset('images/default-group.jpg') }}" alt="Default Group Image" class="group-image">
                                        {% endif %}
                                        <div class="group-body">
                                            <h3 class="group-name">{{ group.name|escape }}</h3>
                                            <p class="group-description">{{ group.description|escape|nl2br }}</p>
                                            <div class="group-meta">
                                                <span class="group-meta-item">Created by {{ group.creatorId.username|escape }}</span>
                                                {# Add other meta if available #}
                                            </div>
                                            <div class="group-actions">
                                                <a href="{{ path('app_group_view', {'id': group.id}) }}" class="group-btn group-btn-primary">View</a>
                                                {% if userGroups is defined and userGroups[group.id] is defined %}
                                                    <a href="{{ path('app_group_leave', {'id': group.id}) }}" class="group-btn group-btn-danger">Leave</a>
                                                {% else %}
                                                    <a href="{{ path('app_group_join', {'id': group.id}) }}" class="group-btn group-btn-outline-themed">Join</a>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        {% if not otherGroupsDisplayed %}
                            <p class="no-groups">
                                {% if app.request.query.get('search') %}
                                    No other groups match "<span>{{ app.request.query.get('search')|escape }}</span>".
                                {% else %}
                                    There are no other groups available to join.
                                {% endif %}
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    {# --- FOOTER --- #}
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column"><h4>ConnectSphere</h4><p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p></div>
            <div class="footer-column"><h4>Quick Links</h4><ul><li><a href="{{ path('app_home') }}">Home</a></li><li><a href="{{ path('app_events') }}">Events</a></li><li><a href="#">About Us</a></li><li><a href="#">Blog</a></li><li><a href="#">Contact</a></li><li><a href="#">Terms of Service</a></li></ul></div>
            <div class="footer-column footer-contact"><h4>Contact Us</h4><p><i class="fas fa-phone"></i> <a href="tel:+21692160411">+216 92 160 411</a></p><p><i class="fas fa-envelope"></i> <a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p></div>
            <div class="footer-column"><h4>Follow Us</h4><div class="footer-social-icons"><a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a><a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a><a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a><a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a></div></div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
{% endblock %}
</file>

<file path="group/view.html.twig">
{% extends 'base.html.twig' %}

{% block title %}{{ group.name }} - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/viewgroups.css') }}">
    <style>
        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .member-card {
            background: #fff;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .member-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .member-info {
            flex: 1;
        }

        .member-name {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-admin {
            background-color: #4e54c8;
            color: white;
        }

        .badge-member {
            background-color: #e9ecef;
            color: #495057;
        }

        .group-image {
            max-width: 100%;
            max-height: 250px;
            border-radius: 8px;
            margin-bottom: 1rem;
            object-fit: cover;
        }
    </style>
{% endblock %}

{% block body %}
<div class="groups-container">
    <div class="group-view-container">
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}

        <div class="group-header">
            <div class="group-info">
                {% if group.profilePicture %}
                    <img src="{{ asset(group.profilePicture) }}" alt="Group Image" class="group-image">
                {% endif %}

                <h1 class="group-title">{{ group.name }}</h1>
                <p class="group-creator">Created by {{ group.creatorId.username }} on {{ group.createdAt|date('M d, Y') }}</p>
                <p>{{ group.description }}</p>

                <div class="group-actions" style="margin-top: 1rem;">
                    {% if isMember %}
                        <a href="{{ path('app_group_leave', {'id': group.id}) }}" class="group-btn group-btn-danger">Leave Group</a>
                    {% else %}
                        <a href="{{ path('app_group_join', {'id': group.id}) }}" class="group-btn group-btn-primary">Join Group</a>
                    {% endif %}

                    {% if group.creatorId.id == currentUser.id %}
                        <a href="{{ path('app_group_edit', {'id': group.id}) }}" class="group-btn group-btn-outline">Edit Group</a>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="group-rules">
            <h3 class="group-rules-title">Group Rules</h3>
            <p>{{ group.rules }}</p>
        </div>

        <div class="members-section">
            <h2 class="section-title">Members ({{ members|length }})</h2>

            {% if group.creatorId.id == currentUser.id or isMember %}
                <div style="margin-bottom: 1.5rem;">
                    <form method="get" action="{{ path('app_group_invite', {'groupId': group.id}) }}" class="form-inline">
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" name="search" class="form-control" placeholder="Search friends to invite" required style="flex: 1;">
                            <button type="submit" class="group-btn group-btn-primary" style="width: auto; padding: 0.5rem 1rem;">Invite</button>
                        </div>
                    </form>
                </div>

                {% if nonMembers is defined %}
                    <div class="search-results">
                        <h4>Search Results</h4>
                        {% if nonMembers|length > 0 %}
                            <div class="members-grid">
                                {% for user in nonMembers %}
                                    <div class="member-card">
                                        <div class="member-info">
                                            <h4 class="member-name">{{ user.username }}</h4>
                                            <a href="{{ path('app_group_add_member', {'groupId': group.id, 'userId': user.id}) }}" 
                                               class="group-btn group-btn-primary" style="padding: 0.25rem 0.5rem;">
                                                Invite
                                            </a>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p>No users found or all users are already members</p>
                        {% endif %}
                    </div>
                {% endif %}
            {% endif %}
        </div>

        <div class="members-section">
            <div class="members-grid">
                {% for member in members %}
                    <div class="member-card">
                        <div class="member-info">
                            <h4 class="member-name">{{ member.userId.username }}</h4>
                            <p class="member-role">
                                <span class="badge {% if member.role == 'admin' %}badge-admin{% else %}badge-member{% endif %}">
                                    {{ member.role }}
                                </span>
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
</file>

<file path="home/home.html.twig">
{# templates/home/home.html.twig #}
{# PAS de {% extends 'base.html.twig' %} ici #}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Home - ConnectSphere</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>CS</text></svg>">

  <!-- Google Fonts (Poppins) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <!-- Main CSS -->
  <link rel="stylesheet" href="{{ asset('css/root.css') }}">
  <!-- Leaflet CSS -->
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>

  <style>
    /* === Original inline CSS === */
    :root {
      --theme-primary-pink: #E83E8C; --theme-secondary-teal: #20C997;
      --theme-text-dark: #343A40; --theme-bg-light: #FFFFFF;
      --theme-bg-medium: #F8F9FA; --theme-border-color: #DEE2E6;
      --map-bg-color: #f0f5f9; --body-font: 'Poppins', sans-serif;
    }
    body {
      margin:0; font-family:var(--body-font); background:var(--theme-bg-light);
      color:var(--theme-text-dark); font-size:16px; line-height:1.6;
    }
    a { color:var(--theme-primary-pink); text-decoration:none; }
    a:hover { text-decoration:underline; }
    .container { max-width:1140px; margin:0 auto; padding:0 15px; }

    .header { background:#fff; box-shadow:0 1px 3px rgba(0,0,0,0.1); padding:.8rem 1rem; border-bottom:1px solid var(--theme-border-color); }
    .header .nav-container { display:flex; justify-content:space-between; align-items:center; }
    .header .logo-img { height:80px; }
    .header .nav-links { display:flex; gap:1.5rem; align-items: center; /* Pour bien aligner si icônes de tailles différentes */}
    .header .nav-link { font-weight:500; transition:color .2s; display:inline-flex; align-items:center; gap: 0.4rem; /* Pour espacer icône et texte */}
    .header .nav-link i { /* Style optionnel pour les icônes dans les liens de nav */
        /* font-size: 1.1em; */ /* Décommentez si vous voulez des icônes légèrement plus grandes */
    }
    .header .nav-link:hover { color:var(--theme-primary-pink); }
    .header .contact-btn { background:var(--theme-primary-pink); color:#fff; padding:.5rem 1.2rem; border-radius:20px; font-weight:500; }
    .header .contact-btn:hover { background:#d0367c; }

    /* === ENHANCED HERO SECTION STYLES === */
    .hero {
      padding: 4rem 1rem;
      text-align: center;
      background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,249,250,0.95) 100%);
      position: relative;
      overflow: hidden;
    }
    
    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('{{ asset('images/pattern-bg.png') }}') repeat;
      opacity: 0.05;
      z-index: 0;
    }
    
    .hero .container {
      position: relative;
      z-index: 1;
    }
    
    .hero h1 {
      color: var(--theme-primary-pink);
      font-weight: 800;
      margin-bottom: 0.5rem;
      font-size: 2.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 1px 1px 1px rgba(0,0,0,0.05);
      animation: fadeInDown 1s ease-out;
    }
    
    .hero h2 {
      font-size: 2rem;
      font-weight: 700;
      color: var(--theme-text-dark);
      max-width: 800px;
      margin: 0 auto 2rem;
      line-height: 1.3;
      animation: fadeInUp 1s ease-out;
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    
    .featured-events {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex-wrap: wrap;
      margin-bottom: 2.5rem;
      animation: fadeIn 1.2s ease-out;
    }
    
    .featured-event-card {
      flex: 1 1 calc(33% - 1.5rem);
      max-width: calc(33% - 1.5rem);
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
      text-decoration: none;
      color: inherit;
      transition: transform 0.3s, box-shadow 0.3s;
      position: relative;
    }
    
    .featured-event-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      text-decoration: none;
    }
    
    .featured-event-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      transition: transform 0.5s;
    }
    
    .featured-event-card:hover img {
      transform: scale(1.05);
    }
    
    .featured-event-card .info {
      padding: 1.2rem;
      position: relative;
    }
    
    .featured-event-card .info h4 {
      margin: 0 0 0.5rem;
      font-size: 1.25rem;
      color: var(--theme-text-dark);
      font-weight: 600;
    }
    
    .featured-event-card .info p {
      margin: 0;
      font-size: 0.95rem;
      color: #555;
    }
    
    #current-date {
      color: #666;
      margin: 0 0 1.5rem;
      font-size: 1.1rem;
      font-weight: 500;
      display: inline-block;
      padding: 0.5rem 1rem;
      background: rgba(255,255,255,0.7);
      border-radius: 30px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    
    .cta-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .cta-btn {
      display: inline-block;
      background: var(--theme-secondary-teal);
      color: #fff;
      padding: 0.75rem 1.5rem;
      border-radius: 30px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(32, 201, 151, 0.2);
      font-size: 1rem;
    }
    
    .cta-btn:hover {
      background: #1AAE88;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(32, 201, 151, 0.3);
      text-decoration: none;
    }
    
    .cta-btn.surprise {
      background: var(--theme-primary-pink);
      box-shadow: 0 4px 10px rgba(232, 62, 140, 0.2);
    }
    
    .cta-btn.surprise:hover {
      background: #d0367c;
      box-shadow: 0 6px 15px rgba(232, 62, 140, 0.3);
    }
    
    @media (max-width: 992px) {
      .featured-event-card {
        flex: 1 1 calc(50% - 1.5rem);
        max-width: calc(50% - 1.5rem);
      }
    }
    
    @media (max-width: 768px) {
      .hero h1 {
        font-size: 2rem;
      }
      .hero h2 {
        font-size: 1.5rem;
      }
      .featured-event-card {
        flex: 1 1 100%;
        max-width: 100%;
      }
      .header .nav-links {
        gap: 0.8rem; /* Réduire l'espace sur mobile */
        flex-wrap: wrap; /* Permettre le retour à la ligne si nécessaire */
        justify-content: center;
      }
      .header .nav-link {
        font-size: 0.9rem; /* Taille de police un peu plus petite sur mobile */
      }
    }
    /* === END ENHANCED HERO SECTION STYLES === */

    .event-map-section { padding:2.5rem 1rem; background:var(--theme-bg-medium); border-bottom:1px solid var(--theme-border-color); }
    .event-map-section h2 { text-align:center; margin-bottom:2rem; font-weight:600; }
    #standalone-event-map {
      width:100%; max-width:1100px; height:550px; margin:0 auto;
      background:var(--map-bg-color); border:1px solid var(--theme-border-color);
      border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,0.08); position:relative;
    }
    .map-feedback-message {
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      background:rgba(255,255,255,0.8); padding:8px 12px; border-radius:4px; color:#666;
    }

    .section { padding:3rem 1rem; }

    .site-footer { background:#343a40; color:rgba(255,255,255,.75); padding:3rem 1rem 1.5rem; margin-top:3rem; }
    .site-footer .footer-content { display:flex; flex-wrap:wrap; justify-content:space-between; gap:2rem; }
    .site-footer .footer-column { flex:1; min-width:200px; }
    .site-footer .footer-column h4 { color:#fff; margin-bottom:1rem; font-weight:600; border-bottom:2px solid #E83E8C; display:inline-block; padding-bottom:.5rem; }
    .site-footer .footer-column ul { list-style:none; padding:0; }
    .site-footer .footer-column ul li { margin-bottom:.6rem; }
    .site-footer .footer-column ul li a { color:rgba(255,255,255,.75); transition:color .2s; }
    .site-footer .footer-column ul li a:hover { color:#E83E8C; }
    .site-footer .footer-contact i { margin-right:.5rem; color:#E83E8C; }
    .site-footer .footer-social-icons a { color:rgba(255,255,255,.75); margin-right:1rem; font-size:1.5rem; transition:color .2s; }
    .site-footer .footer-social-icons a:hover { color:#E83E8C; }
    .site-footer .footer-bottom { text-align:center; margin-top:2rem; font-size:.85rem; color:rgba(255,255,255,.55); border-top:1px solid #495057; padding-top:1rem; }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <nav class="nav-container container">
      <div class="logo">
        <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
          <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
          <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
        </a>
      </div>
      <div class="nav-links">
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_organizer') }}" class="nav-link">Dashboard</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
        {# <!-- MODIFICATION : Ajout du bouton Messagerie --> #}
        <a href="{{ path('app_discussion') }}" class="nav-link" title="Messagerie">
             Chat
        </a>
        <a href="{{ path('app_points') }}" class="nav-link">Game</a>
      </div>
    </nav>
  </header>

  <!-- ENHANCED HERO -->
  <section class="hero">
    <div class="container">
      <h1>Welcome!</h1>
      <h2>The Ultimate Platform for Planning and Promoting Successful Events</h2>
      
      <!-- FEATURED EVENTS (3 in one line) -->
      <div class="featured-events">
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/ev6.jpg') }}" alt="Food Festival">
          <div class="info">
            <h4>Food Festival</h4>
            <p>Street food & cook‑offs</p>
          </div>
        </a>
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/ev5.jpg') }}" alt="Yoga Retreat">
          <div class="info">
            <h4>Yoga Retreat</h4>
            <p>Sunrise beach yoga</p>
          </div>
        </a>
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/ev4.jpg') }}" alt="Dev Tech Meetup">
          <div class="info">
            <h4>Dev Tech Meetup</h4>
            <p>JS frameworks deep‑dive</p>
          </div>
        </a>
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/event1.jpeg') }}" alt="Yoga Retreat">
          <div class="info">
            <h4>Dancing Party</h4>
            <p>A nigth club party</p>
          </div>
        </a>
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/event3.jpeg') }}" alt="Yoga Retreat">
          <div class="info">
            <h4>Night Club</h4>
            <p>Night club party </p>
          </div>
        </a>
        <a href="{{ path('app_events') }}" class="featured-event-card">
          <img src="{{ asset('images/ev8.png') }}" alt="Yoga Retreat">
          <div class="info">
            <h4>Music festival</h4>
            <p>Sunrise beach yoga</p>
          </div>
        </a>

        
      </div>
      <p id="current-date"></p>
      <div class="cta-buttons">
        <a href="{{ path('app_events') }}" class="cta-btn">Explore Events</a>
        <button id="surprise-btn" class="cta-btn surprise">Surprise Me</button>
      </div>
    </div>
  </section>

  <!-- MAP SECTION -->
  <section class="event-map-section">
    <div class="container">
      <h2>Event Locations Overview</h2>
      <div id="standalone-event-map">
        <p class="map-feedback-message">Loading map...</p>
      </div>
    </div>
  </section>

  <!-- WHO WE ARE -->
  <section class="section">
    <div class="container">
      <h1 style="color:#E83E8C;font-weight:800;">WHO WE ARE</h1>
      <h2>ConnectSphere helps you create unforgettable experiences with our comprehensive event management tools.</h2>
      <div class="cards-grid"></div>
    </div>
  </section>

  <!-- ORIGINAL FOOTER -->
  <footer class="site-footer">
    <div class="footer-content container">
      <div class="footer-column">
        <h4>ConnectSphere</h4>
        <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
      </div>
      <div class="footer-column">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="{{ path('app_home') }}">Home</a></li>
          <li><a href="{{ path('app_events') }}">Events</a></li>
          <li><a href="#">About Us</a></li>
          <li><a href="#">Blog</a></li>
          <li><a href="#">Contact</a></li>
          <li><a href="#">Terms of Service</a></li>
        </ul>
      </div>
      <div class="footer-column footer-contact">
        <h4>Contact Us</h4>
        <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
        <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
      </div>
      <div class="footer-column">
        <h4>Follow Us</h4>
        <div class="footer-social-icons">
          <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
          <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
          <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
          <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
        </div>
      </div>
    </div>
    <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
          crossorigin=""></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Display current date
      const dateEl = document.getElementById('current-date');
      if (dateEl) {
        const today = new Date();
        dateEl.textContent = today.toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });
      }

      // Initialize map
      const map = L.map('standalone-event-map').setView([34.5, 9.5], 7);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: '© <a href="https://osm.org/copyright">OSM</a>'
      }).addTo(map);

      // Remove loading message
      document.querySelector('.map-feedback-message')?.remove();

      // Dummy events array (16 markers)
      const events = [
        { id:1,  name:'Patisserie Flora',      description:'Traditional sweets workshop', imageUrl:'{{ asset("images/event1.jpeg") }}', lat:35.8256, lng:10.6345, phone:'29.862.414', address:'Monastir' },
        { id:2,  name:'Café Montplaisir',      description:'Live acoustic night',          imageUrl:'{{ asset("images/event3.jpeg") }}', lat:36.8065, lng:10.1815, phone:'71.123.456', address:'Tunis'    },
        { id:3,  name:'Dev Tech Meetup',       description:'JS frameworks deep‑dive',      imageUrl:'{{ asset("images/event2.png") }}',  lat:34.7406, lng:10.7603, phone:'74.321.987', address:'Sfax'     },
        { id:4,  name:'Art Workshop',          description:'Painting & sculpture demo',     imageUrl:'{{ asset("images/gaming.png") }}',  lat:36.8061, lng:10.1795, phone:'71.555.123', address:'Tunis'    },
        { id:5,  name:'Food Festival',         description:'Street food & cook‑offs',      imageUrl:'{{ asset("images/ev1.jpg") }}',    lat:35.8850, lng:10.6059, phone:'73.777.888', address:'Sousse'   },
        { id:6,  name:'Yoga Retreat',          description:'Sunrise beach yoga',           imageUrl:'{{ asset("images/ev2.jpg") }}',    lat:36.8610, lng:10.3176, phone:'71.234.567', address:'La Marsa' },
        { id:7,  name:'Startup Pitch Night',   description:'Pitch ideas to investors',     imageUrl:'{{ asset("images/ev3.jpg") }}',    lat:36.8067, lng:10.1718, phone:'71.345.678', address:'Tunis'    },
        { id:8,  name:'Marathon Challenge',    description:'10K charity run',               imageUrl:'{{ asset("images/ev4.jpg") }}',    lat:34.7395, lng:10.7601, phone:'74.456.789', address:'Sfax'     },
        { id:9,  name:'Carthage Music Nights', description:'Open‑air amphitheatre concert', imageUrl:'{{ asset("images/ev5.jpg") }}',    lat:36.8520, lng:10.3300, phone:'71.678.910', address:'Carthage'},
        { id:10, name:'Kairouan Crafts Fair',  description:'Traditional crafts exhibition', imageUrl:'{{ asset("images/ev6.jpg") }}',    lat:35.6781, lng:10.0963, phone:'77.123.456', address:'Kairouan'},
        { id:11, name:'Tozeur Oasis Festival', description:'Desert oasis cultural fest',    imageUrl:'{{ asset("images/ev7.png") }}',    lat:33.9197, lng:8.1220,  phone:'76.234.567', address:'Tozeur'  },
        { id:12, name:'Bizerte Sailing Cup',   description:'Regatta & boat show',           imageUrl:'{{ asset("images/ev8.png") }}',    lat:37.2746, lng:9.8739,  phone:'72.345.678', address:'Bizerte' },
        { id:13, name:'Gabès Date Festival',   description:'Celebrating the date harvest',  imageUrl:'{{ asset("images/event.jpg") }}',   lat:33.8818, lng:10.0982, phone:'75.123.456', address:'Gabès'   },
        { id:14, name:'El Kef Heritage Tour',  description:'Historic walking tour',         imageUrl:'{{ asset("images/ev10.jpg") }}',   lat:36.1770, lng:8.7120,  phone:'78.234.567', address:'El Kef'  },
        { id:15, name:'Mahdia Sea Fest',       description:'Beachside seafood celebration', imageUrl:'{{ asset("images/ev11.jpg") }}',   lat:35.5047, lng:11.0622, phone:'73.345.678', address:'Mahdia'  },
        { id:16, name:'Djerba Cultural Week',  description:'Island music, dance & crafts',  imageUrl:'{{ asset("images/ev12.jpg") }}',   lat:33.8074, lng:10.8456, phone:'75.456.789', address:'Djerba'  }
      ];

      const markers = [];
      events.forEach(evt => {
        const m = L.marker([evt.lat, evt.lng]).addTo(map);
        m.bindPopup(`
          <div style="width:260px;border-radius:8px;overflow:hidden;font-family:var(--body-font);">
            <img src="${evt.imageUrl}" alt="${evt.name}" style="width:100%;height:150px;object-fit:cover;">
            <div style="padding:10px;background:#fff;">
              <h3 style="margin:0;font-size:1.1rem;color:var(--theme-text-dark);">
                <i class="fas fa-map-marker-alt" style="color:var(--theme-primary-pink);margin-right:5px;"></i>${evt.name}
              </h3>
              <p style="margin:5px 0;font-size:0.9rem;color:#555;"><i class="fas fa-info-circle" style="margin-right:6px;"></i>${evt.description}</p>
              <p style="margin:5px 0;font-size:0.9rem;color:#555;"><i class="fas fa-map-marker-alt" style="margin-right:6px;"></i>${evt.address}</p>
              <p style="margin:5px 0;font-size:0.9rem;color:#555;"><i class="fas fa-phone" style="margin-right:6px;"></i>${evt.phone}</p>
            </div>
          </div>`, { maxWidth:270 });
        markers.push(m);
      });

      // Surprise Me
      document.getElementById('surprise-btn').addEventListener('click', () => {
        const i = Math.floor(Math.random()*markers.length);
        const e = events[i];
        map.setView([e.lat,e.lng],12,{animate:true});
        markers[i].openPopup();
      });
    });
  </script>
</body>
</html>
</file>

<file path="jobapplications/jobapplications.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Job Applications{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/organizer.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block body %}
<!-- Sidebar Toggle Button (Mobile) -->
<button class="sidebar-toggle" id="sidebarToggle">
    <i class="fas fa-bars"></i>
</button>

<div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="{{ path('app-root') }}" class="sidebar-logo">
                <i class="fas fa-briefcase"></i>
                <span>Maysem</span>
            </a>
        </div>
        <ul class="sidebar-nav">
            <li>
                <a href="{{ path('app-root') }}" class="{{ app.request.get('_route') == '/root' ? 'active' : '' }}">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="{{ path('app_organizer') }}" class="{{ app.request.get('_route') == '/organizer' ? 'active' : '' }}">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li>
                <a href="{{ path('app_create_job') }}" class="{{ app.request.get('_route') == '/create/job' ? 'active' : '' }}">
                    <i class="fas fa-plus-circle"></i>
                    <span>Create Job</span>
                </a>
            </li>
            <li>
                <a href="{{ path('app_job_feed') }}" class="{{ app.request.get('_route') == '/job/feed' ? 'active' : '' }}">
                    <i class="fas fa-list-alt"></i>
                    <span>Job Feed</span>
                </a>
            </li>
            <li>
                <a href="{{ path('app_job_applications') }}" class="active">
                    <i class="fas fa-file-alt"></i>
                    <span>Applications</span>
                </a>
            </li>
        </ul>
        <div class="sidebar-footer">
            &copy; {{ "now"|date("Y") }} Maysem Platform
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="dashboard-container">
            <h1>Job Applications</h1>

            {% if applications|length > 0 %}
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Applicant</th>
                                <th>Job Title</th>
                                <th>Status</th>
                                <th>Applied At</th>
                                <th>Cover Letter</th>
                                <th>Resume</th>
                                <th>Rating</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for app in applications %}
                            <tr>
                                <td>{{ app.userId.username }}</td>
                                <td>{{ app.jobId.jobTitle }}</td>
                                <td>{{ app.status }}</td>
                                <td>{{ app.appliedAt }}</td>
                                <td>{{ app.coverLetter }}</td>
                                <td><a href="{{ asset('uploads/resumes/' ~ app.resumePath) }}" target="_blank">View Resume</a></td>
                                <td>{{ app.coverRating ?? 'N/A' }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="no-data">No applications found.</div>
            {% endif %}
        </div>
    </main>
</div>

{% block javascripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');

        sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('active');
        });
    });
</script>
{% endblock %}
{% endblock %}
</file>

<file path="jobfeed/jobfeed.html.twig">
{# templates/job_feed/jobfeed.html.twig #}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Job Feed | ConnectSphere{% endblock %}</title>
    
    {% block stylesheets %}
        {# Consistent Font Awesome & Google Fonts #}
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        
        {# Link to a global CSS or the events_page.css for shared styles (header, footer, variables) #}
        <link rel="stylesheet" href="{{ asset('css/events_page.css') }}"> 
        
        {# Specific styles for this job feed page #}
        <link rel="stylesheet" href="{{ asset('css/job_feed.css') }}"> 
        
        {# Bootstrap for modal and potentially other utilities if needed #}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    {% endblock %}
</head>
<body>

    {% block page_header %}
    <!-- Standard Header -->
    <header class="header">
        <nav class="nav-container container">
            <div class="logo">
                <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
                    <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
                    <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
                </a>
            </div>
            <div class="nav-links">
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_analytics') }}" class="nav-link">Analytics</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
            </div>
        </nav>
    </header>
    {% endblock %}

    {% block body %}
<main class="job-feed-page-container">
    <div class="container py-4"> 
        <div class="job-feed-controls-header">
             <h1 class="page-title">All Available Jobs</h1>
             <div class="new-job-action">
                <a href="{{ path('app_create_job') }}" class="btn btn-add-job-page">Post New Job</a>
             </div>
        </div>

        <div class="jobs-list">
            {% if jobs|length > 0 %}
                {% for job in jobs %}
                    <div class="job-card"> {# Main card container #}
                        <div class="job-card-header"> 
                            <h2 class="job-title">{{ job.jobTitle }}</h2>
                            <div class="job-meta">
                                {% if job.eventTitle %}
                                <span class="job-event-title"><i class="fas fa-calendar-check"></i> {{ job.eventTitle }}</span>
                                {% endif %}
                                <span class="salary-badge">{{ job.currency }} {{ job.minSalary|number_format(0, '.', ',') }} - {{ job.maxSalary|number_format(0, '.', ',') }}</span>
                            </div>
                        </div>

                        <div class="job-card-content"> {# New wrapper for better padding/layout control #}
                            <div class="job-card-body"> {# Still using grid for columns #}
                                <div class="job-left-column">
                                    <h3 class="section-title-sm">Job Details</h3>

                                    <div class="job-detail-item">
                                        <div class="job-detail-icon"><i class="fas fa-map-marker-alt"></i></div>
                                        <div class="job-detail-text">
                                            <span class="job-detail-label">Location:</span>
                                            <span class="job-detail-value">{{ job.jobLocation }}</span>
                                        </div>
                                    </div>
                                    <div class="job-detail-item">
                                        <div class="job-detail-icon"><i class="fas fa-briefcase"></i></div>
                                        <div class="job-detail-text">
                                            <span class="job-detail-label">Type:</span>
                                            <span class="job-detail-value">{{ job.employmentType }}</span>
                                        </div>
                                    </div>
                                    <div class="job-detail-item">
                                        <div class="job-detail-icon"><i class="fas fa-user-tie"></i></div>
                                        <div class="job-detail-text">
                                            <span class="job-detail-label">Recruiter:</span>
                                            <span class="job-detail-value">{{ job.recruiterName }}</span>
                                        </div>
                                    </div>
                                    <div class="job-detail-item">
                                        <div class="job-detail-icon"><i class="fas fa-envelope"></i></div>
                                        <div class="job-detail-text">
                                            <span class="job-detail-label">Contact:</span>
                                            <span class="job-detail-value">{{ job.recruiterEmail }}</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="job-right-column">
                                    <h3 class="section-title-sm">Key Information</h3> 
                                    <div class="key-info">
                                        {% if job.applicationDeadLine %}
                                            <div class="deadline-info">
                                                <div class="deadline-icon"><i class="fas fa-hourglass-half"></i></div> {# Changed icon #}
                                                <div class="deadline-details">
                                                    <div class="deadline-label">Apply by:</div>
                                                    <div class="deadline-value">{{ job.applicationDeadLine | date("F d, Y") }}</div>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if job.createdAt %}
                                        <p class="job-posted-date"><i class="fas fa-calendar-plus"></i> Posted: {{ job.createdAt|date('M d, Y') }}</p> {# Shorter date format #}
                                        {% endif %}

                                        <button class="btn btn-apply apply-button" onclick="openModal('{{ job.id }}', '{{ job.jobTitle|escape('js') }}')">
                                            <i class="fas fa-paper-plane"></i> Apply Now
                                        </button>
                                        <button class="btn btn-share share-button">
                                            <i class="fas fa-share-alt"></i> Share Job
                                        </button>
                                    </div>
                                </div>
                            </div>
                             <div class="job-description">
                                <h3 class="section-title-sm">Description</h3>
                                <div class="job-description-text">
                                    {{ job.jobDescreption | nl2br }}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-jobs-message">
                    No jobs currently available. Check back soon! <a href="{{ path('app_create_job') }}">Post a Job?</a>
                </div>
            {% endif %}
        </div>
    </div>
</main>
    {% endblock %}

    {% block page_footer %}
    <!-- Standard Footer -->
    <footer class="site-footer">
        <div class="footer-content container">
            <div class="footer-column">
                <h4>ConnectSphere</h4>
                <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
            </div>
            <div class="footer-column">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="{{ path('app_home') }}">Home</a></li>
                    <li><a href="{{ path('app_events') }}">Events</a></li>
                    <li><a href="#">About Us</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Terms of Service</a></li>
                </ul>
            </div>
            <div class="footer-column footer-contact">
                <h4>Contact Us</h4>
                <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
                <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
            </div>
            <div class="footer-column">
                <h4>Follow Us</h4>
                <div class="footer-social-icons">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
    {% endblock %}

    {# Application Modal - Keep as is, but ensure Bootstrap JS is loaded #}
    <div class="modal fade" id="applicationModal" tabindex="-1" aria-labelledby="applicationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg"> {# Larger modal for better form layout #}
            <div class="modal-content">
                <form id="applicationForm" method="POST" enctype="multipart/form-data">
                    <div class="modal-header">
                        <h5 class="modal-title" id="applicationModalLabel">Apply for: <span id="modalJobTitle">Position</span></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="cover_letter" class="form-label">Cover Letter</label>
                            <textarea class="form-control" id="cover_letter" name="cover_letter" rows="5" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="resume" class="form-label">Resume/CV (PDF only)</label>
                            <input class="form-control" type="file" id="resume" name="resume" accept="application/pdf" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Submit Application</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    {% block javascripts %}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            var applicationModal; // Make modal instance globally accessible in this script
            document.addEventListener('DOMContentLoaded', function() {
                if (document.getElementById('applicationModal')) {
                    applicationModal = new bootstrap.Modal(document.getElementById('applicationModal'));
                }
            });

            function openModal(jobId, jobTitle) { // Pass jobTitle to the modal
                if (applicationModal) {
                    const form = document.getElementById('applicationForm');
                    // Ensure your apply_job route can handle jobId
                    form.action = "{{ url('apply_job', {'jobId': 'JOB_ID_PLACEHOLDER'}) }}".replace('JOB_ID_PLACEHOLDER', jobId);
                    document.getElementById('modalJobTitle').textContent = jobTitle; // Update modal title
                    applicationModal.show();
                } else {
                    console.error('Application modal not initialized');
                }
            }

            // Note: The closeModal function is not strictly needed if using Bootstrap's data-bs-dismiss
            // function closeModal() {
            //     if (applicationModal) {
            //         applicationModal.hide();
            //     }
            // }
        </script>
    {% endblock %}
</body>
</html>
</file>

<file path="messagerie/message/index.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Messaging{% endblock %}

{% block stylesheets %}
<style>
    body {
        background: linear-gradient(180deg, #220054 0%, #5B21B6 100%);
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 40px 0;
        color: #fff;
    }

    .messagerie-wrapper {
        display: flex;
        gap: 20px;
        width: 90%;
        max-width: 1200px;
    }

    .sidebar {
        width: 25%;
        background-color: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        padding: 20px;
        height: 500px;
        overflow-y: auto;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        color: #eee;
        border: 1px solid rgba(255,255,255,0.3);
    }

    .sidebar h5 {
        margin-bottom: 20px;
        color: #d8b4fe; /* lilac accent */
        font-weight: 700;
        font-size: 1.4rem;
        border-bottom: 2px solid #d8b4fe;
        padding-bottom: 6px;
    }

    .user-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .user-item {
        padding: 12px 16px;
        margin-bottom: 10px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        color: #ddd;
        font-weight: 500;
    }

    .user-item:hover {
        background-color: rgba(255, 255, 255, 0.25);
        color: #fff;
    }

    .chat-box {
        width: 75%;
        background-color: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        padding: 20px;
        height: 500px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        border: 1px solid rgba(255,255,255,0.3);
        color: #fff;
    }

    .chat-header {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 15px;
        color: #d8b4fe;
        user-select: none;
    }

    .chat-panel {
        flex: 1;
        overflow-y: auto;
        padding-right: 10px;
        margin-bottom: 15px;
        scrollbar-width: thin;
        scrollbar-color: #a78bfa transparent;
    }

    .chat-panel::-webkit-scrollbar {
        width: 8px;
    }

    .chat-panel::-webkit-scrollbar-thumb {
        background-color: #a78bfa;
        border-radius: 4px;
    }

    .chat-wrapper {
        display: flex;
        flex-direction: column;
        margin-bottom: 14px;
    }

    .align-right {
        align-items: flex-end;
    }

    .chat-bubble {
        padding: 12px 18px;
        border-radius: 20px;
        max-width: 70%;
        word-wrap: break-word;
        font-size: 15px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        background-color: rgba(255, 255, 255, 0.25);
        color: #fff;
        position: relative;
        user-select: text;
        transition: background-color 0.3s ease;
    }

    .chat-right {
        background-color: #7c3aed; /* violet */
        border-bottom-right-radius: 0;
        box-shadow: 0 3px 10px #7c3aedaa;
    }

    .chat-time {
        font-size: 11px;
        color: #d1d5db;
        margin-top: 4px;
        user-select: none;
    }

    .message-box {
        display: flex;
        gap: 10px;
    }

    .message-box input {
        flex: 1;
        padding: 12px 18px;
        border-radius: 20px;
        border: none;
        outline: none;
        font-size: 1rem;
        color: #333;
        background-color: #fff;
        box-shadow: 0 0 5px #7c3aedaa;
        transition: box-shadow 0.3s ease;
    }

    .message-box input:focus {
        box-shadow: 0 0 10px #a78bfa;
    }

    .message-box button {
        padding: 12px 26px;
        border-radius: 20px;
        background-color: #7c3aed;
        color: white;
        border: none;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        box-shadow: 0 4px 12px #7c3aedbb;
        transition: background-color 0.3s ease;
    }

    .message-box button:hover {
        background-color: #a78bfa;
    }
</style>
{% endblock %}

{% block body %}
<div class="container messagerie-wrapper">
    <!-- Sidebar -->
    <div class="sidebar">
        <h5>Users</h5>
        <ul class="user-list">
            <li class="user-item">Ahmed</li>
            <li class="user-item">Maysem</li>
            <li class="user-item">admin</li>
            <li class="user-item">jack</li>
        </ul>
    </div>

    <!-- Chat Box -->
    <div class="chat-box">
        <div class="chat-header">💬 Chat</div>
        <div class="chat-panel" id="chat-panel"></div>
        <div class="message-box">
            <input type="text" placeholder="Write a message..." id="message-input" autocomplete="off">
            <button id="send-button">Send</button>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('message-input');
    const button = document.getElementById('send-button');
    const chatPanel = document.getElementById('chat-panel');

    button.addEventListener('click', () => {
        const msg = input.value.trim();
        if (!msg) return;

        const wrapper = document.createElement('div');
        wrapper.className = 'chat-wrapper align-right';

        const bubble = document.createElement('div');
        bubble.className = 'chat-bubble chat-right';
        bubble.textContent = msg;

        const time = document.createElement('div');
        time.className = 'chat-time';
        time.textContent = new Date().toLocaleTimeString();

        wrapper.appendChild(bubble);
        wrapper.appendChild(time);
        chatPanel.appendChild(wrapper);

        chatPanel.scrollTop = chatPanel.scrollHeight;
        input.value = '';
    });

    // Optional: send message on Enter key
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            button.click();
        }
    });
});
</script>
{% endblock %}
</file>

<file path="organizer/organizer.html.twig">
{# templates/organizer/organizer_dashboard.html.twig (or your equivalent path) #}


{% block stylesheets %}
    {# Styles from events_page.css for consistent theme #}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ asset('css/events_page.css') }}"> {# Main theme CSS from events page #}
    {# Bootstrap CSS for alerts and modal close buttons #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    {# Link to the themed CSS for the organizer dashboard (organizer.css) #}
    <link rel="stylesheet" href="{{ asset('css/organizer.css') }}">
{% endblock %}

{% block body %}

<!-- Modified Header with Organizer Links -->
<header class="header">
    <nav class="nav-container container">
        <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
                <img src="{{ asset('images/logo.png') }}" alt="Logo" class="logo-img" style="margin-right:10px;">
                <span style="font-weight:bold;font-size:1.5rem;color:black;">ConnectSphere</span>
            </a>
        </div>
        <div class="nav-links">
        <a href="{{ path('app_events') }}" class="nav-link">Events</a>
        <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
        <a href="{{ path('app_analytics') }}" class="nav-link">Analytics</a>
        <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
        <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
        <a href="{{ path('app_profile') }}" class="nav-link">Profile</a>
        <a href="{{ path('app_social') }}" class="nav-link">Social</a>
        {# Add a mobile menu toggle for the main header if it doesn't have one for many links #}
        {# <button class="main-header-mobile-toggle">MENU</button> #}
    </nav>
</header>

<!-- NO MORE SIDEBAR or SIDEBAR TOGGLE -->

{# The app-container div might not be strictly necessary anymore, or its styling will change #}
<div class="organizer-page-container"> {# Renamed from app-container for clarity #}
    <!-- Main Content -->
    {# Removed dashboard-main-content-adapter, styles will be directly on main-content or its children #}
    <main class="main-content">
        <div class="dashboard-container">
            {# --- Flash Messages --- #}
            <div id="server-flash-message-container" style="margin-bottom: 20px;">
                {% for label, messages in app.flashes %}
                    <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                        {% for message in messages %}{{ message|raw }}{% endfor %}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            </div>
            <div id="ajax-message-container" style="margin-bottom: 20px;"></div>

            <h1 class="dashboard-page-title">Dashboard - {{ user.username }}</h1>

            <div class="table-nav-buttons">
                <button class="btn-dashboard-nav active" onclick="showSection('section-jobs', this)">Posted Jobs</button>
                <button class="btn-dashboard-nav" onclick="showSection('section-events', this)">Posted Events</button>
                <button class="btn-dashboard-nav" onclick="showSection('section-my-apps', this)">My Applications</button>
                <button class="btn-dashboard-nav" onclick="showSection('section-apps-to-me', this)">Applications to My Jobs</button>
                <button class="btn-dashboard-nav" onclick="showSection('section-my-participations', this)">My Participations</button>
                <button class="btn-dashboard-nav" onclick="showSection('section-participants-to-my-events', this)">Participants to My Events</button>
            </div>

            <!-- JOBS SECTION -->
            <div class="table-section" id="section-jobs">
                <div class="section-header">My Job Postings</div>
                {% if jobs|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Location</th>
                                    <th>Type</th>
                                    <th>Salary Range</th>
                                    <th>Deadline</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for job in jobs %}
                                    <tr>
                                        <td data-label="Title">{{ job.jobTitle }}</td>
                                        <td data-label="Location">{{ job.jobLocation }}</td>
                                        <td data-label="Type">{{ job.employmentType }}</td>
                                        <td data-label="Salary">{{ job.currency }} {{ job.minSalary|number_format }} - {{ job.currency }} {{ job.maxSalary|number_format }}</td>
                                        <td data-label="Deadline">{{ job.applicationDeadLine|date('Y-m-d') }}</td>
                                        <td data-label="Actions" class="actions-cell">
                                            <button class="btn btn-action btn-edit" onclick="toggleForm('job-form-{{ job.id }}')"><i class="fas fa-edit"></i> Edit</button>
                                            <form method="post" action="{{ path('organizer_delete_job', {'id': job.id}) }}" onsubmit="return confirm('Are you sure you want to delete this job?');" style="display:inline;">
                                                <input type="hidden" name="_method" value="POST">
                                                <input type="hidden" name="token" value="{{ csrf_token('delete_job' ~ job.id) }}">
                                                <button class="btn btn-action btn-delete"><i class="fas fa-trash"></i> Delete</button>
                                            </form>
                                        </td>
                                    </tr>
                                    <tr id="job-form-{{ job.id }}" class="edit-form-row" style="display:none;">
                                        <td colspan="6">
                                            {{ form_start(job_forms[job.id], {'action': path('job_edit', {'id': job.id}), 'attr': {'class': 'dashboard-edit-form'}}) }}
                                            {{ form_widget(job_forms[job.id]) }}
                                            <button type="submit" class="btn btn-action btn-save"><i class="fas fa-save"></i> Save Changes</button>
                                            <button type="button" class="btn btn-action btn-cancel" onclick="toggleForm('job-form-{{ job.id }}')">Cancel</button>
                                            {{ form_end(job_forms[job.id]) }}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">No job postings available. <a href="{{path('app_create_job')}}">Post a new Job?</a></p>
                {% endif %}
            </div>

            <!-- EVENTS SECTION -->
            <div class="table-section" id="section-events">
                <div class="section-header">My Events</div>
                {% if events|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Event Name</th>
                                    <th>Location</th>
                                    <th>Start Time</th>
                                    <th>End Time</th>
                                    <th>Points</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for event in events %}
                                    <tr>
                                        <td data-label="Event Name">{{ event.name }}</td>
                                        <td data-label="Location">{{ event.location }}</td>
                                        <td data-label="Start Time">{{ event.startTime|date('Y-m-d H:i') }}</td>
                                        <td data-label="End Time">{{ event.endTime|date('Y-m-d H:i') }}</td>
                                        <td data-label="Points">{{ event.points|default(0) }}</td>
                                        <td data-label="Actions" class="actions-cell">
                                            <button class="btn btn-action btn-edit" onclick="toggleForm('event-form-{{ event.id }}')"><i class="fas fa-edit"></i> Edit</button>
                                            <form method="post" action="{{ path('organizer_delete_event', {'id': event.id}) }}" onsubmit="return confirm('Are you sure you want to delete this event?');" style="display:inline;">
                                                <input type="hidden" name="token" value="{{ csrf_token('delete_event' ~ event.id) }}">
                                                <button class="btn btn-action btn-delete"><i class="fas fa-trash"></i> Delete</button>
                                            </form>
                                        </td>
                                    </tr>
                                    <tr id="event-form-{{ event.id }}" class="edit-form-row" style="display:none;">
                                        <td colspan="6">
                                            {{ form_start(event_forms[event.id], {'action': path('event_edit', {'id': event.id}), 'attr': {'class': 'dashboard-edit-form'}}) }}
                                            {{ form_widget(event_forms[event.id]) }}
                                            <button type="submit" class="btn btn-action btn-save"><i class="fas fa-save"></i> Save Changes</button>
                                            <button type="button" class="btn btn-action btn-cancel" onclick="toggleForm('event-form-{{ event.id }}')">Cancel</button>
                                            {{ form_end(event_forms[event.id]) }}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">No events found. <a href="{{ path('app_event_add_page')}}">Post a new Event?</a></p>
                {% endif %}
            </div>

            <!-- MY APPLICATIONS SECTION -->
            <div class="table-section" id="section-my-apps">
                <div class="section-header">My Job Applications</div>
                {% if my_applications|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Job Title</th>
                                    <th>Company</th>
                                    <th>Applied At</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for application in my_applications %}
                                    <tr>
                                        <td data-label="Job Title">{{ application.jobId.jobTitle }}</td>
                                        <td data-label="Company">{{ application.jobId.recruiterName }}</td>
                                        <td data-label="Applied At">{{ application.appliedAt|date('Y-m-d H:i') }}</td>
                                        <td data-label="Status"><span class="status-badge status-{{ application.status|lower|replace({' ': '-'}) }}">{{ application.status }}</span></td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">You haven't applied to any jobs yet. <a href="{{ path('app_job_feed') }}">Find Jobs?</a></p>
                {% endif %}
            </div>

            <!-- APPLICATIONS TO MY JOBS -->
            <div class="table-section" id="section-apps-to-me">
                <div class="section-header">Applications to Your Posted Jobs</div>
                {% if applications_to_my_jobs|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Applicant</th>
                                    <th>Job Title</th>
                                    <th>Applied At</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for application in applications_to_my_jobs %}
                                    <tr>
                                        <td data-label="Applicant">{{ application.userId.username }}</td>
                                        <td data-label="Job Title">{{ application.jobId.jobTitle }}</td>
                                        <td data-label="Applied At">{{ application.appliedAt|date('Y-m-d H:i') }}</td>
                                        <td data-label="Status"><span class="status-badge status-{{ application.status|lower|replace({' ': '-'}) }}">{{ application.status }}</span></td>
                                        <td data-label="Actions" class="actions-cell">
                                            {% if application.status|lower not in ['approved', 'accepted'] %}
                                            <a href="{{ path('app_approve_application', {'id': application.id}) }}" class="btn btn-action btn-approve"><i class="fas fa-check"></i> Approve</a>
                                            {% endif %}
                                            {% if application.status|lower != 'rejected' %}
                                            <a href="{{ path('app_reject_application', {'id': application.id}) }}" class="btn btn-action btn-reject"><i class="fas fa-times"></i> Reject</a>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">No applications to your posted jobs yet.</p>
                {% endif %}
            </div>

            <!-- MY PARTICIPATIONS -->
            <div class="table-section" id="section-my-participations">
                <div class="section-header">My Event Participations</div>
                {% if my_participations|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Event Title</th>
                                    <th>Event Date</th>
                                    <th>Location</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for participation in my_participations %}
                                    <tr>
                                        <td data-label="Event Title">{{ participation.event.getName() }}</td>
                                        <td data-label="Event Date">{{ participation.event.getStartTime()|date('Y-m-d H:i') }}</td>
                                        <td data-label="Location">{{ participation.event.getLocation() }}</td>
                                        <td data-label="Action" class="actions-cell">
                                            <form method="post" action="{{ path('cancel_participation', {'id': participation.id}) }}" onsubmit="return confirm('Are you sure you want to cancel your participation?');" style="display:inline;">
                                                <input type="hidden" name="token" value="{{ csrf_token('cancel_participation' ~ participation.id) }}">
                                                <button type="submit" class="btn btn-action btn-delete"><i class="fas fa-times-circle"></i> Cancel</button>
                                            </form>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">You haven't participated in any events yet. <a href="{{ path('app_events') }}">Find Events?</a></p>
                {% endif %}
            </div>

            <!-- PARTICIPANTS TO MY EVENTS -->
            <div class="table-section" id="section-participants-to-my-events">
                <div class="section-header">Participants in My Events</div>
                {% if participants_to_my_events|length > 0 %}
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Participant Name</th>
                                    <th>Gender</th>
                                    <th>Age</th>
                                    <th>Event Title</th>
                                    <th>Location</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for participation in participants_to_my_events %}
                                    <tr>
                                        <td data-label="Participant Name">{{ participation.participant.username }}</td>
                                        <td data-label="Gender">{{ participation.participant.gender|default('N/A') }}</td>
                                        <td data-label="Age">{{ participation.participant.age|default('N/A') }}</td>
                                        <td data-label="Event Title">{{ participation.event.name }}</td>
                                        <td data-label="Location">{{ participation.event.location }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="no-data">No participants found for your events.</p>
                {% endif %}
            </div>
        </div>{# end .dashboard-container #}
    </main> {# end .main-content #}
</div> {# end .organizer-page-container #}


<!-- Footer from events page -->
<footer class="site-footer">
    <div class="footer-content container">
        <div class="footer-column">
            <h4>ConnectSphere</h4>
            <p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p>
        </div>
        <div class="footer-column">
            <h4>Quick Links</h4>
            <ul>
                <li><a href="{{ path('app_home') }}">Home</a></li>
                <li><a href="{{ path('app_events') }}">Events</a></li>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Blog</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="#">Terms of Service</a></li>
            </ul>
        </div>
        <div class="footer-column footer-contact">
            <h4>Contact Us</h4>
            <p><i class="fas fa-phone"></i><a href="tel:+21692160411">+216 92 160 411</a></p>
            <p><i class="fas fa-envelope"></i><a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p>
        </div>
        <div class="footer-column">
            <h4>Follow Us</h4>
            <div class="footer-social-icons">
                <a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a>
                <a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a>
                <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a>
                <a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a>
            </div>
        </div>
    </div>
    <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
</footer>

{% endblock %}


{% block javascripts %}
{# Bootstrap JS Bundle for alerts and other components #}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Flash messages auto-hide ---
    const serverFlashMessages = document.querySelectorAll('#server-flash-message-container .alert');
    serverFlashMessages.forEach(function(flashMessage) {
        setTimeout(function() {
            const alertInstance = typeof bootstrap !== 'undefined' ? bootstrap.Alert.getInstance(flashMessage) : null;
            if (alertInstance) {
                alertInstance.close();
            } else {
                flashMessage.style.transition = 'opacity 0.5s ease-out';
                flashMessage.style.opacity = '0';
                setTimeout(() => flashMessage.remove(), 500);
            }
        }, 7000);
    });

    // --- Dashboard Section Toggle ---
    const navButtons = document.querySelectorAll('.table-nav-buttons .btn-dashboard-nav');
    function showSection(sectionId, clickedButton) {
        const sections = document.querySelectorAll('.table-section');
        sections.forEach(section => section.style.display = 'none');
        
        const target = document.getElementById(sectionId);
        if (target) {
            target.style.display = 'block';
        }

        navButtons.forEach(button => button.classList.remove('active'));
        if (clickedButton) {
            clickedButton.classList.add('active');
        }
    }
    // Make showSection globally available
    window.showSection = showSection;


    // Show jobs section by default
    const firstNavButton = document.querySelector('.table-nav-buttons .btn-dashboard-nav');
    if (firstNavButton) {
        // Ensure the default section to show is 'section-jobs' or whatever the first button targets
        const defaultSectionId = firstNavButton.getAttribute('onclick').match(/'([^']+)'/)[1];
        showSection(defaultSectionId, firstNavButton);
    }

    // --- Dashboard Form Toggle ---
    function toggleForm(formId) {
        const row = document.getElementById(formId);
        if (row) {
            row.style.display = row.style.display === "none" ? "table-row" : "none";
        }
    }
    // Make toggleForm globally available
    window.toggleForm = toggleForm;

    // NO MORE SIDEBAR JS NEEDED
});
</script>
{% endblock %}
</file>

<file path="points/convert_links.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Conversion de Points{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .stat-card {
            flex: 1;
            background-color: #f8f9fa;
            padding: 15px;
            margin: 0 10px;
            border-radius: 5px;
            text-align: center;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
        }
        
        .stat-card h2 {
            margin-top: 0;
            font-size: 18px;
            color: #6c757d;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #343a40;
        }
        
        .conversion-options {
            margin-bottom: 30px;
        }
        
        .conversion-title {
            text-align: center;
            margin-bottom: 20px;
            color: #495057;
        }
        
        .conversion-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .conversion-card {
            width: 200px;
            padding: 15px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .conversion-card h3 {
            margin-top: 0;
            font-size: 16px;
            color: #495057;
        }
        
        .conversion-links-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .convert-link {
            display: block;
            padding: 8px 12px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        .convert-link:hover {
            background-color: #0069d9;
        }
        
        .history-section {
            margin-top: 30px;
        }
        
        .history-title {
            margin-bottom: 15px;
            color: #495057;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        table th, table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #495057;
        }
        
        table tr:hover {
            background-color: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .badge-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .badge-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .badge-tnd {
            background-color: #cce5ff;
            color: #004085;
        }
        
        .badge-eur {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .badge-usd {
            background-color: #fff3cd;
            color: #856404;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="container">
        <h1>Conversion de Points en Argent</h1>
        
        {% for message in app.flashes('success') %}
            <div class="alert alert-success">
                {{ message }}
            </div>
        {% endfor %}
        
        {% for message in app.flashes('error') %}
            <div class="alert alert-danger">
                {{ message }}
            </div>
        {% endfor %}
        
        <div class="stats">
            <div class="stat-card">
                <h2>Points Disponibles</h2>
                <div class="stat-value">{{ user.points|default(0) }}</div>
            </div>
            
            <div class="stat-card">
                <h2>Argent Total</h2>
                <div class="stat-value">{{ user.argent|default('0.00') }}</div>
            </div>
            
            <div class="stat-card">
                <h2>Taux de Conversion</h2>
                <div class="stat-value">100 Points = 5 TND</div>
            </div>
        </div>
        
        <div class="conversion-options">
            <h2 class="conversion-title">Convertir des Points</h2>
            
            <div class="conversion-links">
                <div class="conversion-card">
                    <h3>TND</h3>
                    <div class="conversion-links-container">
                        <a href="{{ path('app_quick_convert_points', {'points': 100, 'devise': 'TND'}) }}" class="convert-link">Convertir 100 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 200, 'devise': 'TND'}) }}" class="convert-link">Convertir 200 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 500, 'devise': 'TND'}) }}" class="convert-link">Convertir 500 points</a>
                    </div>
                </div>
                
                <div class="conversion-card">
                    <h3>EUR</h3>
                    <div class="conversion-links-container">
                        <a href="{{ path('app_quick_convert_points', {'points': 100, 'devise': 'EUR'}) }}" class="convert-link">Convertir 100 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 200, 'devise': 'EUR'}) }}" class="convert-link">Convertir 200 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 500, 'devise': 'EUR'}) }}" class="convert-link">Convertir 500 points</a>
                    </div>
                </div>
                
                <div class="conversion-card">
                    <h3>USD</h3>
                    <div class="conversion-links-container">
                        <a href="{{ path('app_quick_convert_points', {'points': 100, 'devise': 'USD'}) }}" class="convert-link">Convertir 100 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 200, 'devise': 'USD'}) }}" class="convert-link">Convertir 200 points</a>
                        <a href="{{ path('app_quick_convert_points', {'points': 500, 'devise': 'USD'}) }}" class="convert-link">Convertir 500 points</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="history-section">
            <h2 class="history-title">Historique des Conversions</h2>
            
            {% if transactions is empty %}
                <p>Aucune conversion n'a été effectuée.</p>
            {% else %}
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Points Convertis</th>
                            <th>Montant Reçu</th>
                            <th>Devise</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for transaction in transactions %}
                            <tr>
                                <td>{{ transaction.date|date('d/m/Y H:i') }}</td>
                                <td>{{ transaction.pointConvertis }}</td>
                                <td>{{ transaction.montant }}</td>
                                <td>
                                    <span class="badge badge-{{ transaction.devise|lower }}">
                                        {{ transaction.devise }}
                                    </span>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
        
        <div class="history-section">
            <h2 class="history-title">Historique des Points</h2>
            
            {% if pointsHistory is empty %}
                <p>Aucun historique de points disponible.</p>
            {% else %}
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Points</th>
                            <th>Raison</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in pointsHistory %}
                            <tr>
                                <td>{{ entry.date|date('d/m/Y H:i') }}</td>
                                <td>
                                    {% if entry.type == 'gain' %}
                                        <span class="badge badge-success">Gain</span>
                                    {% else %}
                                        <span class="badge badge-danger">Perte</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if entry.type == 'gain' %}
                                        +{{ entry.points }}
                                    {% else %}
                                        {{ entry.points }}
                                    {% endif %}
                                </td>
                                <td>{{ entry.raison }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
    </div>
{% endblock %}
</file>

<file path="points/convert_simple.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Conversion de Points{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .header {
            background-color: #6b46c1;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
        }
        
        .stat-card h2 {
            margin-top: 0;
            color: #6b46c1;
            font-size: 18px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .conversion-form {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .conversion-form h2 {
            margin-top: 0;
            color: #6b46c1;
            font-size: 18px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .btn {
            background-color: #6b46c1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .btn:hover {
            background-color: #5a32a3;
        }
        
        .history-section {
            margin-top: 30px;
        }
        
        .history-section h2 {
            color: #6b46c1;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        table th, table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        table th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .badge-success {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .badge-danger {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid #10b981;
        }
        
        .alert-danger {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid #ef4444;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="container">
        <div class="header">
            <h1>Conversion de Points</h1>
        </div>
        
        {% if app.session.flashBag.has('success') %}
            {% for message in app.session.flashBag.get('success') %}
                <div class="alert alert-success">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        {% if app.session.flashBag.has('error') %}
            {% for message in app.session.flashBag.get('error') %}
                <div class="alert alert-danger">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        <div class="stats-grid">
            <div class="stat-card">
                <h2>Points Disponibles</h2>
                <div class="stat-value">{{ user.points|default(0) }}</div>
            </div>
            
            <div class="stat-card">
                <h2>Argent Total</h2>
                <div class="stat-value">{{ user.argent|default('0.00') }}</div>
            </div>
            
            <div class="stat-card">
                <h2>Taux de Conversion</h2>
                <div class="stat-value">100 Points = 5 TND</div>
            </div>
        </div>
        
        <div class="conversion-form">
            <h2>Convertir des Points en Argent</h2>
            
            <form action="{{ path('app_direct_convert_points') }}" method="post">
                <div class="form-group">
                    <label for="points">Points à Convertir</label>
                    <input type="number" id="points" name="points" class="form-control" value="100" min="100" step="100" required>
                    <small>Le nombre de points doit être un multiple de 100.</small>
                </div>
                
                <div class="form-group">
                    <label for="devise">Devise</label>
                    <select id="devise" name="devise" class="form-control" required>
                        <option value="TND">TND</option>
                        <option value="EUR">EUR</option>
                        <option value="USD">USD</option>
                    </select>
                </div>
                
                <button type="submit" class="btn">Convertir</button>
            </form>
        </div>
        
        <div class="history-section">
            <h2>Historique des Conversions</h2>
            
            {% if transactions is empty %}
                <p>Aucune conversion n'a été effectuée.</p>
            {% else %}
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Points Convertis</th>
                            <th>Montant Reçu</th>
                            <th>Devise</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for transaction in transactions %}
                            <tr>
                                <td>{{ transaction.date|date('d/m/Y H:i') }}</td>
                                <td>{{ transaction.pointConvertis }}</td>
                                <td>{{ transaction.montant }}</td>
                                <td>
                                    <span class="badge badge-success">{{ transaction.devise }}</span>
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
        
        <div class="history-section">
            <h2>Historique des Points</h2>
            
            {% if pointsHistory is empty %}
                <p>Aucun historique de points disponible.</p>
            {% else %}
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Points</th>
                            <th>Raison</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in pointsHistory %}
                            <tr>
                                <td>{{ entry.date|date('d/m/Y H:i') }}</td>
                                <td>
                                    {% if entry.type == 'gain' %}
                                        <span class="badge badge-success">Gain</span>
                                    {% else %}
                                        <span class="badge badge-danger">Perte</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if entry.type == 'gain' %}
                                        +{{ entry.points }}
                                    {% else %}
                                        {{ entry.points }}
                                    {% endif %}
                                </td>
                                <td>{{ entry.raison }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
    </div>
{% endblock %}
</file>

<file path="points/convert_updated.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Conversion de Points{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* Base Styles */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: #F5F5FF; /* Fond clair */
            color: #1F2937;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 207px;
            background: linear-gradient(180deg, #220054 0%, #5B21B6 100%); /* Dégradé violet */
            color: #FFFFFF;
            padding: 20px 8px;
            position: fixed;
            top: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            border-top-right-radius: 12px; /* Border-radius côté droit */
            border-bottom-right-radius: 12px; /* Border-radius côté droit */
        }

        .sidebar .logo {
            margin-bottom: 40px;
        }

        .sidebar .logo h1 {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
        }

        .sidebar ul {
            list-style: none;
            flex-grow: 1;
            padding: 0;
        }

        .sidebar ul li {
            margin: 10px 0;
            position: relative;
        }

        .sidebar ul li a {
            display: flex;
            align-items: center;
            color: #FFFFFF;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            padding: 12px 15px;
            border-radius: 8px;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .sidebar ul li a i {
            margin-right: 10px;
            font-size: 18px;
        }

        .sidebar ul li a:hover,
        .sidebar ul li a.active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.03); /* Léger agrandissement au survol */
        }

        /* Sous-menu pour Dashboard */
        .submenu {
            display: none;
            list-style: none;
            padding: 0;
            margin: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .submenu li a {
            padding: 10px 30px;
            font-size: 14px;
        }

        .submenu li a:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .submenu.active {
            display: block;
            max-height: 200px; /* Ajuste selon le contenu */
        }

        /* Main Content */
        .main-content {
            margin-left: 220px;
            width: calc(100% - 220px);
            padding: 15px; /* Réduit pour minimiser les espaces */
            background: #F5F5FF;
        }

        /* Welcome Card */
        .welcome-card {
            background: linear-gradient(135deg,rgb(29, 0, 98), #9F7AEA); /* Dégradé violet doux */
            border-radius: 12px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 15px; /* Réduit pour minimiser les espaces */
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .welcome-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .welcome-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: #FFFFFF;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .welcome-avatar i {
            font-size: 30px;
            color: #6B46C1;
        }

        .welcome-text h2 {
            font-size: 24px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        .welcome-text p {
            font-size: 14px;
            color: #EDE9FE;
            font-weight: 400;
        }

        /* Stats Grid (Points, Money, Conversion Score) */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px; /* Réduit pour minimiser les espaces */
        }

        .stat-card, .conversion-score-card {
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-card:hover, .conversion-score-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        /* Nouvelles couleurs élégantes pour chaque carte */
        .stat-card.points-card {
            background: linear-gradient(135deg,rgb(249, 198, 69),rgb(250, 213, 149)); /* Dégradé doré/orange */
        }

        .stat-card.money-card {
            background: linear-gradient(135deg,rgb(115, 209, 249), #0EA5E9); /* Dégradé bleu saphir */
        }

        .conversion-score-card {
            background: linear-gradient(135deg,rgb(205, 165, 244),rgb(183, 112, 249)); /* Dégradé violet améthyste */
        }

        .stat-card h3, .conversion-score-card h3 {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-value.points {
            color: #B45309; /* Orange foncé pour les points */
        }

        .stat-value.money {
            color: #075985; /* Bleu profond pour l'argent */
        }

        /* Conversion Score Specific Styles */
        .conversion-score-card .score-value {
            font-size: 20px;
            font-weight: 600;
            color: #6B21A8; /* Violet sombre pour le score */
            margin-bottom: 5px;
        }

        /* Avatars animés */
        .stat-avatar, .score-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin: 0 auto 10px;
        }

        .stat-avatar i, .score-avatar i {
            font-size: 20px;
            color: #FFFFFF;
            animation: pulse 2s infinite ease-in-out;
        }

        /* Animation de pulsation */
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Convert Section (Card) */
        .convert-card {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 15px; /* Réduit pour minimiser les espaces */
        }

        .convert-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .convert-card h3 {
            font-size: 16px;
            font-weight: 600;
            color: #6B7280;
            margin-bottom: 15px;
            text-align: center;
        }

        .convert-form {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .convert-field {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 200px;
        }

        .convert-label {
            font-size: 14px;
            color: #6B7280;
        }

        .convert-spinner, .devise-select {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            background-color: #F9FAFB;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: border-color 0.3s ease;
        }

        .convert-spinner:focus, .devise-select:focus {
            outline: none;
            border: 1px solid #7C3AED;
        }

        .convert-button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #7C3AED, #A855F7); /* Dégradé violet */
            border: none;
            color: #FFFFFF;
            font-size: 14px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
        }

        .convert-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(124, 58, 237, 0.3);
        }

        /* Content Grid (History Sections) */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        /* History Cards */
        .history-card {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .history-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .history-card h3 {
            font-size: 16px;
            font-weight: 600;
            color: #6B7280;
            margin-bottom: 15px;
        }

        /* Tabs inside History Cards */
        .tabs {
            display: flex;
            justify-content: center;
            list-style: none;
            gap: 20px;
            margin-bottom: 15px;
            padding: 0;
            position: relative;
        }

        .tab {
            padding: 8px 15px;
            font-weight: 600;
            cursor: pointer;
            color: #6B7280;
            transition: color 0.3s ease;
            position: relative;
        }

        .tab.active {
            color: #7C3AED;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 3px;
            background: #7C3AED;
            border-radius: 2px;
        }

        /* History Table */
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .history-table th, .history-table td {
            padding: 12px;
            text-align: center;
            font-size: 14px;
        }

        .history-table th {
            background-color: #F9FAFB;
            color: #6B7280;
            font-weight: 600;
        }

        .history-table td {
            color: #1F2937;
            border-bottom: 1px solid #F1F3F5;
        }

        /* Effet zébré pour les lignes */
        .history-table tbody tr:nth-child(even) {
            background-color: #F9FAFB;
        }

        .history-table tbody tr:hover {
            background-color: #F1F3F5;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .main-content {
                margin-left: 200px;
                width: calc(100% - 200px);
                padding: 10px;
            }

            .welcome-card {
                padding: 10px 15px;
            }

            .welcome-text h2 {
                font-size: 20px;
            }

            .welcome-text p {
                font-size: 12px;
            }

            .welcome-avatar {
                width: 50px;
                height: 50px;
            }

            .welcome-avatar i {
                font-size: 25px;
            }

            .stats-grid, .content-grid {
                grid-template-columns: 1fr;
            }

            .convert-form {
                flex-direction: column;
                align-items: center;
            }

            .convert-field {
                min-width: 100%;
            }

            .history-table th, .history-table td {
                font-size: 12px;
                padding: 8px;
            }
        }

        .currency-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .currency-tnd {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .currency-eur {
            background-color: rgba(79, 70, 229, 0.2);
            color: #4F46E5;
        }

        .currency-usd {
            background-color: rgba(245, 158, 11, 0.2);
            color: #F59E0B;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-gain {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10B981;
        }

        .badge-perte {
            background-color: rgba(239, 68, 68, 0.2);
            color: #EF4444;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>Connect Sphere</h1>
            </div>
            <ul>
                <li><a href="{{ path('app_points') }}" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href='/points/fortune-wheel'><i class="fas fa-box"></i><span>Fourtune wheel</span></a></li>
                <li><a href="{{ path('app_convert_points') }}"><i class="fas fa-users"></i><span>Conversion </span></a></li>
                <li class="menu-item logout">
                    <a href="{{ path('app_logout') }}">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Welcome Card -->
            <div class="welcome-card">
                <div class="welcome-avatar">
                    <i class="fas fa-tachometer-alt"></i>
                </div>
                <div class="welcome-text">
                    <h2>Welcome to Your Dashboard!</h2>
                    <p>Manage your points and conversions here!</p>
                </div>
            </div>

            <!-- Stats Grid (Points, Money, Conversion Score) -->
            <div class="stats-grid">
                <div class="stat-card points-card">
                    <h3>Total Points</h3>
                    <div class="stat-avatar">
                        <i class="fas fa-star"></i>
                    </div>
                    <p class="stat-value points">{{ user.points|default(0) }}</p>
                </div>
                <div class="stat-card money-card">
                    <h3>Total Money</h3>
                    <div class="stat-avatar">
                        <i class="fas fa-wallet"></i>
                    </div>
                    <p class="stat-value money">{{ user.argent|default('0.00') }}</p>
                </div>
                <div class="conversion-score-card">
                    <h3>Conversion Rate</h3>
                    <div class="score-avatar">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <p class="score-value">100 Points = 5 TND</p>
                </div>
            </div>

            <!-- Convert Card -->
            <div class="convert-card">
                <h3>Convert Points to Money</h3>
                <div class="convert-form">
                    <div class="convert-field">
                        <p class="convert-label">Points to Convert</p>
                        <input type="number" class="convert-spinner" id="numPoints" value="100">
                    </div>
                    <div class="convert-field">
                        <p class="convert-label">Currency</p>
                        <select class="devise-select" id="devise">
                            <option value="TND">TND</option>
                            <option value="EUR">EUR</option>
                            <option value="USD">USD</option>
                        </select>
                    </div>
                    <div class="convert-field">
                        <button class="convert-button" id="convertBtn" type="button">Convert</button>
                    </div>
                    <div id="conversion-status" style="margin-top: 10px; text-align: center; color: #6B7280;"></div>
                </div>
            </div>

            <!-- Content Grid (History Sections) -->
            <div class="content-grid">
                <!-- Points History -->
                <div class="history-card">
                    <h3>Points History</h3>
                    <div id="points-history" class="tab-pane active">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Type</th>
                                    <th>Points</th>
                                    <th>Reason</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if pointsHistory is empty %}
                                    <tr>
                                        <td colspan="4">No points history available</td>
                                    </tr>
                                {% else %}
                                    {% for entry in pointsHistory %}
                                        <tr>
                                            <td>{{ entry.date|date('d/m/Y H:i') }}</td>
                                            <td>
                                                {% if entry.type == 'gain' %}
                                                    <span class="badge badge-gain">Gain</span>
                                                {% else %}
                                                    <span class="badge badge-perte">Loss</span>
                                                {% endif %}
                                            </td>
                                            <td>
                                                {% if entry.type == 'gain' %}
                                                    +{{ entry.points }}
                                                {% else %}
                                                    {{ entry.points }}
                                                {% endif %}
                                            </td>
                                            <td>{{ entry.raison }}</td>
                                        </tr>
                                    {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Conversion History -->
                <div class="history-card">
                    <h3>Conversion History</h3>
                    <div id="conversion-history" class="tab-pane active">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Currency</th>
                                    <th>Points Converted</th>
                                    <th>Amount Received</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if transactions is empty %}
                                    <tr>
                                        <td colspan="4">No conversion history available</td>
                                    </tr>
                                {% else %}
                                    {% for transaction in transactions %}
                                        <tr>
                                            <td>{{ transaction.date|date('d/m/Y H:i') }}</td>
                                            <td>
                                                <span class="currency-badge currency-{{ transaction.devise|lower }}">
                                                    {{ transaction.devise }}
                                                </span>
                                            </td>
                                            <td>{{ transaction.pointConvertis }}</td>
                                            <td>{{ transaction.montant }} {{ transaction.devise }}</td>
                                        </tr>
                                    {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        /**
         * Met à jour l'historique des conversions dans l'interface
         * @param {Object} transaction - La nouvelle transaction à ajouter
         */
        function updateConversionHistory(transaction) {
            console.log('Mise à jour de l\'historique avec:', transaction);
            
            // Chercher la table d'historique des conversions
            const historyTables = [
                document.querySelector('.history-table tbody'),
                document.querySelector('table tbody'),
                document.querySelector('.conversion-history tbody')
            ].filter(table => table !== null);
            
            if (historyTables.length === 0) {
                console.warn('Aucune table d\'historique trouvée dans la page');
                return;
            }
            
            // Pour chaque table d'historique trouvée
            historyTables.forEach(tableBody => {
                // Vérifier s'il y a un message "Aucune conversion"
                const emptyRow = tableBody.querySelector('tr td[colspan]');
                if (emptyRow) {
                    // Supprimer la ligne "Aucune conversion"
                    emptyRow.parentNode.remove();
                }
                
                // Créer une nouvelle ligne
                const newRow = document.createElement('tr');
                
                // Formater la date
                const formattedDate = transaction.date;
                
                // Ajouter les cellules avec les données de la transaction
                newRow.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>
                        <span class="currency-badge currency-${transaction.devise.toLowerCase()}">
                            ${transaction.devise}
                        </span>
                    </td>
                    <td>${transaction.pointConvertis}</td>
                    <td>${parseFloat(transaction.montant).toFixed(2)} ${transaction.devise}</td>
                `;
                
                // Ajouter la nouvelle ligne au début de la table
                if (tableBody.firstChild) {
                    tableBody.insertBefore(newRow, tableBody.firstChild);
                } else {
                    tableBody.appendChild(newRow);
                }
            });
        }
        
        // Fonction de conversion des points directement dans la page
        function directConvertPoints() {
            console.log('Direct conversion function called');

            // Récupérer les valeurs du formulaire
            const pointsInput = document.getElementById('numPoints');
            const deviseSelect = document.getElementById('devise');
            const statusDiv = document.getElementById('conversion-status');

            if (!pointsInput || !deviseSelect) {
                console.error('Form elements not found!');
                alert('Erreur: Impossible de trouver les éléments du formulaire.');
                return;
            }

            const points = pointsInput.value;
            const devise = deviseSelect.value;

            console.log(`Points: ${points}, Devise: ${devise}`);

            // Vérifier que les points sont un nombre valide
            if (isNaN(points) || points <= 0 || points % 100 !== 0) {
                alert('Le nombre de points doit être un multiple positif de 100.');
                return;
            }

            // Afficher un indicateur de chargement
            const convertBtn = document.getElementById('convertBtn');
            const originalText = convertBtn ? convertBtn.textContent : 'Convertir';
            if (convertBtn) {
                convertBtn.textContent = 'Conversion en cours...';
                convertBtn.disabled = true;
            }

            if (statusDiv) {
                statusDiv.textContent = 'Conversion en cours...';
            }

            // Envoyer la requête AJAX
            fetch('/points/convert/process', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: new URLSearchParams({
                    'points': points,
                    'devise': devise
                })
            })
            .then(response => {
                console.log('Response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('Data received:', data);

                if (data.success) {
                    // Mettre à jour l'affichage des points et de l'argent
                    const pointsElement = document.querySelector('.stat-value.points');
                    const moneyElement = document.querySelector('.stat-value.money');
                    const pointsDisplays = document.querySelectorAll('.user-points');

                    // Calculer les nouveaux points (points actuels - points convertis)
                    const newPoints = parseInt(pointsElement?.textContent || 0) - data.points;
                    
                    // Mettre à jour tous les affichages de points
                    if (pointsElement) pointsElement.textContent = newPoints;
                    pointsDisplays.forEach(el => el.textContent = newPoints);
                    
                    // Mettre à jour l'affichage de l'argent si disponible
                    if (moneyElement) {
                        const currentMoney = parseFloat(moneyElement.textContent || 0);
                        moneyElement.textContent = (currentMoney + parseFloat(data.montant)).toFixed(2);
                    }

                    // Ajouter la nouvelle transaction à l'historique sans recharger la page
                    updateConversionHistory({
                        date: new Date().toISOString().split('T')[0], // Format YYYY-MM-DD
                        devise: data.devise,
                        pointConvertis: data.points,
                        montant: data.montant
                    });

                    // Afficher un message de succès
                    alert(data.message);
                } else {
                    // Afficher un message d'erreur
                    alert(data.message || 'Une erreur est survenue lors de la conversion.');
                }

                // Réactiver le bouton
                if (convertBtn) {
                    convertBtn.textContent = originalText;
                    convertBtn.disabled = false;
                }

                if (statusDiv) {
                    statusDiv.textContent = '';
                }
            })
            .catch(error => {
                console.error('Erreur lors de la conversion:', error);
                alert('Une erreur est survenue lors de la conversion. Veuillez réessayer.');

                // Réactiver le bouton
                if (convertBtn) {
                    convertBtn.textContent = originalText;
                    convertBtn.disabled = false;
                }

                if (statusDiv) {
                    statusDiv.textContent = '';
                }
            });
        
            }

            // Envoyer la requête AJAX
            fetch('/points/convert/process', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: new URLSearchParams({
                    'points': points,
                    'devise': devise
                })
            })
            .then(response => {
                console.log('Response received:', response);
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('Data received:', data);

                if (data.success) {
                    // Mettre à jour l'affichage des points et de l'argent
                    const pointsElement = document.querySelector('.stat-value.points');
                    const moneyElement = document.querySelector('.stat-value.money');

                    if (pointsElement) pointsElement.textContent = data.newPoints;
                    if (moneyElement) moneyElement.textContent = data.newArgent;

                    if (statusDiv) {
                        statusDiv.textContent = data.message;
                        statusDiv.style.color = '#10B981';
                    }

                    // Afficher un message de succès
                    alert(data.message);

                    // Recharger la page pour afficher les nouvelles transactions
                    window.location.reload();
                } else {
                    // Afficher un message d'erreur
                    if (statusDiv) {
                        statusDiv.textContent = data.message || 'Une erreur est survenue lors de la conversion.';
                        statusDiv.style.color = '#EF4444';
                    }

                    alert(data.message || 'Une erreur est survenue lors de la conversion.');

                    // Réactiver le bouton
                    if (convertBtn) {
                        convertBtn.textContent = 'Convert';
                        convertBtn.disabled = false;
                    }
                }
            })
            .catch(error => {
                console.error('Erreur lors de la conversion:', error);

                if (statusDiv) {
                    statusDiv.textContent = 'Une erreur est survenue lors de la conversion. Veuillez réessayer.';
                    statusDiv.style.color = '#EF4444';
                }

                alert('Une erreur est survenue lors de la conversion. Veuillez réessayer.');

                // Réactiver le bouton
                if (convertBtn) {
                    convertBtn.textContent = 'Convert';
                    convertBtn.disabled = false;
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('JS chargé ✓');

            // Attacher l'événement au bouton de conversion
            const convertBtn = document.getElementById('convertBtn');
            if (convertBtn) {
                console.log('Convert button found, attaching direct event listener');
                convertBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Convert button clicked');
                    directConvertPoints();
                });
            } else {
                console.error('Convert button not found!');
            }
        });
    </script>
{% endblock %}
</file>

<file path="points/convert.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Conversion de Points{% endblock %}

{% block stylesheets %}
    <!-- Inclure FontAwesome pour les icônes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Base Styles */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: #F5F5FF; /* Fond clair */
            color: #1F2937;
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 207px;
            background: linear-gradient(180deg, #220054 0%, #5B21B6 100%); /* Dégradé violet */
            color: #FFFFFF;
            padding: 20px 8px;
            position: fixed;
            top: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            border-top-right-radius: 12px; /* Border-radius côté droit */
            border-bottom-right-radius: 12px; /* Border-radius côté droit */
        }

        .sidebar .logo {
            margin-bottom: 40px;
        }

        .sidebar .logo h1 {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
        }

        .sidebar ul {
            list-style: none;
            flex-grow: 1;
            padding: 0;
        }

        .sidebar ul li {
            margin: 10px 0;
            position: relative;
        }

        .sidebar ul li a {
            display: flex;
            align-items: center;
            color: #FFFFFF;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            padding: 12px 15px;
            border-radius: 8px;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .sidebar ul li a i {
            margin-right: 10px;
            font-size: 18px;
        }

        .sidebar ul li a:hover,
        .sidebar ul li a.active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.03); /* Léger agrandissement au survol */
        }

        /* Sous-menu pour Dashboard */
        .submenu {
            display: none;
            list-style: none;
            padding: 0;
            margin: 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .submenu li a {
            padding: 10px 30px;
            font-size: 14px;
        }

        .submenu li a:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .submenu.active {
            display: block;
            max-height: 200px; /* Ajuste selon le contenu */
        }

        /* Main Content */
        .main-content {
            margin-left: 220px;
            width: calc(100% - 220px);
            padding: 15px; /* Réduit pour minimiser les espaces */
            background: #F5F5FF;
        }

        /* Welcome Card */
        .welcome-card {
            background: linear-gradient(135deg,rgb(29, 0, 98), #9F7AEA); /* Dégradé violet doux */
            border-radius: 12px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 15px; /* Réduit pour minimiser les espaces */
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .welcome-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .welcome-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: #FFFFFF;
            border-radius: 50%;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .welcome-avatar i {
            font-size: 30px;
            color: #6B46C1;
        }

        .welcome-text h2 {
            font-size: 24px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 5px;
            line-height: 1.2;
        }

        .welcome-text p {
            font-size: 14px;
            color: #EDE9FE;
            font-weight: 400;
        }

        /* Stats Grid (Points, Money, Conversion Score) */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px; /* Réduit pour minimiser les espaces */
        }

        .stat-card, .conversion-score-card {
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-card:hover, .conversion-score-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        /* Nouvelles couleurs élégantes pour chaque carte */
        .stat-card.points-card {
            background: linear-gradient(135deg,rgb(249, 198, 69),rgb(250, 213, 149)); /* Dégradé doré/orange */
        }

        .stat-card.money-card {
            background: linear-gradient(135deg,rgb(115, 209, 249), #0EA5E9); /* Dégradé bleu saphir */
        }

        .conversion-score-card {
            background: linear-gradient(135deg,rgb(205, 165, 244),rgb(183, 112, 249)); /* Dégradé violet améthyste */
        }

        .stat-card .icon, .conversion-score-card .icon {
            font-size: 28px;
            margin-bottom: 10px;
            color: #FFFFFF;
        }

        .stat-card h3, .conversion-score-card h3 {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 5px;
        }

        .stat-card .value, .conversion-score-card .value {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 5px;
        }

        .stat-card .label, .conversion-score-card .label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Content Grid (Conversion Form & History) */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Conversion Form */
        .conversion-card {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .conversion-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .conversion-card h3 {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #F3F4F6;
        }

        .convert-form {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .convert-field {
            flex: 1;
            min-width: 200px;
        }

        .convert-field label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #4B5563;
            margin-bottom: 8px;
        }

        .convert-field input, .convert-field select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            font-size: 16px;
            color: #1F2937;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .convert-field input:focus, .convert-field select:focus {
            border-color: #8B5CF6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
            outline: none;
        }

        .convert-btn {
            background: linear-gradient(135deg, #6B46C1, #9F7AEA);
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }

        .convert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(107, 70, 193, 0.4);
            background: linear-gradient(135deg, #5B21B6, #8B5CF6);
        }

        .conversion-preview {
            margin-top: 15px;
            padding: 12px;
            background: #F3F4F6;
            border-radius: 8px;
            text-align: center;
            display: none;
        }

        .conversion-preview p {
            font-size: 16px;
            font-weight: 600;
            color: #4B5563;
            margin: 0;

        }
        
        /* Styles pour les alertes */
        .alert {
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
        }
        
        .alert-success {
            background-color: #D1FAE5;
            color: #065F46;
            border: 1px solid #A7F3D0;
        }
        
        .alert-danger {
            background-color: #FEE2E2;
            color: #B91C1C;
            border: 1px solid #FECACA;
        }
        
        .alert-info {
            background-color: #E0F2FE;
            color: #0369A1;
            border: 1px solid #BAE6FD;
        }

        /* History Card */
        .history-card {
            background: #FFFFFF;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .history-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .history-card h3 {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #F3F4F6;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th, .history-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #F3F4F6;
        }

        .history-table th {
            font-size: 14px;
            font-weight: 600;
            color: #6B7280;
        }

        .history-table td {
            font-size: 14px;
            color: #1F2937;
        }

        .history-table tr:last-child td {
            border-bottom: none;
        }

        .history-table tr:hover {
            background: #F9FAFB;
        }
        
    /* Style pour les nouvelles conversions */
    .new-conversion {
        animation: highlight 3s ease-in-out;
        background-color: rgba(76, 175, 80, 0.2);
    }
    
    @keyframes highlight {
        0% { background-color: rgba(76, 175, 80, 0.5); }
        100% { background-color: transparent; }
    }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
                padding: 20px 5px;
            }

            .sidebar .logo h1 {
                font-size: 0;
            }

            .sidebar .logo h1::first-letter {
                font-size: 24px;
            }

            .sidebar ul li a span {
                display: none;
            }

            .sidebar ul li a i {
                margin-right: 0;
                font-size: 20px;
            }

            .main-content {
                margin-left: 90px;
                width: calc(100% - 90px);
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                width: 60px;
                padding: 15px 5px;
            }

            .main-content {
                margin-left: 70px;
                width: calc(100% - 70px);
            }

            .welcome-card {
                flex-direction: column;
                text-align: center;
                padding: 15px 10px;
            }

            .welcome-text h2 {
                font-size: 20px;
            }

            .welcome-text p {
                font-size: 12px;
            }

            .welcome-avatar {
                width: 50px;
                height: 50px;
            }

            .welcome-avatar i {
                font-size: 25px;
            }

            .stats-grid, .content-grid {
                grid-template-columns: 1fr;
            }

            .convert-form {
                flex-direction: column;
                align-items: center;
            }

            .convert-field {
                min-width: 100%;
            }

            .history-table th, .history-table td {
                font-size: 12px;
                padding: 8px;
            }
        }
    </style>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Éléments du DOM
        const form = document.getElementById('dynamic-convert-form');
        const pointsInput = document.getElementById('numPoints');
        const deviseSelect = document.getElementById('devise');
        const conversionPreview = document.getElementById('conversion-preview');
        const previewText = document.getElementById('preview-text');
        const conversionStatus = document.getElementById('conversion-status');
        
        // Prévisualisation de la conversion
        pointsInput.addEventListener('input', updatePreview);
        deviseSelect.addEventListener('change', updatePreview);
        
        // Mise à jour de la prévisualisation
        function updatePreview() {
            const points = parseInt(pointsInput.value) || 0;
            const devise = deviseSelect.value;
            
            if (points <= 0) {
                conversionPreview.style.display = 'none';
                return;
            }
            
            // Calculer le montant en TND (1 point = 0.325 TND)
            const montantTND = points * 0.325;
            
            // Convertir en devise demandée
            let montant;
            switch (devise) {
                case 'EUR':
                    montant = (montantTND * 0.29).toFixed(2); // 1 TND = 0.29 EUR
                    break;
                case 'USD':
                    montant = (montantTND * 0.32).toFixed(2); // 1 TND = 0.32 USD
                    break;
                default:
                    montant = montantTND.toFixed(2);
            }
            
            // Formater le montant avec séparateur de milliers
            const montantFormate = Number(montant).toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            
            // Afficher la prévisualisation
            previewText.textContent = `${points.toLocaleString('fr-FR')} points = ${montantFormate} ${devise}`;
            conversionPreview.style.display = 'block';
        }
        
        // Gestion de la soumission du formulaire
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Récupérer les données du formulaire
            const points = parseInt(pointsInput.value) || 0;
            const devise = deviseSelect.value;
            
            // Valider les données
            if (points < 100) {
                conversionStatus.innerHTML = '<div class="alert alert-danger">Vous devez convertir au moins 100 points.</div>';
                return;
            }
            
            // Vérifier si l'utilisateur a suffisamment de points
            const pointsDisponibles = parseInt(document.querySelector('.points-card .value').textContent.replace(/[^0-9]/g, '')) || 0;
            if (points > pointsDisponibles) {
                conversionStatus.innerHTML = '<div class="alert alert-danger">Vous n\'avez pas suffisamment de points pour cette conversion.</div>';
                return;
            }
            
            // Créer les données à envoyer
            const formData = new FormData();
            formData.append('points', points);
            formData.append('devise', devise);
            
            // Afficher un message de chargement
            conversionStatus.innerHTML = '<div class="alert alert-info">Traitement en cours...</div>';
            
            // Envoyer la requête AJAX
            fetch('{{ path("app_dynamic_convert_points") }}', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Afficher le message de succès avec les détails de la conversion
                    const montantFormate = Number(data.data.montant).toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                    const pointsFormates = parseInt(data.data.points_convertis).toLocaleString('fr-FR');
                    conversionStatus.innerHTML = `<div class="alert alert-success">
                        ${data.message}<br>
                        Vous avez converti ${pointsFormates} points en ${montantFormate} ${data.data.devise}.
                    </div>`;
                    
                    // Mettre à jour la session avec les nouvelles valeurs
                    fetch('/update-session', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            points: data.data.newPoints || data.data.new_points
                        })
                    }).catch(error => console.error('Erreur de mise à jour de session:', error));











                    // Mettre à jour les points affichés
                    const pointsElement = document.querySelector('.points-card .value');
                    if (pointsElement) {
                        // Utiliser newPoints ou new_points selon ce qui est disponible
                        const newPoints = parseFloat(data.data.newPoints || data.data.new_points || 0);
                        if (!isNaN(newPoints)) {
                            pointsElement.textContent = newPoints.toLocaleString('fr-FR', {minimumFractionDigits: 0, maximumFractionDigits: 0});
 
                            // Mettre à jour la valeur estimée
                            const moneyElement = document.querySelector('.money-card .value');
                            if (moneyElement) {
                                // Calculer la nouvelle valeur estimée (1 point = 0.325 TND)
                                const newEstimated = (newPoints * 0.325).toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                               
                               
                               
                               moneyElement.textContent = ${newEstimated} TND;


                                moneyElement.setAttribute('data-estimated', newEstimated); // for debug
                            }



                            
                        }
                    }
                    

                    // Mettre à jour la variable user.points côté Twig si besoin (pour un affichage correct après reload)
                    // (Pas possible en JS pur, mais l'affichage JS est déjà mis à jour ci-dessus)

                    // Réinitialiser le formulaire
                    form.reset();
                    updatePreview();

                    // Mettre à jour l'historique sans recharger la page
                    let historyTable = document.querySelector('.history-table tbody');
                    if (historyTable) {
                        // Formater la date au format français (JJ/MM/AAAA)
                        const now = new Date();
                        const day = String(now.getDate()).padStart(2, '0');
                        const month = String(now.getMonth() + 1).padStart(2, '0');
                        const year = now.getFullYear();
                        const dateStr = `${day}/${month}/${year}`;

                        // Récupérer les données de la conversion
                        const devise = data.data.devise || '';
                        const pointsConvertis = data.data.points_convertis || data.data.pointsConvertis || 0;
                        const montant = data.data.montant || 0;

                        // Créer la nouvelle ligne
                        const newRow = document.createElement('tr');
                        newRow.className = 'new-conversion';
                        newRow.innerHTML = `
                            <td>${dateStr}</td>
                            <td>${devise}</td>
                            <td>${parseInt(pointsConvertis).toLocaleString('fr-FR')}</td>
                            <td>${Number(montant).toLocaleString('fr-FR', {minimumFractionDigits: 2, maximumFractionDigits: 2})} ${devise}</td>
                        `;

                        // Supprimer le message "Aucune conversion effectuée" s'il existe
                        const emptyRow = historyTable.querySelector('tr td[colspan="4"]');
                        if (emptyRow) {
                            emptyRow.parentNode.remove();
                        }
                        // Ajouter la nouvelle ligne en haut du tableau
                        historyTable.insertBefore(newRow, historyTable.firstChild);
                        // Animation
                        setTimeout(() => {
                            newRow.classList.remove('new-conversion');
                        }, 3000);
                    } else {
                        console.error('Tableau d\'historique non trouvé');
                    }
                } else {
                    // Afficher le message d'erreur
                    conversionStatus.innerHTML = `<div class="alert alert-danger">${data.message}</div>`;

                }
            })
            .catch(error => {
                console.error('Erreur:', error);
                conversionStatus.innerHTML = '<div class="alert alert-danger">Une erreur est survenue lors de la conversion. Veuillez réessayer.</div>';
                // Réinitialiser l'interface après une erreur
                setTimeout(() => {
                    conversionStatus.innerHTML = '';
                }, 5000); // Effacer le message d'erreur après 5 secondes
            });
            
            // Effacer les messages de succès après un certain temps
            setTimeout(() => {
                if (conversionStatus.querySelector('.alert-success')) {
                    conversionStatus.innerHTML = '';
                }
            }, 5000);
        });
        
        // Initialiser la prévisualisation
        updatePreview();
     
</script>
{% endblock %}

{% block body %}
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>Connect Sphere</h1>
            </div>
            <ul><ul><li><a href="{{ path('app_home') }}" class="active"><i class="fas fa-home"></i> Home</a></li>
                                              <li><a href="{{ path('app_points') }}" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                                                 <li><a href='/points/fortune-wheel'><i class="fas fa-box"></i><span>Fourtune wheel</span></a></li>
                                             <li><a href="{{ path('app_convert_points') }}"><i class="fas fa-users"></i><span>Conversion </span></a></li>
                                               <li class="menu-item logout">

                                                            <li class="menu-item logout">
                                                                <a href="{{ path('app_logout') }}">
                                                                    <i class="fas fa-sign-out-alt"></i>
                                                                    <span>Logout</span>
                                                                </a>
                                                            </li>


                           </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Welcome Card -->
            <div class="welcome-card">
                <div class="welcome-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="welcome-text">
                    <h2>Bienvenue, {{ user.username}} </h2>
                    <p>Convertissez vos points en argent réel facilement et rapidement.</p>
                </div>
            </div>

         <div class="stats-grid">
    <div class="stat-card points-card">
        <div class="icon"><i class="fas fa-star"></i></div>
        <h3>Vos Points</h3>
        <div class="value">
            {{ user.points|number_format(0, ',', ' ')|default('Aucun point') }}
        </div>
        <div class="label">Points disponibles</div>
    </div>
    <div class="stat-card money-card">
        <div class="icon"><i class="fas fa-money-bill-wave"></i></div>
        <h3>Valeur Estimée</h3>
        <div class="value">{{ (user.points * 0.325)|number_format(2, ',', ' ') }} TND</div>
        <div class="label">1 point = 0.325 TND</div>
    </div>
    <div class="conversion-score-card">
        <div class="icon"><i class="fas fa-exchange-alt"></i></div>
        <h3>Taux de Conversion</h3>
        <div class="value">100%</div>
        <div class="label">Conversion sans frais</div>
    </div>
</div>

            <!-- Content Grid -->
            <div class="content-grid">
                <!-- Conversion Form Card -->
                <div class="conversion-card">
                    <h3>Convertir vos Points</h3>
                    <form id="dynamic-convert-form" class="convert-form" action="{{ path('app_dynamic_convert_points') }}" method="post">
                        <div class="convert-field">
                            <label for="numPoints">Nombre de Points</label>
                            <input type="number" id="numPoints" name="points" min="100" step="100" placeholder="Minimum 100 points" required>
                        </div>
                        <div class="convert-field">
                            <label for="devise">Devise Souhaitée</label>
                            <select id="devise" name="devise" required>
                                <option value="TND">Dinar Tunisien (TND)</option>
                                <option value="EUR">Euro (EUR)</option>
                                <option value="USD">Dollar US (USD)</option>
                            </select>
                        </div>
                        <div class="convert-field">
                            <button type="submit" id="convertBtn" class="convert-btn">Convertir Maintenant</button>
                        </div>
                    </form>
                    <div id="conversion-preview" class="conversion-preview">
                        <p id="preview-text">100 points = 32.50 TND</p>
                    </div>
                    <div id="conversion-status"></div>
                </div>

                <!-- History Card -->
                <div class="history-card">
                    <h3>Historique des Conversions</h3>
                    <div class="history-table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Devise</th>
                                    <th>Points Convertis</th>
                                    <th>Montant</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for conversion in conversions %}
                               <tr>
        <td>{{ conversion.date|date('d/m/Y') }}</td>
        <td>{{ conversion.devise }}</td>
       <td>{{ conversion.pointConvertis|number_format(0, ',', ' ') }}</td> <!-- Formatage des points avec séparateur de milliers -->
        <td>{{ conversion.montant|number_format(2, ',', ' ') }} {{ conversion.devise }}</td>
    </tr>
                                {% else %}
                                <tr>
                                    <td colspan="4" style="text-align: center;">Aucune conversion effectuée</td>
                                </tr>
                                {% endfor %}
                                <!-- Exemples de conversions (à supprimer en production) -->
                                {#
                                <tr>
                                    <td>2025-03-15</td>
                                    <td>EUR</td>
                                    <td>200</td>
                                    <td>9.80 €</td>
                                </tr>
                                <tr>
                                    <td>2025-02-25</td>
                                    <td>USD</td>
                                    <td>300</td>
                                    <td>15.00 $</td>
                                </tr>
                                <tr>
                                    <td>2025-01-10</td>
                                    <td>TND</td>
                                    <td>150</td>
                                    <td>48.75 TND</td>
                                </tr>
                                <tr>
                                    <td>2024-12-05</td>
                                    <td>EUR</td>
                                    <td>50</td>
                                    <td>2.45 €</td>
                                </tr>
                                #}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endblock %}
</file>

<file path="points/fortune_wheel.html.twig">
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fortune Wheel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Base Styles */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(145deg, #0A001F 0%, #1C0033 100%);
            color: #FFFFFF;
            overflow-x: hidden;
        }

        /* Animations */
        @keyframes holographic-glow {
            0% { box-shadow: 0 0 10px #00FFFF, 0 0 20px #FF00FF; }
            50% { box-shadow: 0 0 20px #00FFFF, 0 0 40px #FF00FF; }
            100% { box-shadow: 0 0 10px #00FFFF, 0 0 20px #FF00FF; }
        }

        @keyframes neon-pulse {
            0% { text-shadow: 0 0 5px #00FFFF, 0 0 10px #FF00FF; }
            50% { text-shadow: 0 0 15px #00FFFF, 0 0 30px #FF00FF; }
            100% { text-shadow: 0 0 5px #00FFFF, 0 0 10px #FF00FF; }
        }

        @keyframes sparkle {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        @keyframes spin-glow {
            0% { box-shadow: 0 0 15px #00FFFF, 0 0 30px #FF00FF; }
            50% { box-shadow: 0 0 30px #00FFFF, 0 0 60px #FF00FF; }
            100% { box-shadow: 0 0 15px #00FFFF, 0 0 30px #FF00FF; }
        }

        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 220px;
            background: linear-gradient(180deg, #0A001F 0%, #4B0082 100%);
            color: #FFFFFF;
            padding: 20px 8px;
            position: fixed;
            top: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 20px rgba(0, 255, 255, 0.2);
            border-top-right-radius: 16px;
            border-bottom-right-radius: 16px;
        }

        .sidebar .logo {
            margin-bottom: 40px;
        }

        .sidebar .logo h1 {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            text-shadow: 0 0 15px #00FFFF;
            animation: neon-pulse 1.5s infinite ease-in-out;
        }

        .sidebar ul {
            list-style: none;
            flex-grow: 1;
            padding: 0;
        }

        .sidebar ul li {
            margin: 10px 0;
            position: relative;
        }

        .sidebar ul li a {
            display: flex;
            align-items: center;
            color: #FFFFFF;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            padding: 12px 15px;
            border-radius: 8px;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        }

        .sidebar ul li a i {
            margin-right: 10px;
            font-size: 18px;
        }

        .sidebar ul li a:hover,
        .sidebar ul li a.active {
            background: rgba(0, 255, 255, 0.2);
            transform: scale(1.03);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        /* Main Content */
        .main-content {
            margin-left: 220px;
            width: calc(100% - 220px);
            padding: 20px;
            background: #0A001F;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Welcome Card */
        .welcome-card {
            background: linear-gradient(135deg, #0A001F 0%, #4B0082 100%);
            border-radius: 16px;
            padding: 20px 30px;
            display: flex;
            align-items: center;
            gap: 30px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
            width: 100%;
            max-width: 1200px;
        }

        .welcome-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.5);
        }

        .welcome-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 70px;
            height: 70px;
            background: rgba(0, 255, 255, 0.2);
            border-radius: 50%;
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.5);
        }

        .welcome-avatar i {
            font-size: 35px;
            color: #00FFFF;
            animation: neon-pulse 1.5s infinite ease-in-out;
        }

        .welcome-text {
            flex-grow: 1;
        }

        .welcome-text h2 {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 5px;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        .welcome-text p {
            font-size: 16px;
            color: #D1D5DB;
        }

        .score-container {
            display: none;
            background: rgba(0, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .score-container.show {
            display: block;
        }

        .score-container span {
            font-size: 20px;
            font-weight: 600;
            color: #00FFFF;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .score-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #00FFFF, #39FF14);
            color: #FFFFFF;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .score-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.8);
            animation: holographic-glow 1.5s infinite;
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            width: 90%;
            max-width: 1200px;
            grid-template-areas:
                "wheel wheel rewards"
                "wheel wheel history";
        }

        .wheel-section { grid-area: wheel; }
        .rewards-card { grid-area: rewards; }
        .history-card { grid-area: history; }

        /* Card Styles (Holographic Glassmorphism) */
        .wheel-section,
        .rewards-card,
        .history-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
            border: 1px solid rgba(0, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .wheel-section:hover,
        .rewards-card:hover,
        .history-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.5);
            animation: holographic-glow 1.5s infinite;
        }

        /* Neon Borders for Cards */
        .wheel-section { border-left: 4px solid #00FFFF; }
        .rewards-card { border-left: 4px solid #FF00FF; }
        .history-card { border-left: 4px solid #39FF14; }

        /* Wheel Section */
        .wheel-section {
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .wheel-title {
            font-size: 28px;
            font-weight: 700;
            color: #FFFFFF;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }

        .wheel-avatar {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.5);
        }

        .wheel-avatar i {
            font-size: 25px;
            color: #00FFFF;
            animation: neon-pulse 1.5s infinite ease-in-out;
        }

        .wheel-container {
            position: relative;
            width: 450px;
            height: 490px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .triangle-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-bottom: 30px solid #00FFFF;
            z-index: 10;
            box-shadow: 0 0 15px #00FFFF;
        }

        canvas {
            border-radius: 50%;
            background-color: #0A001F;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        canvas.spinning {
            animation: spin-glow 1s infinite ease-in-out;
        }

        .spin-btn {
            margin-top: 30px;
            padding: 12px 40px;
            background: linear-gradient(135deg, #00FFFF, #FF00FF);
            color: #FFFFFF;
            border: none;
            border-radius: 10px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.5);
            transition: transform 0.2s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .spin-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.8);
            animation: holographic-glow 1.5s infinite;
        }

        .spin-btn:disabled {
            background: #6B7280;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Rewards Card */
        .rewards-card {
            text-align: center;
        }

        .rewards-card h3 {
            font-size: 22px;
            font-weight: 700;
            color: #FF00FF;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
        }

        .rewards-card ul {
            list-style: none;
            padding: 0;
        }

        .rewards-card li {
            font-size: 16px;
            color: #D1D5DB;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 8px;
            background: rgba(255, 0, 255, 0.1);
            border-radius: 8px;
            transition: transform 0.2s ease;
        }

        .rewards-card li:hover {
            transform: scale(1.02);
            background: rgba(255, 0, 255, 0.2);
        }

        .rewards-card i {
            font-size: 18px;
            color: #FF00FF;
            animation: sparkle 1.5s infinite ease-in-out;
        }

        /* History Card */
        .history-card {
            position: relative;
        }

        .history-card h3 {
            font-size: 22px;
            font-weight: 700;
            color: #39FF14;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 0 0 10px rgba(57, 255, 20, 0.5);
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table th, .history-table td {
            padding: 10px;
            text-align: center;
            font-size: 16px;
            color: #D1D5DB;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(57, 255, 20, 0.05);
        }

        .history-table th {
            font-weight: 600;
            color: #39FF14;
            background: rgba(57, 255, 20, 0.2);
        }

        .history-table tbody tr:last-child td {
            border-bottom: none;
        }

        .history-table tbody tr:hover {
            background: rgba(57, 255, 20, 0.1);
            transform: scale(1.01);
            transition: all 0.2s ease;
        }

        /* Particle Effect for Winning */
        .particle-container {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        .particle {
            position: absolute;
            background: #00FFFF;
            border-radius: 50%;
            box-shadow: 0 0 10px #00FFFF;
            animation: particle-burst 1s ease-out forwards;
        }

        @keyframes particle-burst {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .main-content {
                margin-left: 200px;
                width: calc(100% - 200px);
                padding: 10px;
            }

            .welcome-card {
                padding: 15px 20px;
                flex-direction: column;
                align-items: flex-start;
            }

            .welcome-text h2 {
                font-size: 24px;
            }

            .welcome-text p {
                font-size: 14px;
            }

            .welcome-avatar {
                width: 60px;
                height: 60px;
            }

            .welcome-avatar i {
                font-size: 30px;
            }

            .content-grid {
                grid-template-areas:
                    "wheel wheel wheel"
                    "rewards rewards rewards"
                    "history history history";
            }

            .wheel-container {
                width: 350px;
                height: 390px;
            }

            canvas {
                width: 350px !important;
                height: 350px !important;
            }

            .wheel-title,
            .rewards-card h3,
            .history-card h3 {
                font-size: 20px;
            }

            .spin-btn {
                font-size: 16px;
                padding: 10px 30px;
            }
        }

        @media (max-width: 500px) {
            .sidebar {
                width: 60px;
                padding: 20px 5px;
            }

            .sidebar .logo h1 {
                font-size: 18px;
            }

            .sidebar ul li a {
                justify-content: center;
                padding: 10px;
            }

            .sidebar ul li a span {
                display: none;
            }

            .sidebar ul li a i {
                margin-right: 0;
                font-size: 20px;
            }

            .main-content {
                margin-left: 60px;
                width: calc(100% - 60px);
            }

            .wheel-container {
                width: 280px;
                height: 320px;
            }

            canvas {
                width: 280px !important;
                height: 280px !important;
            }

            .welcome-text h2 {
                font-size: 20px;
            }

            .welcome-text p {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>Connect Sphere</h1>
            </div>
              <ul><ul><li><a href="{{ path('app_home') }}" class="active"><i class="fas fa-home"></i> Home</a></li>
                                                <li><a href="{{ path('app_points') }}" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                                                   <li><a href='/points/fortune-wheel'><i class="fas fa-box"></i><span>Fourtune wheel</span></a></li>
                                               <li><a href="{{ path('app_convert_points') }}"><i class="fas fa-users"></i><span>Conversion </span></a></li>
                                                 <li class="menu-item logout">

                                                              <li class="menu-item logout">
                                                                  <a href="{{ path('app_logout') }}">
                                                                      <i class="fas fa-sign-out-alt"></i>
                                                                      <span>Logout</span>
                                                                  </a>
                                                              </li>


                             </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Welcome Card -->
            <div class="welcome-card">
                <div class="welcome-avatar">
                    <i class="fas fa-trophy"></i>
                </div>
                <div class="welcome-text">
                    <h2>Spin the Holo-Wheel!</h2>
                    <p>Unlock cosmic rewards and boost your points!</p>
                    <div class="score-container" id="scoreContainer">
                        <span id="userScore">Current Points:{{ (user.points ?? 0)|number_format(0, '.', ' ') }}
</span>
                    </div>
                    <button class="score-btn" id="scoreBtn"><i class="fas fa-star"></i> Show Score</button>
                </div>
            </div>

            <!-- Content Grid -->
            <div class="content-grid">
                <!-- Wheel Section -->
                <div class="wheel-section">
                    <h2 class="wheel-title">
                        <div class="wheel-avatar">
                            <i class="fas fa-gift"></i>
                        </div>
                        Fortune Wheel
                    </h2>

                    <div class="wheel-container">
                        <div class="triangle-pointer"></div>
                        <canvas id="wheel" width="450" height="450"></canvas>
                        <button class="spin-btn" id="spinBtn"><i class="fas fa-sync-alt"></i> Spin</button>
                        <div class="particle-container" id="particleContainer"></div>
                    </div>
                </div>

                <!-- Rewards Card -->
                <div class="rewards-card">
                    <h3>
                        <i class="fas fa-award"></i>
                        Possible Rewards
                    </h3>
                    <ul>
                        <li><i class="fas fa-coins"></i> 0 Points</li>
                        <li><i class="fas fa-trophy"></i> 100 Points</li>
                        <li><i class="fas fa-gift"></i> 50 Points</li>
                        <li><i class="fas fa-star"></i> 40 Points</li>
                        <li><i class="fas fa-crown"></i> Bonus: 200 Points</li>
                    </ul>
                </div>

                <!-- History Card -->
                <div class="history-card">
                    <h3>
                        <i class="fas fa-history"></i>
                        Reward History
                    </h3>
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Reward</th>
                            </tr>
                        </thead>
                        <tbody id="historyBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Segment Definitions with Font Awesome Icons (matching Possible Rewards)
        const segments = [
            { label: '0 Points', color: 'linear-gradient(135deg, #FF00FF, #FF69B4)', icon: '\uf51e' }, // fa-coins
            { label: '100 Points', color: 'linear-gradient(135deg, #00FFFF, #00CED1)', icon: '\uf091' }, // fa-trophy
            { label: '50 Points', color: 'linear-gradient(135deg, #FF4500, #FF6347)', icon: '\uf06b' }, // fa-gift
            { label: '40 Points', color: 'linear-gradient(135deg, #39FF14, #ADFF2F)', icon: '\uf005' }, // fa-star
            { label: 'Bonus: 200 Points', color: 'linear-gradient(135deg, #FFD700, #FFECB3)', icon: '\uf521' } // fa-crown
        ];

        // Canvas Initialization
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const historyBody = document.getElementById('historyBody');
        const particleContainer = document.getElementById('particleContainer');
        const scoreBtn = document.getElementById('scoreBtn');
        const scoreContainer = document.getElementById('scoreContainer');
        const userScoreElement = document.getElementById('userScore');
        let currentAngle = 0;
        let spinning = false;
        let scoreVisible = false;
        let userScore = {{ user.points ?? 0 }}; // Initialisation avec les points de l'utilisateur depuis le serveur

        // History (localStorage)
        let spinHistory = JSON.parse(localStorage.getItem('spinHistory') || '[]');
        updateHistory();

        // Score Toggle
        scoreBtn.addEventListener('click', () => {
            scoreVisible = !scoreVisible;
            scoreContainer.classList.toggle('show', scoreVisible);
            scoreBtn.innerHTML = scoreVisible ?
                '<i class="fas fa-eye-slash"></i> Hide Score' :
                '<i class="fas fa-star"></i> Show Score';
        });
        
        // Mettre à jour l'affichage du score
        function updateScoreDisplay() {
            // Formater les points de manière cohérente (comme le filtre Twig format_points)
            const formattedScore = new Intl.NumberFormat('fr-FR').format(userScore);
            userScoreElement.textContent = `Current Points: ${formattedScore}`;
            
            // Synchroniser avec localStorage pour les autres pages
            localStorage.setItem('userPoints', userScore.toString());
            console.log('Points mis à jour dans localStorage:', userScore);
        }
        
        // Vérifier si des points ont été mis à jour dans une autre page
        function checkStoredPoints() {
            const storedPoints = localStorage.getItem('userPoints');
            if (storedPoints) {
                const parsedPoints = parseInt(storedPoints, 10) || 0;
                // Ne mettre à jour que si les points stockés sont différents des points actuels
                if (parsedPoints !== userScore) {
                    userScore = parsedPoints;
                    updateScoreDisplay();
                    console.log('Points synchronisés depuis localStorage:', userScore);
                }
            }
        }
        
        // Initialiser l'affichage du score avec les points réels de l'utilisateur
        updateScoreDisplay();
        
        // Vérifier périodiquement les mises à jour des points (toutes les 5 secondes)
        setInterval(checkStoredPoints, 5000);

        // Ensure Font Awesome is loaded before drawing
        function loadFontAndDraw() {
            if (document.fonts) {
                document.fonts.load('900 24px "Font Awesome 5 Free"').then(() => {
                    drawWheel();
                }).catch(err => {
                    console.error('Font loading failed:', err);
                    drawWheel(); // Fallback: Draw wheel without icons if font fails
                });
            } else {
                setTimeout(drawWheel, 500); // Fallback for browsers without document.fonts
            }
        }

        function drawWheel(angleOffset = 0) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const cx = canvas.width / 2, cy = canvas.height / 2, r = canvas.width / 2 - 15;
            const segAngle = 2 * Math.PI / segments.length;

            // Draw Segments
            for (let i = 0; i < segments.length; i++) {
                const start = i * segAngle + angleOffset;
                const end = start + segAngle;

                // Create Gradient for Segment
                const gradient = ctx.createLinearGradient(cx + r * Math.cos(start), cy + r * Math.sin(start), cx + r * Math.cos(end), cy + r * Math.sin(end));
                const colors = segments[i].color.match(/#[\w\d]+/g);
                if (colors) {
                    gradient.addColorStop(0, colors[0]);
                    gradient.addColorStop(1, colors[1]);
                }

                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.arc(cx, cy, r, start, end);
                ctx.closePath();
                ctx.fillStyle = gradient || segments[i].color;
                ctx.fill();
                ctx.strokeStyle = "#FFFFFF";
                ctx.lineWidth = 4;
                ctx.stroke();

                // Holographic Glow on Segments
                ctx.save();
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.arc(cx, cy, r, start, end);
                ctx.closePath();
                ctx.shadowColor = segments[i].color.includes('gradient') ? colors[0] : segments[i].color;
                ctx.shadowBlur = 15;
                ctx.strokeStyle = ctx.shadowColor;
                ctx.stroke();
                ctx.restore();

                // Label and Icon
                ctx.save();
                ctx.translate(cx, cy);
                ctx.rotate(start + segAngle / 2);
                ctx.textAlign = "right";
                ctx.font = "bold 18px Poppins, Arial";
                ctx.fillStyle = "#FFFFFF";
                ctx.textShadow = "0 0 5px #000";
                ctx.fillText(segments[i].label, r - 40, 5);
                ctx.font = "900 24px 'Font Awesome 5 Free'";
                ctx.fillStyle = "#FFFFFF";
                ctx.fillText(segments[i].icon, r - 15, 5);
                ctx.restore();
            }

            // Outer Holographic Ring
            const outerGradient = ctx.createLinearGradient(cx - r, cy - r, cx + r, cy + r);
            outerGradient.addColorStop(0, '#00FFFF');
            outerGradient.addColorStop(1, '#FF00FF');
            ctx.beginPath();
            ctx.arc(cx, cy, r + 10, 0, 2 * Math.PI);
            ctx.strokeStyle = outerGradient;
            ctx.lineWidth = 6;
            ctx.shadowColor = "#00FFFF";
            ctx.shadowBlur = 20;
            ctx.stroke();

            // Central Holographic Core
            const centerGradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, 35);
            centerGradient.addColorStop(0, '#00FFFF');
            centerGradient.addColorStop(1, '#FF00FF');
            ctx.beginPath();
            ctx.arc(cx, cy, 35, 0, 2 * Math.PI);
            ctx.fillStyle = centerGradient;
            ctx.fill();
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 4;
            ctx.stroke();
        }

        function createParticles() {
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 100 + 50;
                particle.style.width = `${Math.random() * 5 + 5}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${canvas.width / 2}px`;
                particle.style.top = `${canvas.height / 2}px`;
                particle.style.transform = `translate(-50%, -50%)`;
                particle.style.animationDelay = `${Math.random() * 0.5}s`;
                particle.style.setProperty('--x', `${Math.cos(angle) * distance}px`);
                particle.style.setProperty('--y', `${Math.sin(angle) * distance}px`);
                particleContainer.appendChild(particle);

                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        function spinWheel() {
            if (spinning) return;
            spinning = true;
            spinBtn.disabled = true;
            canvas.classList.add('spinning');

            // Animation
            const totalSpin = 360 * 7 + Math.random() * 360;
            const startAngle = currentAngle;
            const endAngle = startAngle + totalSpin;
            const duration = 6000;
            const startTime = performance.now();

            function animate(now) {
                const elapsed = now - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const ease = 1 - Math.pow(2, -10 * progress);
                currentAngle = startAngle + (endAngle - startAngle) * ease;
                drawWheel((currentAngle * Math.PI / 180) % (2 * Math.PI));
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    spinning = false;
                    spinBtn.disabled = false;
                    canvas.classList.remove('spinning');
                    showResult();
                }
            }
            requestAnimationFrame(animate);
        }

       function showResult() {
               const angle = (360 - (currentAngle % 360)) % 360;
               const segAngle = 360 / segments.length;
               const idx = Math.floor(angle / segAngle) % segments.length;
               const reward = segments[idx].label;

               console.log('Segment sélectionné:', idx, 'Reward:', reward);
               
               // Préparer les données à envoyer
               const requestData = JSON.stringify({ segmentIndex: idx });
               console.log('Données envoyées:', requestData);
               
               // Utiliser l'URL absolue pour éviter les problèmes de routage
               const url = '{{ absolute_url(path('app_fortune_wheel')) }}';
               console.log('URL utilisée:', url);
               
               fetch(url, {
                   method: 'POST',
                   headers: {
                       'Content-Type': 'application/json',
                       'Accept': 'application/json',
                       'X-Requested-With': 'XMLHttpRequest'
                   },
                   body: requestData,
                   credentials: 'same-origin'
               })
               .then(response => {
                   console.log('Statut de la réponse:', response.status);
                   console.log('Headers de la réponse:', [...response.headers.entries()]);
                   
                   // Vérifier le type de contenu
                   const contentType = response.headers.get('content-type');
                   console.log('Type de contenu:', contentType);
                   
                   // Même en cas d'erreur 500, on essaie de récupérer la réponse JSON
                   // car notre contrôleur renvoie maintenant des erreurs formatées en JSON
                   return response.text().then(text => {
                       if (!text || text.trim() === '') {
                           throw new Error('Réponse vide du serveur');
                       }
                       
                       try {
                           // Essayer de parser le texte comme JSON
                           const data = JSON.parse(text);
                           console.log('Données parsées avec succès:', data);
                           
                           // Si le serveur a renvoyé une erreur formatée en JSON
                           if (!data.success && data.error) {
                               throw new Error(data.message || 'Erreur lors du traitement de la requête');
                           }
                           
                           return data;
                       } catch (e) {
                           console.error('Erreur lors du parsing JSON:', e);
                           console.error('Contenu de la réponse:', text);
                           
                           // Si la réponse contient du HTML, c'est probablement une page d'erreur
                           if (text.includes('<!DOCTYPE html>')) {
                               throw new Error('Le serveur a renvoyé une page HTML au lieu de JSON. Veuillez réessayer.');
                           }
                           
                           throw e; // Propager l'erreur originale
                       }
                   });
               })
               .then(data => {
                   console.log('Réponse du serveur:', data);
                   if (data.success) {
                       userScore = data.totalPoints;
                       updateScoreDisplay(); // Utiliser la fonction pour mettre à jour l'affichage
                       
                       // Stocker les points mis à jour dans localStorage pour la synchronisation entre pages
                       localStorage.setItem('userPoints', userScore);
                       console.log('Points mis à jour dans localStorage:', userScore);
                       
                       createParticles();
                       alert(`✨ Félicitations! Vous avez gagné: ${data.reward} (${data.pointsWon} points)`);
                       const date = new Date().toLocaleDateString();
                       spinHistory.unshift({ date, reward: data.reward });
                       if (spinHistory.length > 10) spinHistory.pop();
                       localStorage.setItem('spinHistory', JSON.stringify(spinHistory));
                       updateHistory();
                   } else {
                       alert('Erreur lors de l\'enregistrement des points : ' + data.message);
                   }
               })
               .catch(error => {
                   console.error('Erreur lors de la requête AJAX:', error);
                   alert('Une erreur est survenue lors de la sauvegarde des points : ' + error.message);
                   // Réactiver le bouton pour permettre à l'utilisateur de réessayer
                   spinning = false;
                   spinBtn.disabled = false;
               });
           }

        function updateHistory() {
            historyBody.innerHTML = '';
            spinHistory.forEach(entry => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${entry.date}</td><td>${entry.reward}</td>`;
                historyBody.appendChild(tr);
            });
        }

        spinBtn.addEventListener('click', spinWheel);

        // Appeler la fonction d'initialisation au chargement
        loadFontAndDraw();
    </script>
</body>
</html>
</file>

<file path="points/index.html.twig">
{% block stylesheets %}
        <!-- Inclure FontAwesome pour les icônes -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">

        <style>
            /* Base Styles */
            .dashboard-container {
                display: flex;
                min-height: 100vh;
                background: #F5F5FF;
                font-family: 'Poppins', sans-serif;
            }

            /* Sidebar */
            .sidebar {
                border-radius: 12px;
                width: 220px;
                background: linear-gradient(180deg, rgb(34, 0, 84) 0%, #5b21b6 100%);
                color: #FFFFFF;
                padding: 20px 8px;
                position: fixed;
                top: 7px;
                bottom: 5px;
                display: flex;
                flex-direction: column;
                box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            }

            .sidebar .logo {
                margin-bottom: 40px;
            }

            .sidebar .logo h1 {
                font-size: 24px;
                font-weight: 700;
                text-align: center;
            }

            .sidebar ul {
                list-style: none;
                flex-grow: 1;
            }

            .sidebar ul li {
                margin: 10px 0;
            }

            .sidebar ul li a {
                display: flex;
                align-items: center;
                color: #FFFFFF;
                text-decoration: none;
                font-size: 16px;
                font-weight: 500;
                padding: 12px 15px;
                border-radius: 8px;
                transition: background 0.3s ease;
            }

            .sidebar ul li a i {
                margin-right: 10px;
            }

            .sidebar ul li a:hover,
            .sidebar ul li a.active {
                background: rgba(255, 255, 255, 0.2);
            }

            /* Main Content */
            .main-content {
                margin-left: 220px;
                width: calc(100% - 220px);
                padding: 20px;
                background: #F5F5FF;
            }

            /* Header */
            .header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }

            .header h1 {
                font-size: 28px;
                font-weight: 700;
                color: #1F2937;
            }

            .header-actions {
                display: flex;
                align-items: center;
                gap: 15px;
            }

            .search-bar {
                display: flex;
                align-items: center;
                background: #FFFFFF;
                border-radius: 8px;
                padding: 8px 15px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            }

            .search-bar i {
                color: #6B7280;
                margin-right: 10px;
            }

            .search-bar input {
                border: none;
                outline: none;
                font-size: 14px;
                color: #1F2937;
            }

            .user-profile {
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .user-profile img {
                width: 40px;
                height: 40px;
                border-radius: 50%;
            }

            .user-profile span {
                font-size: 14px;
                font-weight: 600;
                color: #1F2937;
            }

            /* Welcome Card */
            .welcome-card {
                background: linear-gradient(135deg, rgb(44, 1, 109), rgb(88, 68, 116));
                border-radius: 12px;
                padding: 25px;
                display: flex;
                align-items: center;
                gap: 20px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
                margin-bottom: 10px;
            }

            .welcome-card:hover {
                transform: scale(1.03);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: linear-gradient(135deg, rgb(34, 0, 84), rgb(154, 92, 235));
            }

            .welcome-avatar {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 80px;
                height: 80px;
                background: #FFFFFF;
                border-radius: 50%;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }

            .welcome-avatar span {
                font-size: 40px;
            }

            .welcome-text h2 {
                font-size: 24px;
                font-weight: 700;
                color: #FFFFFF;
                margin-bottom: 5px;
            }

            .welcome-text p {
                font-size: 14px;
                color: #E5E7EB;
            }

            /* Stats Grid */
            .stats-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
                margin-bottom: 20px;
            }

            .stat-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .stat-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .stat-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 10px;
            }

            .stat-value {
                font-size: 28px;
                font-weight: 700;
                color: #1F2937;
                margin-bottom: 10px;
            }

            .progress-bar {
                background: #E5E7EB;
                border-radius: 8px;
                height: 8px;
                overflow: hidden;
            }

            .progress {
                background: #7C3AED;
                height: 100%;
                transition: width 0.3s ease;
            }

            /* Content Grid */
            .content-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 15px;
            }

            /* Fortune Wheel Card */
            .wheel-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                text-align: center;
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .wheel-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .wheel-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 10px;
            }

            .wheel-card p {
                font-size: 14px;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .wheel {
                position: relative;
                width: 150px;
                height: 150px;
                margin: 0 auto;
                border-radius: 50%;
                border: 6px solid #7C3AED;
                overflow: hidden;
                box-shadow: 0 4px 15px rgba(124, 58, 237, 0.2);
                background: #FFFFFF;
            }

            .wheel-circle {
                width: 100%;
                height: 100%;
                position: absolute;
                transform: rotate(0deg);
                transition: transform 4s ease-out;
            }

            .wheel-segment {
                width: 50%;
                height: 50%;
                position: absolute;
                top: 50%;
                left: 50%;
                transform-origin: 0% 0%;
                font-size: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #FFFFFF;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .wheel-segment:hover {
                transform: scale(1.1) translate(-90%, -90%);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            }
            @media (max-width: 768px) {
  .dashboard-container {
    flex-direction: column;
  }
  .sidebar {
    position: relative;
    width: 100%;
    margin-bottom: 20px;
  }
  .main-content {
    margin-left: 0;
    width: 100%;
  }
}


            .segment1 { transform: rotate(0deg) translate(-100%, -100%); background: #7C3AED; }
            .segment2 { transform: rotate(60deg) translate(-100%, -100%); background: #F472B6; }
            .segment3 { transform: rotate(120deg) translate(-100%, -100%); background: #FBBF24; }
            .segment4 { transform: rotate(180deg) translate(-100%, -100%); background: #34D399; }
            .segment5 { transform: rotate(240deg) translate(-100%, -100%); background: #A78BFA; }
            .segment6 { transform: rotate(300deg) translate(-100%, -100%); background: #F9A8D4; }

            .wheel-pointer {
                position: absolute;
                top: -15px;
                left: 50%;
                transform: translateX(-50%);
                width: 0;
                height: 0;
                border-left: 8px solid transparent;
                border-right: 8px solid transparent;
                border-bottom: 15px solid #7C3AED;
            }

            .spin-button {
                margin-top: 10px;
                background: #7C3AED;
                color: #FFFFFF;
                border: none;
                padding: 8px 16px;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                box-shadow: 0 4px 10px rgba(124, 58, 237, 0.2);
                transition: transform 0.2s ease, box-shadow 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px; /* Espacement entre icône et texte */
            }

            .spin-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 6px 15px rgba(124, 58, 237, 0.3);
            }

            /* Chart Card */
            .chart-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .chart-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .chart-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .custom-chart {
                max-width: 100%;
                height: 250px;
            }

            /* Calendar Card */
            .calendar-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .calendar-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .calendar-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .calendar {
                width: 100%;
            }

            .calendar-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 15px;
            }

            .nav-arrow {
                background: none;
                border: none;
                color: #6B7280;
                cursor: pointer;
                font-size: 16px;
                transition: color 0.3s ease;
            }

            .nav-arrow:hover {
                color: #7C3AED;
            }

            .calendar-grid {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 5px;
                text-align: center;
            }

            .day-header {
                font-size: 12px;
                font-weight: 600;
                color: #6B7280;
                padding: 5px 0;
            }

            .day {
                font-size: 14px;
                padding: 8px;
                border-radius: 8px;
                color: #1F2937;
                background: #F9FAFB;
            }

            .day.empty {
                background: transparent;
            }

            .day.current {
                background: #7C3AED;
                color: #FFFFFF;
                font-weight: 600;
            }

            /* Events Card */
            .events-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .events-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .events-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .events-list {
                list-style: none;
            }

            .events-list li {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px 0;
                border-bottom: 1px solid #F1F3F5;
            }

            .events-list li:last-child {
                border-bottom: none;
            }

            .event-details p {
                font-size: 14px;
                font-weight: 500;
                color: #1F2937;
            }

            .event-details span {
                font-size: 12px;
                color: #6B7280;
            }

            .event-status {
                font-size: 12px;
                font-weight: 600;
                padding: 5px 10px;
                border-radius: 12px;
            }

            .event-status.confirmed {
                background: #D1FAE5;
                color: #10B981;
            }

            .event-status.pending {
                background: #FEE2E2;
                color: #EF4444;
            }

            /* Activity Card */
            .activity-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .activity-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .activity-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .activity-list {
                list-style: none;
            }

            .activity-list li {
                display: flex;
                align-items: center;
                padding: 10px 0;
                border-bottom: 1px solid #F1F3F5;
            }

            .activity-list li:last-child {
                border-bottom: none;
            }

            .activity-icon {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 44px;
                height: 44px;
                background: #EDE9FE;
                border-radius: 12px;
                margin-right: 15px;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .activity-icon:hover {
                transform: scale(1.1);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            }

            .activity-icon span {
                font-size: 24px;
            }

            .activity-details p {
                font-size: 14px;
                font-weight: 500;
                color: #1F2937;
            }

            .activity-details span {
                font-size: 12px;
                color: #6B7280;
            }

            /* Achievements Card */
            .achievements-card {
                background: #FFFFFF;
                border-radius: 12px;
                padding: 15px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
                transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            }

            .achievements-card:hover {
                transform: scale(1.1);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                background: #F8F8FF;
            }

            .achievements-card h3 {
                font-size: 16px;
                font-weight: 600;
                color: #6B7280;
                margin-bottom: 15px;
            }

            .achievements-list {
                list-style: none;
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }

            .achievement-item {
                display: flex;
                align-items: center;
                background: #F9FAFB;
                border-radius: 8px;
                padding: 10px;
                width: calc(50% - 5px);
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }

            .achievement-item:hover {
                transform: scale(1.05);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            }

            .achievement-icon {
                font-size: 24px;
                margin-right: 10px;
            }

            .achievement-details p {
                font-size: 14px;
                font-weight: 500;
                color: #1F2937;
                margin: 0;
            }

            .achievement-details span {
                font-size: 12px;
                color: #6B7280;
            }

            /* Responsive Adjustments */
            @media (max-width: 768px) {
                .sidebar {
                    width: 200px;
                }

                .main-content {
                    margin-left: 200px;
                    width: calc(100% - 200px);
                    padding: 15px;
                }

                .header h1 {
                    font-size: 24px;
                }

                .stats-grid,
                .content-grid {
                    grid-template-columns: 1fr;
                }

                .wheel {
                    width: 120px;
                    height: 120px;
                }

                .custom-chart {
                    height: 200px;
                }

                .achievement-item {
                    width: 100%;
                }
            }
        </style>
    {% endblock %}

    {% block body %}
        <div class="dashboard-container">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="logo">
                    <h1>Connect Sphere</h1>
                </div>
                <ul><li><a href="{{ path('app_home') }}" class="active"><i class="fas fa-home"></i> Home</a></li>
                                   <li><a href="{{ path('app_points') }}" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                                      <li><a href='/points/fortune-wheel'><i class="fas fa-box"></i><span>Fourtune wheel</span></a></li>
                                  <li><a href="{{ path('app_convert_points') }}"><i class="fas fa-users"></i><span>Conversion </span></a></li>
                                    <li class="menu-item logout">

                                                 <li class="menu-item logout">
                                                     <a href="{{ path('app_logout') }}">
                                                         <i class="fas fa-sign-out-alt"></i>
                                                         <span>Logout</span>
                                                     </a>
                                                 </li>


                </ul>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Welcome Card -->
                <div class="welcome-card">
                    <div class="welcome-avatar">
                        <span>👨‍💻</span>
                    </div>
                    <div class="welcome-text">
                        <h2>Welcome to Your Dashboard!</h2>
                        <p>Track your points, activities, and achievements here!</p>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Daily Visit Streak</h3>
                        <div class="stat-value">{{ visitesCount|default(0) }}</div>
                        {% if pointAddedMessage is defined and pointAddedMessage %}
                            <div style="color: #7C3AED; font-size: 13px; margin-top: 4px;">{{ pointAddedMessage }}</div>
                        {% endif %}
                    </div>
                    <div class="stat-card">
                        <h3>Total Events Attended</h3>
                        <p class="stat-value">12</p>
                        <div class="progress-bar">
                          <div class="progress" style="width: {{ min(12 / 15 * 100, 100) }}%;"></div>

                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Points <button id="refreshPoints" style="background: none; border: none; cursor: pointer; font-size: 14px;"><i class="fas fa-sync-alt"></i></button></h3>
                        <p class="stat-value" id="userPoints">{{user.points|default('Aucun point') }}</p>
                        <pre id="debugUser" style="font-size:10px;color:#888;"></pre>
                        <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                try {
                                    var user = {{ user|json_encode|raw }};
                                    document.getElementById('debugUser').textContent = JSON.stringify(user, null, 2);
                                    console.log('DEBUG user:', user);
                                } catch(e) {
                                    document.getElementById('debugUser').textContent = 'Erreur debug user: ' + e;
                                }
                            });
                        </script>
                        <div class="progress-bar">
                          <div class="progress" id="pointsProgress" style="width: {{ min(340 / 1000 * 100, 100) }}%;"></div>

                        </div>
                    </div>
                     
                </div>

                <!-- Main Content Grid -->
                <div class="content-grid">
                    <!-- Fortune Wheel -->
                    <div class="wheel-card">
                        <h3>Fortune Wheel</h3>
                        <p>Use the Fortune Wheel to earn extra points every day.</p>
                        <div class="wheel">
                            <div class="wheel-circle" id="wheel">
                                <div class="wheel-segment segment1">🎁</div>
                                <div class="wheel-segment segment2">🎉</div>
                                <div class="wheel-segment segment3">💰</div>
                                <div class="wheel-segment segment4">⭐</div>
                                <div class="wheel-segment segment5">🎊</div>
                                <div class="wheel-segment segment6">🍀</div>
                            </div>
                            <div class="wheel-pointer"></div>
                        </div>
                        <button id="spinButton" class="spin-button"><i class="fas fa-sync-alt"></i> SPIN</button>
                    </div>

                    <!-- Chart -->
                    <div class="chart-card">
                        <h3>Weekly Points Progress</h3>
                        <canvas id="pointChart" class="custom-chart" width="500" height="500" style="background:#fff; border-radius:12px; border:1px solid #eee;"></canvas>
                        <canvas id="pointChart2" class="custom-chart" width="500" height="500" style="background:#fff; border-radius:12px; border:1px solid #eee; display:none;"></canvas>
                    </div>

                    <!-- Calendar -->
                    <div class="calendar-card">
                        <h3>{% set currentMonth = "now"|date('F Y') %}{{ currentMonth }}</h3>
                        <div class="calendar">
                            <div class="calendar-header">
                                <button class="nav-arrow"><i class="fas fa-chevron-left"></i> Prev</button>
                                <button class="nav-arrow"><i class="fas fa-chevron-right"></i> Next</button>
                            </div>
                            <div class="calendar-grid">
                                <div class="day-header">Mon</div>
                                <div class="day-header">Tue</div>
                                <div class="day-header">Wed</div>
                                <div class="day-header">Thu</div>
                                <div class="day-header">Fri</div>
                                <div class="day-header">Sat</div>
                                <div class="day-header">Sun</div>
                                {# Days rendering #}
                                {% set today = "now"|date('j') %}
                                {% set currentMonth = "now"|date('n') %}
                                {% set currentYear = "now"|date('Y') %}
                                {% set firstDayOfMonth = date('now')|date_modify('first day of this month') %}
                                {% set startWeekDay = firstDayOfMonth|date('N') %}
                                {% set daysInMonth = "now"|date('t') %}
                                {% for i in 1..(startWeekDay-1) %}
                                    <div class="day empty"></div>
                                {% endfor %}
                                {% for day in 1..daysInMonth %}
                                    <div class="day{% if day == today|number_format(0, '', '') and currentMonth == "now"|date('n') and currentYear == "now"|date('Y') %} current{% endif %}">{{ day }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Recent Events -->
                    <div class="events-card">
                        <h3>Recent Events</h3>
                        <ul class="events-list">
                            <li>
                                <div class="event-details">
                                    <p>Tech Conference 2025</p>
                                    <span>April 20, 2025</span>
                                </div>
                                <span class="event-status confirmed">Confirmed</span>
                            </li>
                            <li>
                                <div class="event-details">
                                    <p>AI Workshop</p>
                                    <span>April 15, 2025</span>
                                </div>
                                <span class="event-status pending">Pending</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity-card">
                        <h3>Recent Activity</h3>
                        <ul class="activity-list">
                            <li>
                                <span class="activity-icon"><span>🥇</span></span>
                                <div class="activity-details">
                                    <p>Earned 100 points</p>
                                    <span>2025-03-17</span>
                                </div>
                            </li>
                            <li>
                                <span class="activity-icon"><span>📅</span></span>
                                <div class="activity-details">
                                    <p>Attended Event</p>
                                    <span>2025-03-15</span>
                                </div>
                            </li>
                        </ul>
                    </div>

                    <!-- Achievements -->
                    <div class="achievements-card">
                        <h3>Achievements</h3>
                        <ul class="achievements-list">
                            <li class="achievement-item">
                                <span class="achievement-icon">🏆</span>
                                <div class="achievement-details">
                                    <p>Daily Login Streak</p>
                                    <span>Logged in {{ streak|default(0) }} days in a row</span>
                                </div>
                            </li>
                            <li class="achievement-item">
                                <span class="achievement-icon">🎯</span>
                                <div class="achievement-details">
                                    <p>Event Master</p>
                                    <span>Attended 10 events</span>
                                </div>
                            </li>
                            <li class="achievement-item">
                                <span class="achievement-icon">⭐</span>
                                <div class="achievement-details">
                                    <p>Points Pro</p>
                                    <span>Earned 500 points</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    {% endblock %}

    {% block javascripts %}
       


        
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log('Chargement du script pour le graphique');

            // Utiliser des données statiques correspondant à l'image
            const labels = ['2025/03/13', '2025/03/14', '2025/03/15', '2025/03/16', '2025/03/17', '2025/03/18', '2025/03/19'];
            const pointsEarned = [0, 0, 0, 400, 600, 100, 0];
            const pointsLost = [0, 0, 0, 0, 0, 0, 50];

            console.log('Labels:', labels);
            console.log('Points gagnés:', pointsEarned);
            console.log('Points perdus:', pointsLost);

            let canvas = document.getElementById('pointChart');
            if (!canvas) {
                canvas = document.getElementById('pointChart2');
                if (canvas) canvas.style.display = 'block';
            }
            if (!canvas) {
                alert('Aucun canvas pour afficher le graphique');
                return;
            }
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                alert('Impossible d’obtenir le contexte 2D du canvas');
                return;
            }

            // Dégradé pour la courbe Points Earned
            const gradient = ctx.createLinearGradient(0, 0, 0, 250);
            gradient.addColorStop(0, 'rgba(124,58,237,0.25)');
            gradient.addColorStop(1, 'rgba(124,58,237,0)');

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Points Earned',
                            data: pointsEarned,
                            borderColor: '#7C3AED',
                            backgroundColor: gradient,
                            borderWidth: 4,
                            pointRadius: 7,
                            pointBackgroundColor: '#7C3AED',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 3,
                            fill: true,
                            tension: 0.3,
                            hoverRadius: 10,
                        },
                        {
                            label: 'Points Lost',
                            data: pointsLost,
                            borderColor: '#F472B6',
                            backgroundColor: '#F472B6',
                            borderWidth: 4,
                            pointRadius: 7,
                            pointBackgroundColor: '#F472B6',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 3,
                            fill: false,
                            tension: 0.3,
                            hoverRadius: 10,
                        }
                    ]
                },
                options: {
                    plugins: {
                        legend: {
                            labels: {
                                boxWidth: 28,
                                boxHeight: 14,
                                font: { size: 18, weight: 'bold' },
                                color: '#6B7280',
                                padding: 30
                            }
                        },
                        tooltip: {
                            enabled: true,
                            backgroundColor: '#fff',
                            titleColor: '#7C3AED',
                            bodyColor: '#1F2937',
                            borderColor: '#7C3AED',
                            borderWidth: 2,
                            titleFont: { size: 16, weight: 'bold' },
                            bodyFont: { size: 15 },
                            padding: 12,
                            displayColors: false
                        }
                    },
                    layout: {
                        padding: 30
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Points',
                                font: { size: 18, weight: 'bold' },
                                color: '#7C3AED'
                            },
                            grid: {
                                color: '#E5E7EB',
                                lineWidth: 2
                            },
                            ticks: { font: { size: 16 }, color: '#6B7280' }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Days',
                                font: { size: 18, weight: 'bold' },
                                color: '#7C3AED'
                            },
                            grid: {
                                color: '#F3F4F6',
                                lineWidth: 2
                            },
                            ticks: { font: { size: 16 }, color: '#6B7280', maxRotation: 45, minRotation: 45 }
                        }
                    },
                    animation: {
                        duration: 1200,
                        easing: 'easeOutQuart'
                    }
                }
            });

            console.log('Graphique affiché avec succès');
        });
        {% if pointAddedMessage %}
            alert("{{ pointAddedMessage|e('js') }}");
        {% endif %}
    </script>
{% endblock %}
</file>

<file path="points/roulette_error.html.twig">
{% extends 'base.html.twig' %}

    {% block body %}
        <div class="alert alert-danger">
            {{ app.flashes('error')|first }}
        </div>
    {% endblock %}
</file>

<file path="points/roulette_test.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Roulette</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .test-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        button {
            background-color: #4B0082;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #6A0DAD;
        }
        pre {
            background-color: #f8f8f8;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            margin-top: 10px;
        }
        .result {
            margin-top: 20px;
            padding: 10px;
            border-radius: 4px;
        }
        .success {
            background-color: #e6ffe6;
            border: 1px solid #99cc99;
        }
        .error {
            background-color: #ffe6e6;
            border: 1px solid #cc9999;
        }
    </style>
</head>
<body>
    <h1>Test de la Roulette</h1>
    
    <div class="test-container">
        <h2>Test de la requête AJAX</h2>
        <p>Ce test simule une requête AJAX vers le contrôleur RouletteController.</p>
        <button id="testBtn">Tester la requête</button>
        <div id="requestInfo" class="result"></div>
    </div>

    <script>
        document.getElementById('testBtn').addEventListener('click', function() {
            const resultDiv = document.getElementById('requestInfo');
            resultDiv.innerHTML = '<p>Envoi de la requête...</p>';
            resultDiv.className = 'result';
            
            // Préparer les données à envoyer (simuler un segment aléatoire)
            const segmentIndex = Math.floor(Math.random() * 5); // 0-4
            const requestData = JSON.stringify({ segmentIndex: segmentIndex });
            
            // Afficher les données envoyées
            resultDiv.innerHTML += `<p>Données envoyées:</p><pre>${requestData}</pre>`;
            
            // Envoyer la requête
            fetch('{{ path("app_fortune_wheel") }}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                },
                body: requestData
            })
            .then(response => {
                // Afficher les informations sur la réponse
                resultDiv.innerHTML += `<p>Statut de la réponse: ${response.status}</p>`;
                resultDiv.innerHTML += `<p>Headers de la réponse:</p><pre>${[...response.headers.entries()].map(entry => entry[0] + ': ' + entry[1]).join('\n')}</pre>`;
                
                if (!response.ok) {
                    throw new Error('Erreur HTTP : ' + response.status);
                }
                
                // Vérifier le type de contenu
                const contentType = response.headers.get('content-type');
                resultDiv.innerHTML += `<p>Type de contenu: ${contentType}</p>`;
                
                if (!contentType || !contentType.includes('application/json')) {
                    throw new Error('La réponse n\'est pas au format JSON');
                }
                
                return response.text().then(text => {
                    // Afficher le texte brut de la réponse
                    resultDiv.innerHTML += `<p>Réponse brute:</p><pre>${text}</pre>`;
                    
                    try {
                        // Essayer de parser le JSON
                        return JSON.parse(text);
                    } catch (e) {
                        console.error('Erreur lors du parsing JSON:', e);
                        resultDiv.innerHTML += `<p>Erreur de parsing JSON: ${e.message}</p>`;
                        throw new Error('Impossible de parser la réponse JSON: ' + e.message);
                    }
                });
            })
            .then(data => {
                // Afficher les données parsées
                resultDiv.innerHTML += `<p>Données parsées:</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
                
                if (data.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML += `<p>✅ Test réussi! Vous avez gagné: ${data.reward} (${data.pointsWon} points)</p>`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML += `<p>❌ Erreur: ${data.message}</p>`;
                }
            })
            .catch(error => {
                console.error('Erreur lors de la requête AJAX:', error);
                resultDiv.className = 'result error';
                resultDiv.innerHTML += `<p>❌ Erreur: ${error.message}</p>`;
            });
        });
    </script>
</body>
</html>
</file>

<file path="profile/edit.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Edit Profile - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {# <link rel="stylesheet" href="{{ asset('css/profile.css') }}"> -- CSS will be embedded #}

    {# Added for header/footer icons and font if not in base.html.twig #}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* --- ROOT CSS Variables (Consistent with other pages) --- */
        :root {
            /* Variables for Header/Footer theme & general site theme */
            --theme-primary-pink: #E83E8C;
            --theme-primary-pink-hover: #d0367c;
            --theme-secondary-action: #6c757d;
            --theme-secondary-action-hover: #5a6268;

            --theme-text-dark: #343A40;
            --theme-text-light: #6c757d;
            --theme-text-muted: #8898aa;
            --theme-border-color: #DEE2E6;
            --theme-border-color-strong: #ced4da; /* For inputs */

            --pill-radius: 50px;
            --card-radius: 8px;
            --input-radius: 6px;

            --card-bg: white;
            --page-bg: #f8f9fa;
            --card-header-bg-accent: var(--theme-primary-pink); /* Pink for card headers */

            /* General Variables */
            --body-font: 'Poppins', sans-serif;
            --transition-fast: 0.2s ease-in-out;
            --transition-medium: 0.3s ease;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        body {
            font-family: var(--body-font);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-color: var(--page-bg);
            color: var(--theme-text-dark);
            line-height: 1.6;
        }
        .page-content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* --- Header Styles --- */
        .header { background: var(--card-bg); box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: .8rem 1rem; border-bottom: 1px solid var(--theme-border-color); }
        .header .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .header .logo-img { height: 50px; vertical-align: middle; }
        .header .logo a span { vertical-align: middle; font-weight:bold; font-size:1.5rem; color:var(--theme-text-dark); margin-left:10px; }
        .header .nav-links { display: flex; align-items: center; gap: 1.5rem; }
        .header .nav-link { font-weight: 500; transition: color var(--transition-fast); color: var(--theme-text-dark); text-decoration: none; padding: 0.5rem 0; }
        .header .nav-link:hover, .header .nav-link.active { color: var(--theme-primary-pink); text-decoration: none; }
        .header .contact-btn { background: var(--theme-primary-pink); color: white !important; padding: .5rem 1.2rem; border-radius: var(--pill-radius); font-weight: 500; text-decoration: none; transition: background-color var(--transition-fast); }
        .header .contact-btn:hover { background: var(--theme-primary-pink-hover); }

        /* --- Footer Styles --- */
        .site-footer { background: #343a40; color: rgba(255,255,255,.75); padding: 3rem 1rem 1.5rem; margin-top: auto; }
        .site-footer .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 2rem; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .site-footer .footer-column { flex: 1 1 200px; }
        .site-footer .footer-column h4 { color: #fff; margin-bottom: 1rem; font-weight: 600; border-bottom: 2px solid var(--theme-primary-pink); display: inline-block; padding-bottom: .5rem; }
        .site-footer .footer-column ul { list-style: none; padding: 0; }
        .site-footer .footer-column ul li { margin-bottom: .6rem; }
        .site-footer .footer-column ul li a { color: rgba(255,255,255,.75); transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-column ul li a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-contact i { margin-right: .5rem; color: var(--theme-primary-pink); }
        .site-footer .footer-social-icons a { color: rgba(255,255,255,.75); margin-right: 1rem; font-size: 1.5rem; transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-social-icons a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-bottom { text-align: center; margin-top: 2rem; font-size: .85rem; color: rgba(255,255,255,.55); border-top: 1px solid #495057; padding-top: 1rem; max-width: 1140px; margin-left: auto; margin-right: auto;}

        /* --- Profile Edit Page Styles (Adapted from profile.css) --- */
        .profile-container { /* This class is used in your HTML */
            max-width: 800px; /* Max width for the form container */
            margin: 2rem auto;
            padding: 0 15px;
            flex-grow: 1;
        }

        .profile-card { /* This class is used in your HTML */
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            overflow: hidden;
            border: 1px solid var(--theme-border-color);
        }

        .profile-card .card-header {
            background-color: var(--card-header-bg-accent); /* Pink header */
            color: white;
            padding: 1.5rem;
        }

        .profile-card .card-header h3 {
            font-weight: 600;
            margin: 0;
            font-size: 1.5rem;
        }

        .profile-card .card-body {
            padding: 2rem;
        }

        /* Form Specific Styles (Adapted from profile.css form section) */
        form { /* Targeting the form element directly */
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Spacing between form groups */
        }

        .form-group {
            margin-bottom: 0; /* Gap is handled by parent form flex */
        }

        .form-row { /* For side-by-side fields like Age and Gender */
            display: flex;
            gap: 1.5rem; /* Spacing between items in the row */
            /* margin: 0 -10px; -- Original from profile.css, replaced by gap */
            /* margin-bottom: 1.5rem; -- Gap handles this */
        }

        .form-group.half { /* For items in .form-row */
            flex: 1; /* Each takes half the space */
            /* width: 50%; -- Replaced by flex:1 */
            /* padding: 0 10px; -- Gap handles this */
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--theme-text-dark);
            font-weight: 500;
            font-size: 0.9rem;
        }

        input[type="text"],
        input[type="email"],
        input[type="number"],
        input[type="file"],
        select,
        textarea { /* Target textarea correctly */
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid var(--theme-border-color-strong);
            border-radius: var(--input-radius);
            font-size: 1rem;
            color: var(--theme-text-dark);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            background-color: var(--card-bg); /* Or a very light gray like #f8f9fa */
            box-sizing: border-box;
        }
        /* Special handling for file input if needed to look more like others */
        input[type="file"] {
            padding: 0.6rem 1rem; /* Adjust if it looks too tall */
        }


        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="number"]:focus,
        input[type="file"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--theme-primary-pink); /* Pink focus highlight */
            box-shadow: 0 0 0 0.2rem rgba(232, 62, 140, 0.25); /* Pink glow */
        }
        textarea { /* Explicitly target textarea */
             min-height: 80px; /* Adjust as needed */
             resize: vertical;
        }


        /* Form Actions (Save, Cancel buttons) */
        .form-actions {
            display: flex;
            justify-content: flex-end; /* Align buttons to the right */
            gap: 1rem;
            margin-top: 1.5rem; /* Space above buttons */
            padding-top: 1.5rem; /* Space from content above, if any */
            border-top: 1px solid var(--theme-border-color);
        }

        .form-actions .btn { /* General style for form action buttons */
            padding: 0.75rem 1.5rem;
            border-radius: var(--input-radius);
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            font-size: 0.95rem;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        .form-actions .btn i {
             margin-right: 0.5rem;
        }


        .form-actions .btn-primary { /* "Save Changes" button */
            background-color: var(--theme-primary-pink);
            color: white;
            border-color: var(--theme-primary-pink);
        }
        .form-actions .btn-primary:hover {
            background-color: var(--theme-primary-pink-hover);
            border-color: var(--theme-primary-pink-hover);
            transform: translateY(-1px);
        }

        .form-actions .btn-cancel { /* "Cancel" button */
            background-color: transparent;
            color: var(--theme-text-light);
            border-color: var(--theme-border-color-strong);
        }
        .form-actions .btn-cancel:hover {
            background-color: var(--page-bg); /* Light hover */
            color: var(--theme-text-dark);
            border-color: var(--theme-text-muted);
        }

        /* Image preview style from your original My Profile page */
        #profilePicturePreview { /* Using a more specific ID for edit page preview */
            margin-top: 1rem;
            max-height: 150px; /* Max height for preview */
            max-width: 150px; /* Max width for preview, can be 100% if you prefer */
            border-radius: var(--input-radius); /* Match input radius */
            display: block; /* Changed from none to block to always take space, hide with visibility or opacity */
            visibility: hidden; /* Initially hidden */
            opacity: 0;
            transition: opacity var(--transition-fast), visibility var(--transition-fast);
            border: 1px solid var(--theme-border-color);
            object-fit: cover;
        }
        #profilePicturePreview.visible {
            visibility: visible;
            opacity: 1;
        }


        /* Responsive styles */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column; /* Stack age and gender */
                gap: 1.5rem; /* Keep consistent gap */
            }
            .form-group.half {
                width: 100%; /* Full width when stacked */
            }
            .form-actions {
                flex-direction: column-reverse; /* Stack buttons, primary on bottom */
                gap: 1rem;
            }
            .form-actions .btn {
                width: 100%;
            }

            /* Header responsive */
           .header .nav-container { flex-direction: column; align-items: flex-start; }
           .header .nav-links { margin-top: 1rem; flex-direction: column; align-items: flex-start; width: 100%; }
           .header .nav-link, .header .contact-btn { padding: 0.5rem; width: 100%; text-align: left; }
           .header .contact-btn { margin-top: 0.5rem; }
           /* Footer responsive */
           .site-footer .footer-content { flex-direction: column; align-items: center; text-align: center; }
           .site-footer .footer-column { min-width: 100%; margin-bottom: 1rem; }
           .site-footer .footer-column h4 { display: block; }
        }
    </style>
{% endblock %}

{% block body %}
    {# --- HEADER --- #}
    <header class="header">
        <nav class="nav-container">
          <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
              <img src="{{ asset('images/logo.png') }}" alt="Logo ConnectSphere" class="logo-img">
              <span>ConnectSphere</span>
            </a>
          </div>
          <div class="nav-links">
            <a href="{{ path('app_home') }}" class="nav-link">Home</a>
            <a href="{{ path('app_events') }}" class="nav-link">Events</a>
            <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
            <a href="{{ path('app_dashboard') }}" class="nav-link">Dashboard</a>
            <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
            <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
            <a href="{{ path('app_profile') }}" class="nav-link active">Profile</a> {# Profile section is active #}
            <a href="{{ path('app_logout') }}" class="contact-btn nav-link">Logout</a>
          </div>
        </nav>
    </header>

    {# --- Main Content Area --- #}
    <div class="page-content-wrapper">
        <div class="profile-container">
            <div class="profile-card">
                <div class="card-header">
                    <h3>Edit Profile</h3>
                </div>
                <div class="card-body">
                    {# Display flash messages if any #}
                    {% for label, messages in app.flashes %}
                        {% for message in messages %}
                            <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                    {% endfor %}

                    <form method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" name="username" class="form-control" value="{{ user.username }}" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" class="form-control" value="{{ user.email }}" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group half">
                                <label for="age">Age</label>
                                <input type="number" id="age" name="age" class="form-control" value="{{ user.age }}" required min="1">
                            </div>
                            <div class="form-group half">
                                <label for="gender">Gender</label>
                                <select id="gender" name="gender" class="form-control" required>
                                    <option value="" disabled {% if user.gender is null or user.gender == '' %}selected{% endif %}>Select gender</option>
                                    <option value="Male" {% if user.gender == 'Male' %}selected{% endif %}>Male</option>
                                    <option value="Female" {% if user.gender == 'Female' %}selected{% endif %}>Female</option>
                                    <option value="Other" {% if user.gender == 'Other' %}selected{% endif %}>Other</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="bio">Bio</label>
                            {# Changed input to textarea for bio #}
                            <textarea id="bio" name="bio" class="form-control" rows="4" placeholder="Tell us a little about yourself...">{{ profile.bio|default('') }}</textarea>
                        </div>

                        <div class="form-group">
                            <label for="profilePictureFile">Profile Picture</label> {# Changed ID and name for clarity #}
                            <input type="file" id="profilePictureFile" name="profilePictureFile" class="form-control" accept="image/jpeg, image/png, image/gif">
                            <img id="profilePicturePreview" alt="New Profile Picture Preview" />
                             {% if profile and profile.profilePicture %}
                                <p class="mt-2"><small>Current picture: {{ profile.profilePicture }}. Leave empty to keep current.</small></p>
                            {% endif %}
                        </div>

                        <div class="form-actions">
                            <a href="{{ path('app_profile') }}" class="btn btn-cancel">
                                <i class="fas fa-times"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    {# --- FOOTER --- #}
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column"><h4>ConnectSphere</h4><p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p></div>
            <div class="footer-column"><h4>Quick Links</h4><ul><li><a href="{{ path('app_home') }}">Home</a></li><li><a href="{{ path('app_events') }}">Events</a></li><li><a href="#">About Us</a></li><li><a href="#">Blog</a></li><li><a href="#">Contact</a></li><li><a href="#">Terms of Service</a></li></ul></div>
            <div class="footer-column footer-contact"><h4>Contact Us</h4><p><i class="fas fa-phone"></i> <a href="tel:+21692160411">+216 92 160 411</a></p><p><i class="fas fa-envelope"></i> <a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p></div>
            <div class="footer-column"><h4>Follow Us</h4><div class="footer-social-icons"><a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a><a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a><a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a><a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a></div></div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const profilePictureInput = document.getElementById('profilePictureFile');
            const previewImage = document.getElementById('profilePicturePreview');

            if (profilePictureInput && previewImage) {
                profilePictureInput.addEventListener('change', function () {
                    if (this.files && this.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            previewImage.src = e.target.result;
                            previewImage.classList.add('visible'); // Use class to show
                        };
                        reader.readAsDataURL(this.files[0]);
                    } else {
                        previewImage.src = ''; // Clear src
                        previewImage.classList.remove('visible'); // Use class to hide
                    }
                });
            }

            // Dismissible alerts (if Bootstrap JS is loaded)
            var alertList = document.querySelectorAll('.alert');
            alertList.forEach(function (alert) {
              new bootstrap.Alert(alert);
            });
        });
    </script>
    {# Ensure Bootstrap JS is loaded in base.html.twig for alert dismissal #}
    {# Example: <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> #}
{% endblock %}
</file>

<file path="profile/index.html.twig">
{% extends 'base.html.twig' %}

{% block title %}My Profile - Connect Sphere{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {# <link rel="stylesheet" href="{{ asset('css/profile.css') }}"> -- CSS will be embedded #}

    {# Added for header/footer icons and font if not in base.html.twig #}
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* --- ROOT CSS Variables (Consistent with other pages) --- */
        :root {
            /* Variables for Header/Footer theme & general site theme */
            --theme-primary-pink: #E83E8C;
            --theme-primary-pink-hover: #d0367c;
            --theme-secondary-action: #6c757d; /* Example: A neutral secondary color */
            --theme-secondary-action-hover: #5a6268; /* Example */

            --theme-text-dark: #343A40;
            --theme-text-light: #6c757d; /* Softer text color */
            --theme-text-muted: #8898aa; /* Even softer for less important text */
            --theme-border-color: #DEE2E6; /* Light border for cards, inputs */
            --theme-border-color-strong: #ced4da; /* Slightly stronger border if needed */

            --pill-radius: 50px; /* For header/footer buttons, badges */
            --card-radius: 8px; /* Standard card border radius */
            --input-radius: 6px; /* Standard input border radius */

            --card-bg: white;
            --page-bg: #f8f9fa; /* Light background for the page */
            --card-header-bg-accent: var(--theme-primary-pink); /* Using pink for card headers */
            --card-footer-bg: #f8f9fa; /* Light footer for cards */

            /* General Variables */
            --body-font: 'Poppins', sans-serif;
            --transition-fast: 0.2s ease-in-out;
            --transition-medium: 0.3s ease;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --card-shadow-hover: 0 6px 16px rgba(0,0,0,0.12);
        }

        body {
            font-family: var(--body-font);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            background-color: var(--page-bg);
            color: var(--theme-text-dark);
            line-height: 1.6;
        }
        .page-content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* --- Header Styles --- */
        .header { background: var(--card-bg); box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: .8rem 1rem; border-bottom: 1px solid var(--theme-border-color); }
        .header .nav-container { display: flex; justify-content: space-between; align-items: center; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .header .logo-img { height: 50px; vertical-align: middle; }
        .header .logo a span { vertical-align: middle; font-weight:bold; font-size:1.5rem; color:var(--theme-text-dark); margin-left:10px; }
        .header .nav-links { display: flex; align-items: center; gap: 1.5rem; }
        .header .nav-link { font-weight: 500; transition: color var(--transition-fast); color: var(--theme-text-dark); text-decoration: none; padding: 0.5rem 0; }
        .header .nav-link:hover, .header .nav-link.active { color: var(--theme-primary-pink); text-decoration: none; }
        .header .contact-btn { background: var(--theme-primary-pink); color: white !important; padding: .5rem 1.2rem; border-radius: var(--pill-radius); font-weight: 500; text-decoration: none; transition: background-color var(--transition-fast); }
        .header .contact-btn:hover { background: var(--theme-primary-pink-hover); }

        /* --- Footer Styles --- */
        .site-footer { background: #343a40; color: rgba(255,255,255,.75); padding: 3rem 1rem 1.5rem; margin-top: auto; }
        .site-footer .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; gap: 2rem; max-width: 1140px; margin: 0 auto; padding: 0 15px; }
        .site-footer .footer-column { flex: 1 1 200px; }
        .site-footer .footer-column h4 { color: #fff; margin-bottom: 1rem; font-weight: 600; border-bottom: 2px solid var(--theme-primary-pink); display: inline-block; padding-bottom: .5rem; }
        .site-footer .footer-column ul { list-style: none; padding: 0; }
        .site-footer .footer-column ul li { margin-bottom: .6rem; }
        .site-footer .footer-column ul li a { color: rgba(255,255,255,.75); transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-column ul li a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-contact i { margin-right: .5rem; color: var(--theme-primary-pink); }
        .site-footer .footer-social-icons a { color: rgba(255,255,255,.75); margin-right: 1rem; font-size: 1.5rem; transition: color var(--transition-fast); text-decoration: none; }
        .site-footer .footer-social-icons a:hover { color: var(--theme-primary-pink); }
        .site-footer .footer-bottom { text-align: center; margin-top: 2rem; font-size: .85rem; color: rgba(255,255,255,.55); border-top: 1px solid #495057; padding-top: 1rem; max-width: 1140px; margin-left: auto; margin-right: auto;}

        /* --- profile.css Content Starts Here - MODIFIED FOR THEME --- */
        .profile-container {
            max-width: 900px;
            margin: 2rem auto; /* Add margin for spacing from header/footer */
            padding: 0 15px; /* Consistent with header/footer containers */
            flex-grow: 1; /* Allow it to grow if content is short */
        }

        .profile-card {
            background-color: var(--card-bg);
            border-radius: var(--card-radius);
            box-shadow: var(--card-shadow);
            overflow: hidden; /* To contain border-radius effects */
            border: 1px solid var(--theme-border-color); /* Added light border */
        }

        .profile-card .card-header { /* Renamed from card-header to avoid conflict if Bootstrap used */
            background-color: var(--card-header-bg-accent); /* Using theme pink */
            color: white;
            padding: 1.5rem;
            position: relative; /* For potential absolute elements if needed */
        }

        .profile-card .card-header h3 {
            font-weight: 600;
            margin: 0;
            font-size: 1.5rem; /* Adjusted size */
        }

        .profile-card .header-content { /* From your original profile.css */
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .profile-card .card-body {
            padding: 2rem;
        }

        .profile-card .card-footer {
            padding: 1.2rem 2rem; /* Adjusted padding */
            text-align: right;
            border-top: 1px solid var(--theme-border-color);
            background-color: var(--card-footer-bg);
        }

        /* Button Styles (General, then specific overrides) */
        .btn { /* Base button style, can be global */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.7rem 1.5rem;
            border-radius: var(--input-radius); /* Match input radius for consistency */
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: all var(--transition-fast);
            border: 1px solid transparent; /* Base for outline buttons */
            font-size: 0.95rem;
        }
        .btn i {
            margin-right: 0.5rem;
        }

        .btn-edit { /* Edit button in header */
            background-color: white;
            color: var(--theme-primary-pink); /* Match card header accent */
            padding: 0.5rem 1rem; /* Slightly smaller */
            font-size: 0.85rem;
            border-radius: var(--pill-radius); /* Make it a pill */
            border: 1px solid transparent; /* Can make it themed later if needed */
        }
        .btn-edit:hover {
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .card-footer .btn-secondary { /* "Back to Dashboard" button */
            background-color: var(--theme-secondary-action);
            color: white;
            border-color: var(--theme-secondary-action);
        }
        .card-footer .btn-secondary:hover {
            background-color: var(--theme-secondary-action-hover);
            border-color: var(--theme-secondary-action-hover);
        }


        /* Profile Page Specific Styles */
        .profile-content {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            gap: 2rem; /* Add gap between left and right sections */
        }

        .profile-left {
            flex: 0 0 220px; /* Fixed width for left column, adjust as needed */
            /* width: 30%; -- Replaced by flex-basis */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center; /* Center text below image */
            /* padding-right: 2rem; -- Replaced by gap on .profile-content */
        }

        .profile-right {
            flex: 1; /* Takes remaining space */
            /* width: 70%; -- Replaced by flex: 1 */
        }

        .profile-pic { /* Container for the image */
            width: 150px; /* Match inline style */
            height: 150px;/* Match inline style */
            border-radius: 50%;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden; /* Ensure image respects border-radius */
            border: 4px solid white; /* White border around image */
        }
        .profile-pic img { /* Actual image styles from your inline style block */
            width: 100%; /* Fill the .profile-pic container */
            height: 100%;/* Fill the .profile-pic container */
            object-fit: cover;
            display: block; /* Remove extra space below image */
            /* border-radius and border are now on .profile-pic */
        }

        .profile-left h4 { /* Username */
            margin-top: 0.5rem;
            margin-bottom: 0.25rem;
            color: var(--theme-text-dark);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .member-since {
            color: var(--theme-text-muted);
            font-size: 0.85rem;
            margin-bottom: 1rem; /* Space before bio */
        }
        .profile-bio {
            font-size: 0.9rem;
            color: var(--theme-text-light);
            line-height: 1.5;
            text-align: center;
        }

        .profile-info {
            background-color: var(--page-bg); /* Use page background for info section */
            border-radius: var(--card-radius);
            overflow: hidden; /* For border-radius on rows */
            border: 1px solid var(--theme-border-color);
        }

        .info-row {
            display: flex;
            border-bottom: 1px solid var(--theme-border-color);
            align-items: center; /* Vertically align label and value */
        }
        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            flex-basis: 120px; /* Fixed width for labels, adjust as needed */
            flex-shrink: 0;
            padding: 1rem;
            /* background-color: rgba(0, 0, 0, 0.02); -- Removed for cleaner look */
            font-weight: 500;
            color: var(--theme-text-dark);
        }

        .info-value {
            flex: 1;
            padding: 1rem;
            color: var(--theme-text-light);
        }

        /* Responsive styles (integrating from your profile.css and general) */
        @media (max-width: 768px) {
            .profile-content {
                flex-direction: column; /* Stack left and right sections */
                align-items: center; /* Center profile-left content */
            }
            .profile-left, .profile-right {
                width: 100%; /* Make them full width */
                flex-basis: auto; /* Reset flex-basis */
            }
            .profile-left {
                margin-bottom: 2rem;
                padding-right: 0; /* No padding needed when stacked */
            }
            .info-label {
                flex-basis: 100px; /* Slightly smaller label on mobile */
            }

            /* Header responsive */
           .header .nav-container { flex-direction: column; align-items: flex-start; }
           .header .nav-links { margin-top: 1rem; flex-direction: column; align-items: flex-start; width: 100%; }
           .header .nav-link, .header .contact-btn { padding: 0.5rem; width: 100%; text-align: left; }
           .header .contact-btn { margin-top: 0.5rem; }
           /* Footer responsive */
           .site-footer .footer-content { flex-direction: column; align-items: center; text-align: center; }
           .site-footer .footer-column { min-width: 100%; margin-bottom: 1rem; }
           .site-footer .footer-column h4 { display: block; }
        }

        /* Form Styles (if you had an edit profile form on this page or linked,
           these are from your profile.css but might be better in a separate form.css) */
        .form-group { margin-bottom: 1.5rem; }
        .form-row { display: flex; margin: 0 -10px; margin-bottom: 1.5rem; }
        .form-group.half { width: 50%; padding: 0 10px; }
        label { display: block; margin-bottom: 0.5rem; color: var(--theme-text-dark); font-weight: 500; }
        input[type="text"], input[type="email"], input[type="number"], input[type="date"], select, textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid var(--theme-border-color-strong);
            border-radius: var(--input-radius);
            font-size: 1rem;
            color: var(--theme-text-dark);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
            background-color: var(--card-bg);
        }
        input[type="text"]:focus, input[type="email"]:focus, input[type="number"]:focus, input[type="date"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--theme-primary-pink); /* Focus with theme pink */
            box-shadow: 0 0 0 2px rgba(232, 62, 140, 0.2); /* Pink shadow */
        }
        .form-actions { display: flex; justify-content: space-between; margin-top: 2rem; }
        /* --- profile.css Content Ends Here --- */

    </style>
{% endblock %}

{% block body %}
    {# --- HEADER --- #}
    <header class="header">
        <nav class="nav-container">
          <div class="logo">
            <a href="{{ path('app_home') }}" style="display:flex;align-items:center;text-decoration:none;">
              <img src="{{ asset('images/logo.png') }}" alt="Logo ConnectSphere" class="logo-img">
              <span>ConnectSphere</span>
            </a>
          </div>
          <div class="nav-links">
            <a href="{{ path('app_home') }}" class="nav-link">Home</a>
            <a href="{{ path('app_events') }}" class="nav-link">Events</a>
            <a href="{{ path('app_job_feed') }}" class="nav-link">Job Feed</a>
            <a href="{{ path('app_dashboard') }}" class="nav-link">Dashboard</a>
            <a href="{{ path('app_groups') }}" class="nav-link">Groups</a>
            <a href="{{ path('app_chatbot') }}" class="nav-link">Chatbot</a>
            <a href="{{ path('app_profile') }}" class="nav-link active">Profile</a> {# Mark current page as active #}
            <a href="{{ path('app_login') }}" class="contact-btn nav-link">Logout</a>
          </div>
        </nav>
    </header>

    {# --- Main Content Area --- #}
    <div class="page-content-wrapper">
        <div class="profile-container">
            <div class="profile-card">
                <div class="card-header"> {# Uses .profile-card .card-header for styling #}
                    <div class="header-content">
                        <h3>My Profile</h3>
                        <a href="{{ path('app_profile_edit') }}" class="btn btn-edit">
                            <i class="fas fa-edit"></i> Edit Profile
                        </a>
                    </div>
                </div>

                <div class="card-body">
                    <div class="profile-content">
                        <div class="profile-left">
                            <div class="profile-pic">
                                {% if profile and profile.profilePicture %}
                                    <img src="{{ asset('uploads/profile_pictures/' ~ profile.profilePicture) }}" alt="Profile Picture">
                                {% else %}
                                    <img src="{{ asset('images/default-profile.png') }}" alt="Default Profile Picture">
                                {% endif %}
                            </div>

                            {% if user %}
                                <h4>{{ user.username|escape }}</h4>
                                <span class="member-since">Member since {{ user.createdAt|date('M Y') }}</span>
                            {% else %}
                                <h4>Utilisateur inconnu</h4>
                            {% endif %}

                            {% if profile and profile.bio %}
                                <p class="profile-bio">{{ profile.bio|escape|nl2br }}</p> {# Use <p> for bio, add nl2br #}
                            {% elseif user %} {# Show a default bio message if user exists but no bio #}
                                <p class="profile-bio"><em>No bio provided yet.</em></p>
                            {% endif %}
                        </div>

                        {% if user %}
                            <div class="profile-right">
                                <div class="profile-info">
                                    <div class="info-row">
                                        <div class="info-label">Email:</div>
                                        <div class="info-value">{{ user.email|escape }}</div>
                                    </div>
                                    <div class="info-row">
                                        <div class="info-label">Age:</div>
                                        <div class="info-value">{{ user.age|escape }}</div>
                                    </div>
                                    <div class="info-row">
                                        <div class="info-label">Gender:</div>
                                        <div class="info-value">{{ user.gender|escape|capitalize }}</div>
                                    </div>
                                    <div class="info-row">
                                        <div class="info-label">Points:</div>
                                        <div class="info-value">{{ user.points ?? 0 }}</div>
                                    </div>
                                    <div class="info-row">
                                        <div class="info-label">Balance:</div>
                                        <div class="info-value">{{ user.argent ?? 0 }} €</div>
                                    </div>
                                    {# Add more rows as needed #}
                                    {# Example:
                                    <div class="info-row">
                                        <div class="info-label">Location:</div>
                                        <div class="info-value">{{ profile.location|default('Not specified')|escape }}</div>
                                    </div>
                                    #}
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div class="card-footer"> {# Uses .profile-card .card-footer for styling #}
                    <a href="{{ path('app_home') }}" class="btn btn-secondary"> {# Using .btn-secondary from adapted styles #}
                        <i class="fas fa-arrow-left"></i> Back to Home
                    </a>
                </div>
            </div>
        </div>
    </div>

    {# --- FOOTER --- #}
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-column"><h4>ConnectSphere</h4><p>The ultimate platform for planning, promoting, and attending successful events. Join our community!</p></div>
            <div class="footer-column"><h4>Quick Links</h4><ul><li><a href="{{ path('app_home') }}">Home</a></li><li><a href="{{ path('app_events') }}">Events</a></li><li><a href="#">About Us</a></li><li><a href="#">Blog</a></li><li><a href="#">Contact</a></li><li><a href="#">Terms of Service</a></li></ul></div>
            <div class="footer-column footer-contact"><h4>Contact Us</h4><p><i class="fas fa-phone"></i> <a href="tel:+21692160411">+216 92 160 411</a></p><p><i class="fas fa-envelope"></i> <a href="mailto:ConnecSphere@gmail.com">ConnecSphere@gmail.com</a></p></div>
            <div class="footer-column"><h4>Follow Us</h4><div class="footer-social-icons"><a href="#" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a><a href="#" aria-label="Instagram"><i class="fab fa-instagram-square"></i></a><a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin"></i></a><a href="#" aria-label="Twitter"><i class="fab fa-twitter-square"></i></a></div></div>
        </div>
        <div class="footer-bottom">© {{ "now"|date("Y") }} ConnectSphere. All rights reserved.</div>
    </footer>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {# Add any specific JavaScript for the profile page here if needed #}
{% endblock %}
</file>

<file path="profile/profile.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Hello ProfileController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Hello {{ controller_name }}! ✅</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code><a href="{{ 'C:/Users/user/PiSymfony/src/Controller/ProfileController.php'|file_link(0) }}">src/Controller/ProfileController.php</a></code></li>
        <li>Your template at <code><a href="{{ 'C:/Users/user/PiSymfony/templates/profile/index.html.twig'|file_link(0) }}">templates/profile/index.html.twig</a></code></li>
    </ul>
</div>
{% endblock %}
</file>

<file path="security/forgot_password.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Récupération de mot de passe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            display: flex;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            width: 100%;
            max-width: 1000px;
            height: 500px;
        }
        
        .left-panel {
            padding: 40px;
            width: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .right-panel {
            width: 50%;
            background-color: #f8faff;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        h1 {
            font-size: 28px;
            color: #333;
            margin-bottom: 10px;
        }
        
        p {
            color: #6c757d;
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            color: #333;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 24px;
            border: 1px solid #ddd;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
        }
        
        input:focus {
            border-color: #6366f1;
        }
        
        button {
            width: 100%;
            background-color: #6366f1;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: #4f46e5;
        }
        
        .links {
            margin-top: 20px;
            text-align: center;
        }
        
        a {
            color: #6366f1;
            text-decoration: none;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .illustration {
            width: 80%;
            max-width: 350px;
            height: auto;
        }
        
        .gears {
            position: absolute;
            top: 50px;
            right: 50px;
            width: 80px;
            height: 80px;
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <h1>Forgot Password</h1>
            <p>Please enter your email address to receive a recovery link.</p>
            
            {% if error %}
                <div class="error">{{ error }}</div>
            {% endif %}
            
            {% if success %}
                <div class="success">{{ success }}</div>
            {% endif %}
            
            <form method="POST" action="{{ path('app_forgot_password') }}">
                <label>Email Address</label>
                <input type="email" name="email" required value="{{ email }}" placeholder="Enter your email address">
                <button type="submit">Send Link</button>
            </form>
            
            <div class="links">
                <a href="{{ path('app_login') }}">Back to Login</a>
            </div>
        </div>
        
        <div class="right-panel">
            <!-- Illustration simplifiée inspirée de l'image -->
            <svg class="illustration" viewBox="0 0 500 400" xmlns="http://www.w3.org/2000/svg">
                <!-- Fond bleu clair -->
                <ellipse cx="250" cy="200" rx="180" ry="150" fill="#dbeafe" />
                
                <!-- Téléphone/Tablette -->
                <rect x="150" y="100" width="200" height="250" rx="20" fill="#6366f1" />
                <rect x="170" y="130" width="160" height="180" rx="10" fill="#dbeafe" />
                
                <!-- Cadenas -->
                <rect x="200" y="170" width="100" height="80" rx="10" fill="#ff9e80" />
                <circle cx="250" cy="190" r="15" fill="#f8faff" />
                <rect x="240" y="190" width="20" height="40" rx="5" fill="#f8faff" />
                
                <!-- Personnage -->
                <circle cx="150" cy="250" r="15" fill="#334155" /> <!-- Tête -->
                <rect x="140" y="265" width="20" height="40" fill="#6366f1" /> <!-- Corps -->
                <rect x="130" y="280" width="15" height="5" fill="#334155" /> <!-- Bras gauche -->
                <rect x="155" y="280" width="40" height="5" fill="#334155" /> <!-- Bras droit -->
                <rect x="140" y="305" width="7" height="15" fill="#334155" /> <!-- Jambe gauche -->
                <rect x="153" y="305" width="7" height="15" fill="#334155" /> <!-- Jambe droite -->
                
                <!-- Clé -->
                <circle cx="195" cy="280" r="15" fill="#ff9e80" />
                <rect x="195" y="280" width="40" height="8" fill="#ff9e80" />
                <rect x="225" y="275" width="8" height="18" fill="#ff9e80" />
                <rect x="233" y="280" width="5" height="8" fill="#ff9e80" />
            </svg>
            
            <!-- Engrenages -->
            <svg class="gears" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <!-- Premier engrenage -->
                <circle cx="30" cy="30" r="20" fill="#dbeafe" stroke="#6366f1" stroke-width="2" />
                <circle cx="30" cy="30" r="5" fill="#6366f1" />
                
                <!-- Dents du premier engrenage -->
                <rect x="28" y="0" width="4" height="10" fill="#6366f1" />
                <rect x="28" y="50" width="4" height="10" fill="#6366f1" />
                <rect x="0" y="28" width="10" height="4" fill="#6366f1" />
                <rect x="50" y="28" width="10" height="4" fill="#6366f1" />
                
                <!-- Deuxième engrenage -->
                <circle cx="70" cy="60" r="15" fill="#dbeafe" stroke="#6366f1" stroke-width="2" />
                <circle cx="70" cy="60" r="4" fill="#6366f1" />
                
                <!-- Dents du deuxième engrenage -->
                <rect x="68" y="35" width="4" height="10" fill="#6366f1" />
                <rect x="68" y="75" width="4" height="10" fill="#6366f1" />
                <rect x="45" y="58" width="10" height="4" fill="#6366f1" />
                <rect x="85" y="58" width="10" height="4" fill="#6366f1" />
            </svg>
        </div>
    </div>
</body>
</html>
</file>

<file path="social/add_post.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Ajouter un Post{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <style>
        .post-creation-container {
            max-width: 800px;
            margin: 40px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .post-creation-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .post-creation-header h1 {
            font-size: 28px;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .post-creation-header p {
            color: #6c757d;
            font-size: 16px;
        }

        .post-creation-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .content-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
            resize: vertical;
        }

        .content-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(193, 53, 132, 0.2);
        }

        .image-upload-container {
            border: 2px dashed #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .image-upload-container:hover {
            border-color: var(--primary-color);
            background-color: rgba(193, 53, 132, 0.05);
        }

        .image-upload-container i {
            font-size: 40px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .image-upload-text {
            color: #6c757d;
            margin-bottom: 10px;
        }

        .image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 15px;
            border-radius: 8px;
            display: none;
        }

        .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .publish-btn {
            
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            align-self: flex-end;
        }

        .publish-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(193, 53, 132, 0.3);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: #6c757d;
            text-decoration: none;
            margin-bottom: 20px;
            font-weight: 500;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: var(--primary-color);
        }

        .back-link i {
            margin-right: 5px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container">
    <a href="{{ path('app_social') }}" class="back-link">
        <i class="fas fa-arrow-left"></i> Retour au feed
    </a>

    <div class="post-creation-container">
        <div class="post-creation-header">
            <h1>Créer un nouveau post</h1>
            <p>Partagez vos pensées, photos et plus avec votre communauté</p>
        </div>

        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}

        <form action="{{ path('app_social_add_post') }}" method="post" enctype="multipart/form-data" class="post-creation-form">
            <div class="form-group">
                <label for="content">Qu'avez-vous en tête ?</label>
                <textarea id="content" name="content" class="content-textarea" placeholder="Partagez vos pensées, expériences ou questions..." required></textarea>
            </div>
            
            <div class="form-group">
                <div class="image-upload-container" id="imageUploadContainer">
                    <i class="fas fa-image"></i>
                    <p class="image-upload-text">Cliquez ou glissez-déposez une image ici</p>
                    <p class="image-upload-text small">(Formats acceptés: JPG, PNG, GIF)</p>
                    <img id="imagePreview" class="image-preview" src="#" alt="Aperçu de l'image">
                    <input type="file" id="image_file" name="image_file" class="file-input" accept="image/*">
                </div>
            </div>
            
            <button type="submit" class="publish-btn">
                <i class="fas fa-paper-plane"></i> Publier
            </button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const imageInput = document.getElementById('image_file');
        const imagePreview = document.getElementById('imagePreview');
        const uploadText = document.querySelector('.image-upload-text');
        const uploadIcon = document.querySelector('.image-upload-container i');
        
        imageInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    uploadText.style.display = 'none';
                    uploadIcon.style.display = 'none';
                }
                
                reader.readAsDataURL(this.files[0]);
            }
        });
    });
</script>
{% endblock %}
</file>

<file path="social/edit_post.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Modifier un Post{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <style>
        .post-creation-container {
            max-width: 800px;
            margin: 40px auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .post-creation-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .post-creation-header h1 {
            font-size: 28px;
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .post-creation-header p {
            color: #6c757d;
            font-size: 16px;
        }

        .post-creation-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .content-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
            resize: vertical;
        }

        .content-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(193, 53, 132, 0.2);
        }

        .image-upload-container {
            border: 2px dashed #e9ecef;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .image-upload-container:hover {
            border-color: var(--primary-color);
            background-color: rgba(193, 53, 132, 0.05);
        }

        .image-upload-container i {
            font-size: 40px;
            color: #6c757d;
            margin-bottom: 10px;
        }

        .image-upload-text {
            color: #6c757d;
            margin-bottom: 10px;
        }

        .image-preview {
            max-width: 100%;
            margin-top: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .image-preview img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .publish-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            align-self: flex-end;
        }

        .publish-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(193, 53, 132, 0.3);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: #6c757d;
            text-decoration: none;
            margin-bottom: 20px;
            font-weight: 500;
            transition: color 0.3s;
        }

        .back-link:hover {
            color: var(--primary-color);
        }

        .back-link i {
            margin-right: 5px;
        }
        
        .btn-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .cancel-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .cancel-btn:hover {
            background-color: #5a6268;
            color: white;
            text-decoration: none;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container">
    <a href="{{ path('app_social') }}" class="back-link">
        <i class="fas fa-arrow-left"></i> Retour au feed
    </a>

    <div class="post-creation-container">
        <div class="post-creation-header">
            <h1>Modifier votre post</h1>
            <p>Mettez à jour votre contenu et partagez-le avec votre communauté</p>
        </div>

        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label == 'error' ? 'danger' : label }}">{{ message }}</div>
            {% endfor %}
        {% endfor %}

        <form action="{{ path('app_social_edit_post', {id: post.id}) }}" method="post" enctype="multipart/form-data" class="post-creation-form">
            <div class="form-group">
                <label for="content">Qu'avez-vous en tête ?</label>
                <textarea id="content" name="content" class="content-textarea" placeholder="Partagez vos pensées, expériences ou questions..." required>{{ post.content }}</textarea>
            </div>
            
            {% if post.imagePath %}
            <div class="image-preview">
                <p>Image actuelle :</p>
                <img src="{{ post.imagePath }}" alt="Image du post">
            </div>
            {% endif %}
            
            <div class="image-upload-container">
                <i class="fas fa-cloud-upload-alt"></i>
                <div class="image-upload-text">Glissez et déposez une nouvelle image ou cliquez pour parcourir</div>
                <div class="image-upload-hint">Formats acceptés: JPG, PNG, GIF (max 5MB)</div>
                <input type="file" name="image_file" class="file-input" accept="image/*" id="image_file">
            </div>
            
            <div class="btn-container">
                <a href="{{ path('app_social') }}" class="cancel-btn">
                    <i class="fas fa-times"></i> Annuler
                </a>
                <button type="submit" class="publish-btn">
                    <i class="fas fa-save"></i> Enregistrer les modifications
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    // Afficher le nom du fichier sélectionné
    document.getElementById('image_file').addEventListener('change', function(e) {
        if (e.target.files.length > 0) {
            const fileName = e.target.files[0].name;
            const fileSize = Math.round(e.target.files[0].size / 1024);
            const uploadText = document.querySelector('.image-upload-text');
            uploadText.textContent = `Fichier sélectionné: ${fileName} (${fileSize}KB)`;
        }
    });
</script>
{% endblock %}
</file>

<file path="social/follow_requests.html.twig">
{% extends 'base.html.twig' %}

{% block title %}Demandes de suivi{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Styles personnalisés pour la page de demandes de suivi */
        :root {
            --primary-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-color: #8e2de2;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            --success-gradient: linear-gradient(to right, #00b09b, #96c93d);
            --danger-gradient: linear-gradient(to right, #ff416c, #ff4b2b);
        }
        
        .page-header {
            background: var(--primary-gradient);
            color: white;
            padding: 2.5rem;
            border-radius: 16px;
            margin-bottom: 2.5rem;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        
        .page-header h2 {
            margin: 0;
            font-weight: 700;
            font-size: 2.2rem;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(30deg);
            z-index: 1;
        }
        
        .page-header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 60%;
            height: 100%;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            z-index: 1;
        }
        
        .follow-requests {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }
        
        .follow-request-card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 2rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: none;
            position: relative;
        }
        
        .follow-request-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--hover-shadow);
        }
        
        .follow-request-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: var(--secondary-gradient);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            margin-bottom: 1.8rem;
        }
        
        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-right: 1.5rem;
        }
        
        .user-details h4 {
            margin: 0 0 0.5rem 0;
            font-weight: 700;
            font-size: 1.4rem;
            color: #333;
            letter-spacing: -0.5px;
        }
        
        .user-details p {
            margin: 0 0 0.7rem 0;
            color: #555;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
        }
        
        .user-details p i {
            color: var(--accent-color);
            margin-right: 0.5rem;
        }
        
        .user-details small {
            color: #888;
            font-size: 0.9rem;
        }
        
        .request-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: all 0.4s ease;
            z-index: -1;
        }
        
        .btn:hover::before {
            transform: translateX(0);
        }
        
        .btn i {
            margin-right: 0.7rem;
            font-size: 1.1rem;
        }
        
        .btn-success {
            background: var(--success-gradient);
            border: none;
            box-shadow: 0 4px 15px rgba(0, 176, 155, 0.4);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger-gradient);
            border: none;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
            color: white;
        }
        
        .empty-requests {
            background: white;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 3rem 2rem;
            text-align: center;
            position: relative;
        }
        
        .empty-requests::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: var(--secondary-gradient);
        }
        
        .empty-requests i {
            font-size: 5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
            display: inline-block;
        }
        
        .empty-requests p {
            font-size: 1.5rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        /* Animation pour les boutons */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .btn-success:focus {
            animation: pulse 1s infinite;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .follow-requests {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 1.5rem;
            }
        }
        
        @media (max-width: 768px) {
            .follow-requests {
                grid-template-columns: 1fr;
            }
            
            .page-header {
                padding: 2rem;
                margin-bottom: 2rem;
            }
            
            .page-header h2 {
                font-size: 1.8rem;
            }
            
            .follow-request-card {
                padding: 1.5rem;
            }
            
            .avatar {
                width: 70px;
                height: 70px;
            }
            
            .user-details h4 {
                font-size: 1.2rem;
            }
        }
        
        /* Ajustement pour la navbar */
        .main-content {
            padding-top: 80px;
        }
    </style>
{% endblock %}

{% block body %}
    <!-- Navbar horizontale -->    
    <header class="navbar-social">
        <div class="container-fluid">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <a href="{{ path('app_root') }}">
                        <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                        <span>ConnectSphere</span>
                    </a>
                </div>
                
                <div class="search-container">
                    <div class="search-form">
                        <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                        <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="search-dropdown" id="searchDropdown"></div>
                </div>
                
                <button class="mobile-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="navbar-links">
                    <a href="{{ path('app_root') }}" class="nav-link"><i class="fas fa-home"></i> Home</a>
                    <a href="{{ path('app_social') }}" class="nav-link"><i class="fas fa-users"></i> Feed</a>
                    <a href="{{ path('app_social_follow_requests') }}" class="nav-link active"><i class="fas fa-user-plus"></i> Follow requests</a>
                    <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Jobs</a>
                    <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a>
                </div>
                
                <!-- Ajout de l'icône profil utilisateur avec menu déroulant -->
                <div class="profile-dropdown">
                    <div class="dropdown-toggle">
                        <img src="{{ asset('images/profile-modified.png') }}" alt="Photo par défaut" class="profile-img">
                        <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                    </div>
                    <div class="dropdown-menu">
                        <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                            <i class="fas fa-user"></i> Mon profil
                        </a>
                        <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Demandes de suivi
                            <span class="badge badge-danger ml-2">{{ pendingRequestsCount|default(0) }}</span>
                        </a>
                        
                        <div class="dropdown-divider"></div>
                        <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Contenu principal -->
    <div class="main-content">
        <div class="container">
            {% for message in app.flashes('success') %}
                <div class="alert alert-success">{{ message }}</div>
            {% endfor %}
            
            {% for message in app.flashes('error') %}
                <div class="alert alert-danger">{{ message }}</div>
            {% endfor %}
            
            <div class="page-header">
                <h2><i class="fas fa-user-plus mr-2"></i> Demandes de suivi en attente</h2>
                {% if pendingRequestsCount > 0 %}
                    <span class="badge badge-pill badge-light ml-3" style="font-size: 1rem; padding: 0.5rem 1rem; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                        {{ pendingRequestsCount }} {{ pendingRequestsCount > 1 ? 'demandes' : 'demande' }}
                    </span>
                {% endif %}
            </div>
            
            {% if pendingRequests|length > 0 %}
                <div class="follow-requests">
                    {% for request in pendingRequests %}
                        <div class="follow-request-card">
                            <div class="user-info">
                                <img src="{{ asset('images/default-avatar.png') }}" alt="Avatar" class="avatar">
                                <div class="user-details">                                    <h4>{{ request.getFollower().getUsername() }}</h4>
                                    <p><i class="fas fa-envelope"></i> {{ request.getFollower().getEmail() }}</p>
                                    <small>Demande envoyée le {{ request.getCreatedAt()|date('d/m/Y') }}</small>
                                </div>
                            </div>
                            <div class="request-actions">
                                <a href="{{ path('app_social_follow_request', {'id': request.id, 'action': 'accept'}) }}" class="btn btn-success">
                                    <i class="fas fa-check"></i> Accepter
                                </a>
                                <a href="{{ path('app_social_follow_request', {'id': request.id, 'action': 'reject'}) }}" class="btn btn-danger">
                                    <i class="fas fa-times"></i> Refuser
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-requests">
                    <i class="far fa-bell-slash"></i>
                    <p>Vous n'avez aucune demande de suivi en attente.</p>
                    <small class="mt-3 d-block text-muted">Les demandes apparaîtront ici lorsque d'autres utilisateurs souhaiteront vous suivre</small>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Gestion du menu déroulant du profil
            const profileDropdown = document.querySelector('.profile-dropdown');
            const dropdownToggle = profileDropdown.querySelector('.dropdown-toggle');
            const dropdownMenu = profileDropdown.querySelector('.dropdown-menu');
            
            dropdownToggle.addEventListener('click', function() {
                dropdownMenu.classList.toggle('show');
            });
            
            // Fermer le menu déroulant lorsqu'on clique ailleurs sur la page
            document.addEventListener('click', function(event) {
                if (!profileDropdown.contains(event.target)) {
                    dropdownMenu.classList.remove('show');
                }
            });
            
            // Gestion du menu mobile
            const mobileToggle = document.querySelector('.mobile-toggle');
            const navbarLinks = document.querySelector('.navbar-links');
            
            mobileToggle.addEventListener('click', function() {
                mobileToggle.classList.toggle('active');
                navbarLinks.classList.toggle('show');
            });
            
            // Gestion de la recherche
            const searchInput = document.getElementById('searchInput');
            const searchDropdown = document.getElementById('searchDropdown');
            
            searchInput.addEventListener('focus', function() {
                searchDropdown.classList.add('active');
            });
            
            searchInput.addEventListener('blur', function() {
                setTimeout(function() {
                    searchDropdown.classList.remove('active');
                }, 200);
            });
        });
    </script>
{% endblock %}
</file>

<file path="social/group_profile.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Groupe - Connect Sphere</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    
    <!-- jQuery et Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<!-- Navbar horizontale -->    
<header class="navbar-social">
    <div class="container-fluid">
        <div class="navbar-content">
            <div class="navbar-brand">
                <a href="{{ path('app_root') }}">
                    <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                </a>
            </div>
            <div class="search-container">
                    <div class="search-form">
                        <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                        <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="search-dropdown" id="searchDropdown"></div>
                </div>
         
            
            <button class="mobile-toggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <div class="navbar-links">
                <a href="{{ path('app_root') }}" class="nav-link"><i class="fas fa-home"></i> Home</a>
                <a href="{{ path('app_social') }}" class="nav-link"><i class="fas fa-users"></i> Feed</a>
                <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Jobs</a>
                <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a>
            </div>
            
            <!-- Ajout de l'icône profil utilisateur avec menu déroulant -->
            <div class="profile-dropdown">
                <div class="dropdown-toggle">
                    <img src="{{ asset('images/profile-modified.png') }}" alt="Photo par défaut" class="profile-img">
                    <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                </div>
                <div class="dropdown-menu">
                    <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                        <i class="fas fa-user"></i> Mon profil
                    </a>
                    <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                        <i class="fas fa-user-plus"></i> Demandes de suivi
                        <span class="badge badge-danger ml-2">{{ pendingRequestsCount|default(0) }}</span>
                    </a>
                    
                    <div class="dropdown-divider"></div>
                    <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                        <i class="fas fa-sign-out-alt"></i> Déconnexion
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<div class="main-content">
    <div class="container">
        <style>
            /* Styles pour le contenu principal avec la navbar */
            .main-content {
                padding-top: 80px; /* Espace pour la navbar fixe */
                min-height: 100vh;
                background-color: #f8f9fa;
            }
            
            .container {
                max-width: 1140px;
                margin: 0 auto;
                padding: 20px 15px;
            }
            
            /* Styles pour les états de membre */
            .member-status {
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .badge {
                padding: 8px 12px;
                font-size: 14px;
                border-radius: 4px;
                display: inline-flex;
                align-items: center;
                gap: 5px;
            }
            
            .badge-success {
                background-color: #28a745;
                color: white;
            }
            
            .badge-warning {
                background-color: #ffc107;
                color: #212529;
            }
            
            .btn-outline-danger {
                color: #dc3545;
                border-color: #dc3545;
                background-color: transparent;
                transition: all 0.3s ease;
            }
            
            .btn-outline-danger:hover {
                color: white;
                background-color: #dc3545;
            }
            
            .btn-outline-secondary {
                color: #6c757d;
                border-color: #6c757d;
                background-color: transparent;
                transition: all 0.3s ease;
            }
            
            .btn-outline-secondary:hover {
                color: white;
                background-color: #6c757d;
            }
            
            .btn-sm {
                padding: 0.25rem 0.5rem;
                font-size: 0.875rem;
                line-height: 1.5;
                border-radius: 0.2rem;
            }
            
            .ml-2 {
                margin-left: 0.5rem;
            }
            
            /* Responsive */
            @media (max-width: 768px) {
                .main-content {
                    padding-top: 60px; /* Ajustement pour les écrans plus petits */
                }
                
                .member-status {
                    flex-direction: column;
                    align-items: flex-start;
                }
                
                .ml-2 {
                    margin-left: 0;
                    margin-top: 0.5rem;
                }
            }
        </style>
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}
        
        <div class="feed-header">
            <h1>Groupe: {{ group.name }}</h1>
           
            <a href="{{ path('app_social') }}" class="btn btn-primary">
                <i class="fas fa-arrow-left"></i> Retour au Feed
            </a>
        </div>
        
        <!-- Profil du groupe -->
        <div class="group-profile-card">
            <div class="profile-header">
                <div class="profile-avatar">
                    <img src="/uploads/images/default-group.png" alt="{{ group.name }}">
                </div>
                <div class="profile-info">
                    <h2>{{ group.name }}</h2>
                    <p class="profile-description">{{ group.description }}</p>
                </div>
            </div>
            <div class="profile-actions">
                {% if isMember is defined and isMember %}
                    <div class="member-status">
                        <span class="badge badge-success">
                            <i class="fas fa-check-circle"></i> Vous êtes membre
                        </span>
                        <form action="{{ path('app_social_leave_group', {id: group.id}) }}" method="post" class="ml-2">
                            <button type="submit" class="btn btn-outline-danger btn-sm">
                                <i class="fas fa-sign-out-alt"></i> Quitter le groupe
                            </button>
                        </form>
                    </div>
                {% elseif isPending is defined and isPending %}
                    <div class="member-status">
                        <span class="badge badge-warning">
                            <i class="fas fa-clock"></i> Demande en attente
                        </span>
                        <form action="{{ path('app_social_cancel_join_group', {id: group.id}) }}" method="post" class="ml-2">
                            <button type="submit" class="btn btn-outline-secondary btn-sm">
                                <i class="fas fa-times"></i> Annuler la demande
                            </button>
                        </form>
                    </div>
                {% else %}
                    <form action="{{ path('app_social_join_group', {id: group.id}) }}" method="post">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> Rejoindre le groupe
                        </button>
                    </form>
                {% endif %}
            </div>
        </div>
        
        <!-- Formulaire d'ajout de post pour le groupe -->
        <div class="add-post-section">
            <h3>Ajouter une publication au groupe</h3>
            <form action="{{ path('app_social_group_add_post', {id: group.id}) }}" method="post" enctype="multipart/form-data" class="add-post-form">
                <textarea name="content" placeholder="Partagez quelque chose avec le groupe..." required></textarea>
                <div class="form-actions">
                    <div class="file-input-wrapper">
                        <label for="image_file" class="file-label">
                            <i class="fas fa-image"></i> Ajouter une image
                        </label>
                        <input type="file" id="image_file" name="image_file" accept="image/*" class="file-input">
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Publier
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Publications du groupe -->
        <div class="group-posts-section">
            <h2>Publications du groupe</h2>
            
            {% if posts|length > 0 %}
                <div class="feed-grid">
                    {% for post in posts %}
                        <article class="post-card-grid">
                            <div class="post-header-simple">
                                <div class="user-info">                                    <span class="username">{{ post.user.username }}</span>
                                    <span class="post-date">{{ post.post.timestamp|date('d M Y H:i') }}</span>
                                </div>
                                {% if currentUser and post.user.id == currentUser.id %}
                                    <div class="post-options dropdown">
                                        <button class="btn-icon" type="button" data-toggle="dropdown">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="{{ path('app_social_edit_post', {id: post.post.id}) }}" class="dropdown-item">
                                                <i class="fas fa-edit"></i> Modifier
                                            </a>
                                            <a href="{{ path('app_social_delete_post', {id: post.post.id}) }}" class="dropdown-item text-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce post?')">
                                                <i class="fas fa-trash"></i> Supprimer
                                            </a>
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="post-content-simple">
                                {% if post.post.mediaUrl %}
                                    <img src="{{ post.post.mediaUrl }}" alt="Image du post" class="post-image-grid">
                                {% endif %}
                                <div class="post-text-content">{{ post.post.content }}</div>
                            </div>
                            <div class="post-actions-simple">
                                <div class="action-buttons">
                                    <form action="{{ path('app_social_like_post', {id: post.post.id}) }}" method="post" class="like-form">
                                        <button type="submit" class="btn-icon {% if post.userLiked %}active{% endif %}">
                                            <i class="{% if post.userLiked %}fas{% else %}far{% endif %} fa-heart"></i>
                                        </button>
                                    </form>
                                    <a href="#comments-{{ post.post.id }}" class="btn-icon">
                                        <i class="far fa-comment"></i>
                                    </a>
                                </div>
                                <div class="post-stats">
                                    <div class="like-stat">{{ post.likeCount }} J'aime</div>
                                    <div class="comment-stat">{{ post.comments|length }} Commentaires</div>
                                </div>
                                
                                <div class="comments-section" id="comments-{{ post.post.id }}">
                                    <div class="comments-list">
                                        {% for comment in post.comments %}
                                            <div class="comment">
                                                <strong>{{ comment.userId.username }}</strong>
                                                <span>{{ comment.content }}</span>
                                                <small class="comment-date">{{ comment.createdAt|date('d M Y H:i') }}</small>
                                            </div>
                                        {% endfor %}
                                    </div>
                                    
                                    <form action="{{ path('app_social_add_comment', {id: post.post.id}) }}" method="post" class="comment-form">
                                        <input type="text" name="content" placeholder="Ajouter un commentaire..." required>
                                        <button type="submit" class="btn btn-primary btn-sm">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-feed">
                    <i class="far fa-sad-tear fa-3x"></i>
                    <p>Aucune publication dans ce groupe pour le moment.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<script src="{{ asset('js/social-share.js') }}"></script>
<script src="{{ asset('js/search-dropdown.js') }}"></script>
<script>
    // Gestion du menu mobile
    document.querySelector('.mobile-toggle').addEventListener('click', function() {
        document.querySelector('.navbar-links').classList.toggle('active');
    });
    
    // Gestion du dropdown profil
    document.querySelector('.profile-dropdown .dropdown-toggle').addEventListener('click', function(e) {
        e.stopPropagation();
        document.querySelector('.profile-dropdown .dropdown-menu').classList.toggle('show');
    });
    
    // Empêcher la fermeture du dropdown quand on clique sur un élément du menu
    document.querySelector('.profile-dropdown .dropdown-menu').addEventListener('click', function(e) {
        e.stopPropagation();
    });
    
    // Fermer le dropdown quand on clique ailleurs sur la page
    document.addEventListener('click', function() {
        document.querySelector('.profile-dropdown .dropdown-menu').classList.remove('show');
    });
    
    // Fermer automatiquement les alertes après 5 secondes
    setTimeout(function() {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(function(alert) {
            alert.style.opacity = '0';
            setTimeout(function() {
                alert.style.display = 'none';
            }, 500);
        });
    }, 5000);
</script>
</body>
</html>
</file>

<file path="social/notifications.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications - ConnectSphere</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    
    <!-- jQuery et Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <style>
        /* Styles personnalisés pour la page de notifications */
        :root {
            --primary-gradient: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-color: #8e2de2;
            --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            --success-gradient: linear-gradient(to right, #00b09b, #96c93d);
            --danger-gradient: linear-gradient(to right, #ff416c, #ff4b2b);
        }
        
        .page-header {
            background: var(--primary-gradient);
            color: white;
            padding: 2.5rem;
            border-radius: 16px;
            margin-bottom: 2.5rem;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        
        .page-header h2 {
            margin: 0;
            font-weight: 700;
            font-size: 2.2rem;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(30deg);
            z-index: 1;
        }
        
        .page-header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -10%;
            width: 60%;
            height: 100%;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            z-index: 1;
        }
        
        .notifications-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .notification-card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 1.5rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: none;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            align-items: center;
        }
        
        .notification-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
        }
        
        .notification-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.5rem;
            flex-shrink: 0;
        }
        
        .notification-icon.follow-accepted {
            background: var(--success-gradient);
            color: white;
        }
        
        .notification-icon.follow-rejected {
            background: var(--danger-gradient);
            color: white;
        }
        
        .notification-icon.group-accepted {
            background: linear-gradient(to right, #4facfe, #00f2fe);
            color: white;
        }
        
        .notification-icon.group-rejected {
            background: linear-gradient(to right, #f83600, #f9d423);
            color: white;
        }
        
        .notification-content {
            flex-grow: 1;
        }
        
        .notification-message {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .notification-time {
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .notification-link {
            margin-left: auto;
            padding-left: 1rem;
        }
        
        .notification-link a {
            color: var(--accent-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .notification-link a:hover {
            color: #6a11cb;
        }
        
        .empty-notifications {
            text-align: center;
            padding: 3rem;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
        }
        
        .empty-notifications i {
            font-size: 4rem;
            color: #adb5bd;
            margin-bottom: 1.5rem;
        }
        
        .empty-notifications p {
            font-size: 1.2rem;
            color: #6c757d;
        }
        
        @media (max-width: 768px) {
            .page-header {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }
            
            .page-header h2 {
                font-size: 1.8rem;
            }
            
            .notification-card {
                padding: 1rem;
            }
            
            .notification-icon {
                width: 40px;
                height: 40px;
                margin-right: 1rem;
            }
            
            .notification-message {
                font-size: 0.9rem;
            }
        }
    </style>
    
    <script>
        $(document).ready(function() {
            // Gestion du dropdown profil
            $(".profile-dropdown .dropdown-toggle").on("click", function(e) {
                e.preventDefault();
                e.stopPropagation();
                $(this).parent().find(".dropdown-menu").toggleClass("show");
            });
            
            // Fermer le dropdown quand on clique ailleurs
            $(document).on("click", function(e) {
                if (!$(e.target).closest(".profile-dropdown").length) {
                    $(".dropdown-menu").removeClass("show");
                }
            });
            
            // Empêcher la fermeture du menu lors du clic sur les éléments du menu
            $(".dropdown-menu").on("click", ".dropdown-item", function(e) {
                e.stopPropagation();
            });
        });
    </script>
</head>
<body>
    <!-- Navbar horizontale -->    
    <header class="navbar-social">
        <div class="container-fluid">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <a href="{{ path('app_root') }}">
                        <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                        <span>ConnectSphere</span>
                    </a>
                </div>
                
                <div class="search-container">
                    <div class="search-form">
                        <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                        <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="search-dropdown" id="searchDropdown"></div>
                </div>
                
                <button class="mobile-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="navbar-links">
                    <a href="{{ path('app_root') }}" class="nav-link"><i class="fas fa-home"></i> Accueil</a>
                    <a href="{{ path('app_social') }}" class="nav-link active"><i class="fas fa-users"></i> Social</a>
                    <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Emplois</a>
                    <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Événements</a>
                </div>
                
                <!-- Ajout de l'icône profil utilisateur avec menu déroulant -->
                <div class="profile-dropdown">
                    <div class="dropdown-toggle">
                        <img src="{{ asset('images/profile-modified.png') }}" alt="Photo par défaut" class="profile-img">
                        <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                    </div>
                    <div class="dropdown-menu">
                        <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                            <i class="fas fa-user"></i> Mon profil
                        </a>
                        <a href="{{ path('app_social_notifications') }}" class="dropdown-item">
                            <i class="fas fa-bell"></i> Notifications
                            {% if unreadNotificationsCount > 0 %}
                                <span class="badge badge-danger ml-2">{{ unreadNotificationsCount }}</span>
                            {% endif %}
                        </a>
                        <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Demandes de suivi
                            {% if pendingRequestsCount > 0 %}
                                <span class="badge badge-danger ml-2">{{ pendingRequestsCount }}</span>
                            {% endif %}
                        </a>
                        
                        <div class="dropdown-divider"></div>
                        <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Contenu principal -->
    <div class="main-content">
        <div class="container">
            <!-- Alertes -->
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            {% endfor %}
            
            <!-- En-tête de la page -->
            <div class="page-header">
                <h2>
                    <i class="fas fa-bell"></i> Vos notifications
                </h2>
            </div>
            
            <!-- Liste des notifications -->
            <div class="notifications-list">
                {% if notifications|length > 0 %}
                    {% for notification in notifications %}
                        <div class="notification-card">
                            {% if notification.type == 'follow_request_accepted' %}
                                <div class="notification-icon follow-accepted">
                                    <i class="fas fa-user-check"></i>
                                </div>
                            {% elseif notification.type == 'follow_request_rejected' %}
                                <div class="notification-icon follow-rejected">
                                    <i class="fas fa-user-times"></i>
                                </div>
                            {% elseif notification.type == 'group_request_accepted' %}
                                <div class="notification-icon group-accepted">
                                    <i class="fas fa-users"></i>
                                </div>
                            {% elseif notification.type == 'group_request_rejected' %}
                                <div class="notification-icon group-rejected">
                                    <i class="fas fa-users-slash"></i>
                                </div>
                            {% else %}
                                <div class="notification-icon">
                                    <i class="fas fa-bell"></i>
                                </div>
                            {% endif %}
                            
                            <div class="notification-content">
                                <div class="notification-message">{{ notification.message }}</div>
                                <div class="notification-time">{{ notification.createdAt|date('d/m/Y à H:i') }}</div>
                            </div>
                            
                            {% if notification.link %}
                                <div class="notification-link">
                                    <a href="{{ notification.link }}">
                                        <i class="fas fa-external-link-alt"></i> Voir
                                    </a>
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-notifications">
                        <i class="far fa-bell-slash"></i>
                        <p>Vous n'avez pas de notifications pour le moment.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>
</file>

<file path="social/search_results.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Résultats de recherche - ConnectSphere</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    
    <!-- jQuery et Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <!-- Navbar horizontale -->    
    <header class="navbar-social">
        <div class="container-fluid">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <a href="{{ path('app_root') }}">
                        <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                        <span>ConnectSphere</span>
                    </a>
                </div>
                
                <div class="search-container">
                    <div class="search-form">
                        <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                        <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="search-dropdown" id="searchDropdown"></div>
                </div>
                
                <button class="mobile-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="navbar-links">
                    <a href="{{ path('app_root') }}" class="nav-link"><i class="fas fa-home"></i> Home</a>
                    <a href="{{ path('app_social') }}" class="nav-link active"><i class="fas fa-users"></i> Feed</a>
                    <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Jobs</a>
                    <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a>
                </div>
                
                <div class="profile-dropdown">
                    <div class="dropdown-toggle">
                        <img src="{{ asset('images/profile-modified.png') }}" alt="Photo par défaut" class="profile-img">
                        <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                    </div>
                    <div class="dropdown-menu">
                        <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                            <i class="fas fa-user"></i> Mon profil
                        </a>
                        <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Demandes de suivi
                            <span class="badge badge-danger ml-2">{{ follow_requests_count|default(0) }}</span>
                        </a>
                        <a href="{{ path('app_social_notifications') }}" class="dropdown-item">
                            <i class="fas fa-bell"></i> Notifications
                            <span class="badge badge-danger ml-2">{{ notifications_count|default(0) }}</span>
                        </a>
                        
                        <div class="dropdown-divider"></div>
                        <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

<!-- Main Content -->
<div class="main-content">
    <div class="container">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                    <span class="alert-icon">
                        {% if label == 'success' %}
                            <i class="fas fa-check-circle"></i>
                        {% elseif label == 'danger' %}
                            <i class="fas fa-exclamation-circle"></i>
                        {% elseif label == 'warning' %}
                            <i class="fas fa-exclamation-triangle"></i>
                        {% elseif label == 'info' %}
                            <i class="fas fa-info-circle"></i>
                        {% endif %}
                    </span>
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endfor %}
        {% endfor %}

        <div class="feed-header mt-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="mb-0">Résultats de recherche</h1>
            </div>
        </div>
        
        {% if results is defined and results is not empty and (results.users is not empty or results.groups is not empty) %}
            <div class="feed-grid">
                {% if results.users is defined and results.users is not empty %}
                    <div class="section-title mb-4">
                        <h2>Utilisateurs</h2>
                    </div>
                    {% for user in results.users %}
                        <article class="post-card-grid mb-4">
                            <div class="post-header-simple d-flex align-items-center">
                                <div class="user-avatar mr-3">
                                    <img src="{{ asset('images/profile-modified.png') }}" alt="{{ user.username }}" class="rounded-circle" style="width: 50px; height: 50px;">
                                </div>
                                <div class="user-info">
                                    <h3 class="mb-1 username">{{ user.username }}</h3>
                                    <p class="text-muted mb-0 post-date">{{ user.email }}</p>
                                </div>
                                <div class="ml-auto">
                                    <a href="{{ path('app_social_user_profile', {id: user.id}) }}" class="btn btn-primary">
                                        <i class="fas fa-user"></i> Voir le profil
                                    </a>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                {% endif %}
                
                {% if results.groups is defined and results.groups is not empty %}
                    <div class="section-title mb-4 mt-5">
                        <h2>Groupes</h2>
                    </div>
                    {% for group in results.groups %}
                        <article class="post-card-grid mb-4">
                            <div class="post-header-simple d-flex align-items-center">
                                <div class="group-avatar mr-3">
                                    <img src="{{ group.profilePicture }}" alt="{{ group.name }}" class="rounded-circle" style="width: 50px; height: 50px;">
                                </div>
                                <div class="group-info">
                                    <h3 class="mb-1 username">{{ group.name }}</h3>
                                    <p class="text-muted mb-0 post-date">{{ group.description }}</p>
                                </div>
                                <div class="ml-auto">
                                    <a href="{{ path('app_social_group_profile', {id: group.id}) }}" class="btn btn-primary">
                                        <i class="fas fa-users"></i> Voir le groupe
                                    </a>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                {% endif %}
            </div>
        {% else %}
            <div class="empty-feed text-center py-5">
                {% if results.searchTerm is defined and results.searchTerm is not empty %}
                    <i class="fas fa-search fa-4x text-muted mb-3"></i>
                    <h3 class="mb-3">Aucun résultat trouvé pour "{{ results.searchTerm }}"</h3>
                    <p class="text-muted">Essayez avec d'autres termes de recherche</p>
                {% else %}
                    <i class="fas fa-search fa-4x text-muted mb-3"></i>
                    <h3 class="mb-3">Commencez votre recherche</h3>
                    <p class="text-muted">Utilisez la barre de recherche ci-dessus pour trouver des utilisateurs et des groupes</p>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>

<!-- Script pour la recherche en temps réel -->
<script src="{{ asset('js/search-dropdown.js') }}"></script>
</body>
</html>
</file>

<file path="social/social.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConnectSphere</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    
    <!-- jQuery et Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Styles personnalisés pour les alertes -->
    <style>
        /* Styles personnalisés pour les alertes */
        .alert {
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 15px;
        }
        
        .alert-success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        
        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffeeba;
            color: #856404;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        
        .alert .close {
            position: absolute;
            top: 0;
            right: 0;
            padding: 0.75rem 1.25rem;
            color: inherit;
            opacity: 0.5;
        }
        
        .alert .close:hover {
            opacity: 1;
        }
        
        /* Styles pour le badge de notification */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -10px;
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        
        /* Styles pour la barre de recherche */
        .search-container {
            display: flex;
            align-items: center;
            max-width: 500px;
            width: 100%;
        }
        
        .search-box {
            background-color: #f5f5f5;
            border-radius: 4px 0 0 4px;
            padding: 8px 12px;
            flex-grow: 1;
            border: 1px solid #e6e6e6;
            border-right: none;
        }
        
        .search-input {
            border: none;
            background: transparent;
            width: 100%;
            font-size: 14px;
            outline: none;
        }
        
        .location-box {
            background-color: #f5f5f5;
            padding: 8px 12px;
            border: 1px solid #e6e6e6;
            border-left: 1px solid #e6e6e6;
            border-right: none;
        }
        
        .location-input {
            border: none;
            background: transparent;
            width: 100%;
            font-size: 14px;
            outline: none;
        }
        
        .search-button {
            background-color: #f64060;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            padding: 9px 16px;
            cursor: pointer;
            height: 38px;
        }
        
        /* Styles pour les boutons d'action */
        .btn-primary {
            background-color: var(--primary-color, #c13584);
            border-color: var(--primary-color, #c13584);
            font-weight: 500;
            font-size: 14px;
            padding: 8px 16px;
            border-radius: 4px;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-color, #c13584);
            border-color: var(--primary-color, #c13584);
            opacity: 0.9;
        }
        
        
        
        /* Style pour le bouton de déconnexion */
        .logout-link {
            color: #e74c3c !important;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .logout-link:hover {
            background-color: rgba(231, 76, 60, 0.1);
            color: #e74c3c !important;
        }
        
        /* Styles pour la sidebar */
        .sidebar {
            width: 220px;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            background: linear-gradient(180deg, var(--sidebar-gradient-start, #22005a) 0%, var(--sidebar-gradient-end, #5b21b6) 100%);
            color: white;
            padding: 20px 8px;
            display: flex;
            flex-direction: column;
            gap: 30px;
            box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 0 20px 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar-header h2 {
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: 700;
            text-align: center;
        }
        
        .sidebar-profile {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .sidebar-profile img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 10px;
            background: #FFFFFF;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
            flex-grow: 1;
        }
        
        .sidebar-menu li {
            margin: 10px 0;
        }
        
        .sidebar-menu a {
            display: flex;
            align-items: center;
            color: #FFFFFF;
            text-decoration: none;
            font-size: 16px;
            font-weight: 500;
            padding: 12px 15px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }
        
        .sidebar-menu a i {
            margin-right: 10px;
        }
        
        .sidebar-menu a:hover, .sidebar-menu .active a {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Bouton menu mobile */
        .mobile-toggle {
            display: none;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 10px;
            z-index: 1031;
        }
        
        .mobile-toggle span {
            display: block;
            width: 25px;
            height: 3px;
            background-color: white;
            margin: 5px 0;
            border-radius: 3px;
            transition: all 0.3s ease;
            transform-origin: center;
        }
        
        .mobile-toggle.active span:nth-child(1) {
            transform: translateY(8px) rotate(45deg);
        }
        
        .mobile-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        
        .mobile-toggle.active span:nth-child(3) {
            transform: translateY(-8px) rotate(-45deg);
        }
        
        /* Menu principal */
        .main-menu-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-grow: 1;
        }
        
        .main-menu {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        .menu-item {
            margin: 0 5px;
            position: relative;
        }
        
        .menu-link {
            display: flex;
            align-items: center;
            color: #212121;
            text-decoration: none;
            padding: 8px 15px;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 14px;
        }
        
        .menu-link:hover, .menu-item.active .menu-link {
            color: #f64060;
            text-decoration: none;
        }
        
        .menu-icon {
            margin-right: 8px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Menu secondaire */
        .secondary-menu {
            display: flex;
            align-items: center;
        }
        
        
        
        .notification-item .menu-link:hover {
            color: #f64060;
        }
        
        .notification-item .menu-icon {
            margin: 0;
        }
        
        .notification-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #f64060;
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        /* Profil utilisateur */
        .profile-item {
            margin-left: 10px;
        }
        
        .profile-item .menu-link {
            padding: 5px 10px;
        }
        
        .profile-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 8px;
        }
        
        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .profile-name {
            font-weight: 500;
            max-width: 120px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Styles pour le menu déroulant du profil */
        .profile-dropdown {
            position: relative;
            cursor: pointer;
        }
        
        .profile-dropdown .dropdown-toggle {
            display: flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .profile-dropdown .dropdown-toggle:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .profile-dropdown .profile-img {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .profile-dropdown .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            z-index: 1000;
            display: none;
            min-width: 200px;
            padding: 8px 0;
            margin: 0.125rem 0 0;
            background-color: #fff;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .profile-dropdown .dropdown-menu.show {
            display: block;
        }
        
        .navbar-spacer {
            height: 80px; /* Ajuster selon la hauteur de votre navbar */
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .modern-header .container {
                max-width: 95%;
            }
            
            .main-content .container {
                max-width: 95%;
            }
        }
        
        /* Styles pour le menu mobile */
        @media (max-width: 991.98px) {
            .search-container {
                display: none;
            }
            
            .action-button, .free-trial {
                display: none !important;
            }
            
            .mobile-toggle {
                display: block;
            }
            
            .main-menu-container {
                flex-direction: column;
                align-items: flex-start;
                width: 100%;
                padding-top: 15px;
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.5s ease;
            }
            
            .main-menu-container.show {
                max-height: 500px;
            }
            
            .main-menu {
                flex-direction: column;
                width: 100%;
            }
            
            .menu-item {
                margin: 5px 0;
                width: 100%;
            }
            
            .secondary-menu {
                margin-top: 15px;
                width: 100%;
                justify-content: flex-end;
            }
            
            .profile-name {
                display: inline-block !important;
            }
            
            .feed-header .d-flex {
                flex-wrap: wrap;
            }
            
            .feed-header h1 {
                margin-bottom: 10px;
            }
        }
        
        @media (max-width: 767.98px) {
            .container {
                padding: 0 15px;
            }
            
            .logo-icon {
                width: 70px;
            }
            
            .notification-item .menu-link {
                width: 32px;
                height: 32px;
                margin: 0 3px;
            }
            
            .mobile-menu {
                display: none;
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                background: white;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                padding: 1rem 0;
                z-index: 1029;
            }
            
            .mobile-menu.show {
                display: block;
            }
            
            .mobile-search {
                padding: 0 15px;
                margin-bottom: 15px;
            }
            
            .mobile-nav {
                display: flex;
                flex-direction: column;
            }
            
            .mobile-nav-item {
                padding: 12px 15px;
                color: #212121;
                text-decoration: none;
                border-bottom: 1px solid #f5f5f5;
                font-size: 14px;
                transition: all 0.2s ease;
            }
            
            .mobile-nav-item:hover, .mobile-nav-item.active {
                background-color: #f9f9f9;
                color: #f64060;
                text-decoration: none;
            }
            
            .mobile-nav-item.btn {
                margin: 15px;
                border: none;
            }
        }
        
        @media (max-width: 575.98px) {
            .logo-icon {
                width: 60px;
            }
            
            .notification-item .menu-link {
                width: 28px;
                height: 28px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 768px) {
            .navbar-spacer {
                height: 70px;
            }
            
            .modern-header {
                padding: 0.6rem 0;
            }
            
            .logo-text {
                font-size: 1.3rem;
            }
            
            .feed-grid {
                display: block;
            }
            
            .post-card-grid {
                width: 100%;
                margin-bottom: 20px;
            }
        }
        
        @media (max-width: 576px) {
            .search-form {
                flex-direction: column;
            }
            
            .search-input {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .logo-icon {
                width: 35px;
                height: 35px;
            }
            
            .logo-text {
                font-size: 1.2rem;
            }
            
            .navbar-spacer {
                height: 60px;
            }
        }
        
        /* Ajustements pour le contenu principal */
        body {
            background-color: #e9e9e9;
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            display: block;
        }
        
        .main-content {
            flex: 1;
            margin-left: 220px;
            padding: 20px;
        }
        
        .main-content .container {
            max-width: 1140px;
            margin: 0 auto;
        }
        
        /* Style pour la navbar */
        .navbar-dark.bg-primary {
            background: linear-gradient(90deg, var(--sidebar-gradient-start, #22005a) 0%, var(--sidebar-gradient-end, #5b21b6) 100%) !important;
        }
        
        .dropdown-menu {
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: none;
            padding: 8px 0;
        }
        
        .dropdown-item {
            padding: 8px 20px;
            font-size: 14px;
        }
        
        .dropdown-item i {
            margin-right: 8px;
            width: 20px;
            text-align: center;
        }
        
        /* Styles pour le menu déroulant des options de post */
        .post-options {
            cursor: pointer;
            position: relative;
        }
        
        .dropdown-menu {
            min-width: 180px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .dropdown-item {
            padding: 8px 15px;
            display: flex;
            align-items: center;
        }
        
        .dropdown-item:hover {
            background-color: #f8f9fa;
        }
        
        .dropdown-item.text-danger:hover {
            background-color: #fff5f5;
        }
    </style>
    
    <!-- Scripts pour l'interface dynamique -->
    <script>
        $(document).ready(function() {
            // Faire disparaître les alertes après 5 secondes
            setTimeout(function() {
                $(".alert").fadeOut("slow");
            }, 5000);
            
            // Permettre la fermeture manuelle des alertes
            $(".alert .close").on("click", function() {
                $(this).parent().fadeOut("slow");
            });
            
            // Gestion du menu mobile
            $(".mobile-toggle").on("click", function() {
                $(".navbar-links").toggleClass("show");
                $(this).toggleClass("active");
            });
            
            // Ajustement dynamique en fonction de la taille de l'écran
            function adjustLayout() {
                if (window.innerWidth <= 768) {
                    $(".feed-grid").css("display", "block");
                    $(".post-card-grid").css("width", "100%");
                } else {
                    $(".feed-grid").css("display", "");
                    $(".post-card-grid").css("width", "");
                }
            }
            
            // Exécuter au chargement et au redimensionnement
            adjustLayout();
            $(window).resize(function() {
                adjustLayout();
            });
            
            // Gestion du dropdown profil
            $(".profile-dropdown .dropdown-toggle").on("click", function(e) {
                e.preventDefault();
                e.stopPropagation();
                $(this).parent().find(".dropdown-menu").toggleClass("show");
            });
            
            // Fermer le dropdown quand on clique ailleurs
            $(document).on("click", function(e) {
                if (!$(e.target).closest(".profile-dropdown").length) {
                    $(".dropdown-menu").removeClass("show");
                }
            });
            
            // Empêcher la fermeture du menu lors du clic sur les éléments du menu
            $(".dropdown-menu").on("click", ".dropdown-item", function(e) {
                e.stopPropagation();
            });
        });
    </script>
</head>
<body>
    <!-- Navbar horizontale -->    
    <header class="navbar-social">
        <div class="container-fluid">
            <div class="navbar-content">
                <div class="navbar-brand">
                    <a href="">
                        <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                        <span>ConnectSphere</span>
                    </a>
                </div>
                
                <div class="search-container">
                    <div class="search-form">
                        <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                        <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <div class="search-dropdown" id="searchDropdown"></div>
                </div>
                
                <button class="mobile-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <div class="navbar-links">
                     <a href="{{ path('app_home') }}" class="nav-link"><i class="fas fa-briefcase"></i>Home</a>
                    <a href="{{ path('app_social') }}" class="nav-link active"><i class="fas fa-users"></i> Feed</a>
                    <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Jobs</a>
                    <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a>
                    
                </div>
                
                <!-- Ajout de l'icône profil utilisateur avec menu déroulant -->
                <div class="profile-dropdown">
                    <div class="dropdown-toggle">
                        <img src="{{ asset('images/profile-modified.png') }}" alt="Photo par défaut" class="profile-img">
                        <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                    </div>
                    <div class="dropdown-menu">
                        <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                            <i class="fas fa-user"></i> Social Feed
                        </a>
                        <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Follow requests
                            <span class="badge badge-danger ml-2">{{ follow_requests_count|default(0) }}</span>
                        </a>
                         <a href="{{ path('app_social_notifications') }}" class="dropdown-item">
                            <i class="fas fa-user-plus"></i> Notifications
                            <span class="badge badge-danger ml-2">{{ follow_requests_count|default(0) }}</span>
                        </a>
                        
                        <div class="dropdown-divider"></div>
                        <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                            <i class="fas fa-sign-out-alt"></i> Déconnexion
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Contenu principal -->
    <div class="main-content">
        <div class="container">
            <!-- Alertes -->
            {% for label, messages in app.flashes %}
                {% for message in messages %}
                    <div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
                        <span class="alert-icon">
                            {% if label == 'success' %}
                                <i class="fas fa-check-circle"></i>
                            {% elseif label == 'danger' %}
                                <i class="fas fa-exclamation-circle"></i>
                            {% elseif label == 'warning' %}
                                <i class="fas fa-exclamation-triangle"></i>
                            {% elseif label == 'info' %}
                                <i class="fas fa-info-circle"></i>
                            {% endif %}
                        </span>
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            {% endfor %}
            
            <div class="feed-header mt-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1 class="mb-0">Feed</h1>
                    <a href="{{ path('app_social_add_post') }}" class="btn btn-primary btn-add-post">
                        <i class="fas fa-plus-circle"></i> Add Post
                    </a>
                </div>
               
            </div>
            
            <div class="feed-grid">
            {% for post in posts %}
                <article class="post-card-grid">
                    <div class="post-header-simple">
                        <div class="user-info">
                            <span class="username">{{ post.user.username }}</span>
                            <span class="post-date">{{ post.post.timeStamp|date('d M Y H:i') }}</span>
                        </div>
                        {% if currentUser and post.user.id == currentUser.id %}
                        <div class="post-options dropdown">
                            <button class="btn-icon" type="button" data-toggle="dropdown">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                            <div class="dropdown-menu dropdown-menu-right">
                                <a href="{{ path('app_social_edit_post', {id: post.post.id}) }}" class="dropdown-item">
                                    <i class="fas fa-edit"></i> Modifier
                                </a>
                                <a href="{{ path('app_social_delete_post', {id: post.post.id}) }}" class="dropdown-item text-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce post?')">
                                    <i class="fas fa-trash-alt"></i> Supprimer
                                </a>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    <div class="post-content-simple">
                        {% if post.post.imagePath %}
                            <img src="{{ post.post.imagePath }}" alt="Image du post" class="post-image-grid">
                        {% else %}
                            <div class="post-text-content">{{ post.post.content }}</div>
                        {% endif %}
                    </div>
                    <div class="post-actions-simple">
                        <div class="action-buttons">
                            <form action="{{ path('app_social_like_post', {id: post.post.id}) }}" method="post" class="like-form">
                                <button type="submit" class="btn-icon {% if post.userLiked %}liked{% endif %}">
                                    <i class="{% if post.userLiked %}fas{% else %}far{% endif %} fa-heart"></i>
                                </button>
                            </form>
                            <a href="#comments-{{ post.post.id }}" class="btn-icon">
                                <i class="far fa-comment"></i>
                            </a>
                            <div class="share-dropdown">
                                <button type="button" class="btn-icon share-toggle" data-id="{{ post.post.id }}">
                                    <i class="fas fa-share"></i>
                                </button>
                                <div id="share-options-{{ post.post.id }}" class="share-options">
                                    <button onclick="shareOnFacebook('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', 'Voir ce post', '{{ post.post.content|slice(0, 100) }}')" class="share-btn facebook">
                                        <i class="fab fa-facebook-f"></i> Facebook
                                    </button>
                                    <button onclick="shareOnTwitter('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', '{{ post.post.content|slice(0, 100) }}')" class="share-btn twitter">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </button>
                                    <button onclick="shareOnLinkedIn('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', 'Voir ce post', '{{ post.post.content|slice(0, 100) }}')" class="share-btn linkedin">
                                        <i class="fab fa-linkedin-in"></i> LinkedIn
                                    </button>
                                    <button onclick="shareOnWhatsApp('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', '{{ post.post.content|slice(0, 100) }}')" class="share-btn whatsapp">
                                        <i class="fab fa-whatsapp"></i> WhatsApp
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="post-stats">
                            <div class="like-stat">{{ post.likeCount }} J'aime</div>
                        </div>
                        
                        <div class="comments-preview" id="comments-{{ post.post.id }}">
                            <a href="#comments-{{ post.post.id }}" class="view-comments">Voir les commentaires ({{ post.comments|length }})</a>
                            {% for comment in post.comments|slice(0, 3) %}
                                <div class="comment-preview">
                                    <span class="comment-username">{{ comment.userId.username }}</span>
                                    <span class="comment-text">{{ comment.content }}</span>
                                </div>
                            {% endfor %}
                        </div>
                        
                        <div class="comment-form-simple">
                            <form action="{{ path('app_social_add_comment', {id: post.post.id}) }}" method="post">
                                <input type="text" name="content" placeholder="Ajouter un commentaire..." required>
                                <button type="submit" class="btn-submit-comment">
                                    <i class="far fa-paper-plane"></i>
                                </button>
                            </form>
                        </div>
                    </div>
                </article>
            {% endfor %}
            {% if posts is empty %}
                <div class="empty-feed">
                    <i class="far fa-sad-tear fa-3x"></i>
                    <p>Aucun post à afficher pour le moment.</p>
                    <p>Soyez le premier à partager quelque chose !</p>
                </div>
            {% endif %}
            </div>
        </div>
    </div>
</div>

<script src="{{ asset('js/social-share.js') }}"></script>
<script src="{{ asset('js/search-dropdown.js') }}"></script>
</body>
</html>
</file>

<file path="social/user_profile.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Utilisateur - Connect Sphere</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    <link rel="stylesheet" href="{{ asset('css/navbar-social.css') }}">
    
    <!-- jQuery et Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<!-- Navbar horizontale -->    
<header class="navbar-social">
    <div class="container-fluid">
        <div class="navbar-content">
            <div class="navbar-brand">
                <a href="{{ path('app_root') }}">
                    <img src="{{ asset('images/logo.png') }}" alt="ConnectSphere" class="logo-img">
                    <span>ConnectSphere</span>
                </a>
            </div>
            
            <div class="search-container">
                <div class="search-form">
                    <input type="text" name="search" id="searchInput" placeholder="Search users /groups" class="search-input" autocomplete="off">
                    <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
                </div>
                <div class="search-dropdown" id="searchDropdown"></div>
            </div>
            
            <button class="mobile-toggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <div class="navbar-links">
                <a href="{{ path('app_root') }}" class="nav-link"><i class="fas fa-home"></i> Home</a>
                <a href="{{ path('app_social') }}" class="nav-link"><i class="fas fa-users"></i> Feed</a>
                <a href="{{ path('app_job_feed') }}" class="nav-link"><i class="fas fa-briefcase"></i> Jobs</a>
                <a href="{{ path('app_events') }}" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a>
            </div>
            
            <!-- Ajout de l'icône profil utilisateur avec menu déroulant -->
            <div class="profile-dropdown">
                <div class="dropdown-toggle">
                    {% if app.session.get('user') and app.session.get('user').profilePicture is defined and app.session.get('user').profilePicture and app.session.get('user').profilePicture != 'default.png' %}
                        <img src="{{ asset('uploads/images/' ~ app.session.get('user').profilePicture) }}" alt="{{ app.session.get('user').username }}" class="profile-img">
                    {% else %}
                        <img src="{{ asset('uploads/images/default-avatar.png') }}" alt="Photo par défaut" class="profile-img">
                    {% endif %}
                    <span class="d-none d-md-inline">{{ app.session.get('user') ? app.session.get('user').username : 'Invité' }}</span>
                </div>
                <div class="dropdown-menu">
                    <a href="{{ path('app_social_user_profile', {id: app.session.get('user').id}) }}" class="dropdown-item">
                        <i class="fas fa-user"></i> Mon profil
                    </a>
                    <a href="{{ path('app_social_follow_requests') }}" class="dropdown-item">
                        <i class="fas fa-user-plus"></i> Demandes de suivi
                        <span class="badge badge-danger ml-2">{{ pendingRequestsCount|default(0) }}</span>
                    </a>
                    
                    <div class="dropdown-divider"></div>
                    <a href="{{ path('app_logout') }}" class="dropdown-item text-danger">
                        <i class="fas fa-sign-out-alt"></i> Déconnexion
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<div class="main-content">
    <div class="container">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label == 'error' ? 'danger' : label }}">{{ message }}</div>
            {% endfor %}
        {% endfor %}
        
        <div class="feed-header">
            <h1>Profil de {{ user.username }}</h1>
            <a href="{{ path('app_social') }}" class="btn btn-primary">
                <i class="fas fa-arrow-left"></i> Retour au Feed
            </a>
        </div>
        
        <!-- Profil utilisateur -->
        <div class="user-profile-card">
            <div class="profile-header">
                <div class="profile-avatar">
                    {% if user.profilePicture is defined and user.profilePicture %}
                        <img src="{{ asset('uploads/images/' ~ user.profilePicture) }}" alt="{{ user.username }}">
                    {% else %}
                        <img src="{{ asset('uploads/images/default-avatar.png') }}" alt="{{ user.username }}">
                    {% endif %}
                </div>
                <div class="profile-info">
                    <h2>{{ user.username }}</h2>
                    <p class="profile-email">{{ user.email }}</p>
                </div>
            </div>
            <div class="profile-actions">
                {% if currentUser and currentUser.id == user.id %}
                    <!-- Si c'est le profil de l'utilisateur connecté -->
                    <a href="{{ path('app_job_feed') }}" class="btn btn-success">
                        <i class="fas fa-briefcase"></i> Postuler à un poste
                    </a>
                {% else %}
                    <!-- Si c'est le profil d'un autre utilisateur -->
                    <form action="{{ path('app_social_follow_user', {id: user.id}) }}" method="post">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> 
                            {% if followStatus is not null %}
                                {% if followStatus.status == 'pending' %}
                                    En attente
                                {% elseif followStatus.status == 'accepted' %}
                                    Ne plus suivre
                                {% else %}
                                    Suivre
                                {% endif %}
                            {% else %}
                                Suivre
                            {% endif %}
                        </button>
                    </form>
                {% endif %}
            </div>
        </div>
        
        <!-- Publications de l'utilisateur -->            <div class="user-posts-section">
                <h2>Publications de {{ user.username }}</h2>
                
                <div class="feed-grid">
                {% if posts|length > 0 %}
                    {% for post in posts %}
                        <article class="post-card-grid">
                            <div class="post-header-simple">
                                <div class="user-info">
                                    <span class="username">{{ post.user.username }}</span>
                                    <span class="post-date">{{ post.post.createdAt|date('d M Y H:i') }}</span>
                                </div>
                                {% if currentUser and post.user.id == currentUser.id %}
                                <div class="post-options dropdown">
                                    <button class="btn-icon" type="button" data-toggle="dropdown">
                                        <i class="fas fa-ellipsis-h"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-right">
                                        <a href="{{ path('app_social_edit_post', {id: post.post.id}) }}" class="dropdown-item">
                                            <i class="fas fa-edit"></i> Modifier
                                        </a>
                                        <a href="{{ path('app_social_delete_post', {id: post.post.id}) }}" class="dropdown-item text-danger" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce post?')">
                                            <i class="fas fa-trash-alt"></i> Supprimer
                                        </a>
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                            <div class="post-content-simple">
                                {% if post.post.imagePath is defined and post.post.imagePath %}
                                    <img src="{{ post.post.imagePath }}" alt="Image du post" class="post-image-grid">
                                {% else %}
                                    <div class="post-text-content">{{ post.post.content }}</div>
                                {% endif %}
                            </div>
                            <div class="post-actions-simple">
                                <div class="action-buttons">
                                    <form action="{{ path('app_social_like_post', {id: post.post.id}) }}" method="post" class="like-form">
                                        <button type="submit" class="btn-icon {% if post.userLiked %}liked{% endif %}">
                                            <i class="{% if post.userLiked %}fas{% else %}far{% endif %} fa-heart"></i>
                                        </button>
                                    </form>
                                    <a href="#comments-{{ post.post.id }}" class="btn-icon">
                                        <i class="far fa-comment"></i>
                                    </a>
                                    <div class="share-dropdown">
                                        <button type="button" class="btn-icon share-toggle" data-id="{{ post.post.id }}">
                                            <i class="fas fa-share"></i>
                                        </button>
                                        <div id="share-options-{{ post.post.id }}" class="share-options">
                                            <button onclick="shareOnFacebook('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', 'Voir ce post', '{{ post.post.content|slice(0, 100) }}')" class="share-btn facebook">
                                                <i class="fab fa-facebook-f"></i>
                                            </button>
                                            <button onclick="shareOnTwitter('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', '{{ post.post.content|slice(0, 100) }}')" class="share-btn twitter">
                                                <i class="fab fa-twitter"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="post-stats">
                                    <div class="like-stat">{{ post.likeCount }} J'aime</div>
                                </div>
                                
                                <div class="comments-preview" id="comments-{{ post.post.id }}">
                                    <a href="#comments-{{ post.post.id }}" class="view-comments">Voir les commentaires ({{ post.comments|length }})</a>
                                </div>
                                
                                <div class="comment-form-simple">
                                    <form action="{{ path('app_social_add_comment', {id: post.post.id}) }}" method="post" class="d-flex">
                                        <input type="text" name="content" class="form-control" placeholder="Ajouter un commentaire...">
                                        <button type="submit" class="btn btn-primary ml-2">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                {% else %}
                    <div class="empty-feed">
                        <i class="far fa-sad-tear fa-3x"></i>
                        <p>Aucune publication à afficher.</p>
                    </div>
                {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Gestion du dropdown profil
    $(document).ready(function() {
        $(".profile-dropdown .dropdown-toggle").on("click", function(e) {
            e.preventDefault();
            e.stopPropagation();
            $(this).parent().find(".dropdown-menu").toggleClass("show");
        });
        
        // Fermer le dropdown quand on clique ailleurs
        $(document).on("click", function(e) {
            if (!$(e.target).closest(".profile-dropdown").length) {
                $(".dropdown-menu").removeClass("show");
            }
        });
        
        // Empêcher la fermeture du menu lors du clic sur les éléments du menu
        $(".dropdown-menu").on("click", ".dropdown-item", function(e) {
            e.stopPropagation();
        });
    });
</script>
</body>
</html>
</file>

<file path="social/view_post.html.twig">
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ posts[0].post.content|slice(0, 50) }}... - Connect Sphere</title>
    
    <!-- Métadonnées Open Graph pour le partage sur les réseaux sociaux -->
    <meta property="og:title" content="{{ posts[0].post.content|slice(0, 100) }}" />
    <meta property="og:description" content="{{ posts[0].post.content }}" />
    <meta property="og:url" content="{{ absolute_url(path('app_social_view_post', {id: posts[0].post.id})) }}" />
    {% if posts[0].post.imagePath %}
    <meta property="og:image" content="{{ absolute_url(posts[0].post.imagePath) }}" />
    {% endif %}
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Connect Sphere" />
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ asset('css/social.css') }}">
    
    <!-- Styles pour le menu déroulant des options de post -->
    <style>
        .post-options {
            cursor: pointer;
            position: relative;
        }
        
        .dropdown-menu {
            min-width: 180px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
        }
        
        .dropdown-item {
            padding: 8px 15px;
            display: flex;
            align-items: center;
        }
        
        .dropdown-item:hover {
            background-color: #f8f9fa;
        }
        
        .dropdown-item.text-danger:hover {
            background-color: #fff5f5;
        }
    </style>
    
    <!-- Scripts Bootstrap pour les menus déroulants -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<!-- Sidebar -->
<div class="sidebar">
    <div class="sidebar-header">
        <h2>Connect Sphere</h2>
    </div>
    <div class="sidebar-profile">
        <img src="/uploads/images/default-avatar.png" alt="Profile">
        <div>Utilisateur</div>
    </div>
    <ul class="sidebar-menu">
        <li class="active"><a href="{{ path('app_social') }}"><i class="fas fa-home"></i> Dashboard</a></li>
        <li><a href="#"><i class="fas fa-calendar-alt"></i> Events</a></li>
        <li><a href="#"><i class="fas fa-users"></i> Group</a></li>
        <li><a href="#"><i class="fas fa-briefcase"></i> Job Feed</a></li>
        <li><a href="#"><i class="fas fa-plus-circle"></i> Create Job</a></li>
        <li><a href="#"><i class="fas fa-user"></i> Profile</a></li>
        <li><a href="#"><i class="fas fa-robot"></i> AI assistant</a></li>
        <li><a href="{{ path('app_logout') }}" class="logout-link"><i class="fas fa-sign-out-alt"></i> Déconnexion</a></li>
    </ul>
</div>

<!-- Main Content -->
<div class="main-content">
    <div class="container">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}
        
        <div class="feed-header">
            <h1>Post individuel</h1>
            <a href="{{ path('app_social') }}" class="btn-back"><i class="fas fa-arrow-left"></i> Retour</a>
        </div>
        
        <div class="feed">
        {% for post in posts %}
            <article class="post-card-grid">
                <div class="post-header-simple">
                    <div class="user-info">
                        <div class="username">{{ post.user.username }}</div>
                        <div class="post-date">{{ post.post.timeStamp|date('d/m/Y H:i') }}</div>
                    </div>
                    {% if currentUser and post.user.id == currentUser.id %}
                    <div class="post-options dropdown">
                        <i class="fas fa-ellipsis-h" id="dropdownMenuButton-{{ post.post.id }}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton-{{ post.post.id }}">
                            <a class="dropdown-item" href="{{ path('app_social_edit_post', {id: post.post.id}) }}">
                                <i class="fas fa-edit mr-2"></i> Modifier
                            </a>
                            <form action="{{ path('app_social_delete_post', {id: post.post.id}) }}" method="post" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer ce post ?');">
                                <button type="submit" class="dropdown-item text-danger">
                                    <i class="fas fa-trash-alt mr-2"></i> Supprimer
                                </button>
                            </form>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                {% if post.post.imagePath %}
                <div class="post-image">
                    <img src="{{ post.post.imagePath }}" alt="Post image">
                </div>
                {% endif %}
                
                <div class="post-text-content">
                    {{ post.post.content }}
                </div>
                
                <div class="post-actions-simple">
                    <div class="action-buttons">
                        <form action="{{ path('app_social_like_post', {id: post.post.id}) }}" method="post" class="like-form">
                            <button type="submit" class="btn-icon {% if post.userLiked %}liked{% endif %}">
                                <i class="{% if post.userLiked %}fas{% else %}far{% endif %} fa-heart"></i>
                            </button>
                        </form>
                        <a href="#comments-{{ post.post.id }}" class="btn-icon">
                            <i class="far fa-comment"></i>
                        </a>
                        
                        <!-- Menu déroulant pour le partage externe -->
                        <div class="share-dropdown">
                            <button type="button" class="btn-icon share-toggle" data-id="{{ post.post.id }}">
                                <i class="fas fa-share-alt"></i>
                            </button>
                            <div id="share-options-{{ post.post.id }}" class="share-options">
                                <button onclick="shareOnFacebook('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', 'Voir ce post', '{{ post.post.content|slice(0, 100) }}')" class="share-btn facebook">
                                    <i class="fab fa-facebook-f"></i> Facebook
                                </button>
                                <button onclick="shareOnTwitter('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', '{{ post.post.content|slice(0, 100) }}')" class="share-btn twitter">
                                    <i class="fab fa-twitter"></i> Twitter
                                </button>
                                <button onclick="shareOnLinkedIn('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', 'Voir ce post', '{{ post.post.content|slice(0, 100) }}')" class="share-btn linkedin">
                                    <i class="fab fa-linkedin-in"></i> LinkedIn
                                </button>
                                <button onclick="shareOnWhatsApp('{{ absolute_url(path('app_social_view_post', {id: post.post.id})) }}', '{{ post.post.content|slice(0, 100) }}')" class="share-btn whatsapp">
                                    <i class="fab fa-whatsapp"></i> WhatsApp
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="post-stats">
                        <div class="like-stat">{{ post.likeCount }} J'aime</div>
                    </div>
                    
                    <div class="post-caption">
                        <span class="caption-username">{{ post.user.username }}</span>
                        <span class="caption-text">{{ post.post.content }}</span>
                    </div>
                    
                    <div class="comments-preview" id="comments-{{ post.post.id }}">
                        <a href="#comments-{{ post.post.id }}" class="view-comments">Voir les commentaires ({{ post.comments|length }})</a>
                        {% for comment in post.comments|slice(0, 3) %}
                            <div class="comment-preview">
                                <span class="comment-username">{{ comment.userId.username }}</span>
                                <span class="comment-text">{{ comment.content }}</span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="comment-form-simple">
                    <form action="{{ path('app_social_add_comment', {id: post.post.id}) }}" method="post">
                        <input type="text" name="content" placeholder="Ajouter un commentaire..." required>
                        <button type="submit" class="btn-submit-comment">
                            <i class="far fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </article>
        {% else %}
            <div class="empty-feed">
                <i class="far fa-sad-tear fa-3x"></i>
                <p>Aucun post à afficher pour le moment.</p>
                <p>Soyez le premier à partager quelque chose !</p>
            </div>
        {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Ajouter le script pour les fonctionnalités de partage -->
<script src="{{ asset('js/social-share.js') }}"></script>
</body>
</html>
</file>

</files>
